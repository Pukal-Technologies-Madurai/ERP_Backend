"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5913],{3632:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},13899:(e,l,a)=>{a.d(l,{A:()=>b});var d=a(89379),s=a(65043),t=a(83462),r=a(26600),o=a(35316),n=a(29347),i=a(11906),c=a(33438),u=a(47968),v=a(97707),h=a(93141),m=a(65074),x=a(70579);const j=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:return(0,v.e3)(e*(l/100));case 1:return(0,v.e3)(e-e*(100/(100+l)));default:return 0}},b=e=>{let{orderDetails:l,orderProducts:a,download:b,actionOpen:N,clearDetails:p,children:_,TitleText:g}=e;const f=JSON.parse(localStorage.getItem("user")),[T,S]=(0,s.useState)(!1),[I,A]=(0,s.useState)({}),[y,C]=(0,s.useState)({}),G=(0,s.useRef)(null),R=(0,v.id)(l.GST_Inclusive,0),O=(0,v.id)(l.GST_Inclusive,1),P=(0,v.id)(l.GST_Inclusive,2),w=(0,v.id)(l.IS_IGST,1);(0,s.useEffect)(()=>{(0,m.z)({address:"masters/company?Company_id=".concat(null===f||void 0===f?void 0:f.Company_id)}).then(e=>{e.success&&C(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===f||void 0===f?void 0:f.Company_id]),(0,s.useEffect)(()=>{N&&S(!0)},[N]),(0,s.useEffect)(()=>{null!==l&&void 0!==l&&l.Retailer_Id&&(0,m.z)({address:"masters/retailers/info?Retailer_Id=".concat(null===l||void 0===l?void 0:l.Retailer_Id)}).then(e=>{e.success&&A(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===l||void 0===l?void 0:l.Retailer_Id]);const L=()=>{S(!1),p&&p()},B=a.filter(e=>(0,v.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),V=a.reduce((e,l)=>{const a=(0,v.e3)(null===l||void 0===l?void 0:l.Item_Rate),d=parseInt(null===l||void 0===l?void 0:l.Bill_Qty)||0;if(P)return e.TotalValue+=(0,v.JH)(d,a),e;const s=w?null===l||void 0===l?void 0:l.Igst:(0,v.Lr)(null===l||void 0===l?void 0:l.Sgst,null===l||void 0===l?void 0:l.Cgst);if(O){const l=j(1,a,s),t=(0,v.DG)(a,l);e.TotalTax+=(0,v.JH)(d,l),e.TotalValue+=(0,v.JH)(d,t)}if(R){const l=j(0,a,s);e.TotalTax+=(0,v.JH)(d,l),e.TotalValue+=(0,v.JH)(d,a)}return e},{TotalValue:0,TotalTax:0}),D=(0,h.useReactToPrint)({content:()=>G.current}),F=[{labelOne:"Invoice No",dataOne:null===l||void 0===l?void 0:l.So_Id,labelTwo:"Dated",dataTwo:(0,v.yc)(null===l||void 0===l?void 0:l.So_Date)},{labelOne:"Delivery Note",dataOne:"",labelTwo:"Mode/Terms of Payment",dataTwo:""},{labelOne:"Reference No. & Date",dataOne:"",labelTwo:"Other References",dataTwo:""},{labelOne:"Buyer's Order No",dataOne:"",labelTwo:"Dated",dataTwo:""},{labelOne:"Dispatch Doc No",dataOne:"",labelTwo:"Delivery Note Date",dataTwo:""},{labelOne:"Dispatched through",dataOne:"",labelTwo:"Destination",dataTwo:""},{labelOne:"Bill of Lading/LR-RR No",dataOne:"",labelTwo:"Motor Vehicle No",dataTwo:""}],Q=null===a||void 0===a?void 0:a.reduce((e,a)=>{const s=e.findIndex(e=>e.hsnCode==a.HSN_Code),{Taxable_Amount:t,Cgst_Amo:r,Sgst_Amo:o,Igst_Amo:n,HSN_Code:i,Cgst:c,Sgst:u,Igst:h}=a;if(-1!==s){const a=e[s],i=(0,d.A)((0,d.A)({},a),{},{taxableValue:a.taxableValue+t,cgst:(0,v.Lr)(a.cgst,r),sgst:(0,v.Lr)(a.sgst,o),igst:(0,v.Lr)(a.igst,n),totalTax:a.totalTax+Number(l.IS_IGST?n:(0,v.Lr)(r,o))});return e[s]=i,e}const m={hsnCode:i,taxableValue:t,cgst:r,cgstPercentage:c,sgst:o,sgstPercentage:u,igst:n,igstPercentage:h,totalTax:l.IS_IGST?Number(n):(0,v.Lr)(r,o)};return[...e,m]},[]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{onClick:()=>{S(!0)},children:_}),(0,x.jsxs)(t.A,{open:T,onClose:L,fullWidth:!0,maxWidth:"lg",children:[(0,x.jsx)(r.A,{children:"Order Preview"}),(0,x.jsxs)(o.A,{ref:G,children:[(0,x.jsx)("h3",{className:"text-center mb-2",children:null!==g&&void 0!==g?g:"Invoice Details"}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-6 p-0 border border-bottom-0 border-end-0",children:[(0,x.jsxs)("div",{className:"border-bottom p-2",children:[(0,x.jsx)("p",{className:"m-0 fa-17",children:null===y||void 0===y?void 0:y.Company_Name}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:["Address: ",null===y||void 0===y?void 0:y.Company_Address]}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:["City: ",null===y||void 0===y?void 0:y.Region," - ",null===y||void 0===y?void 0:y.Pincode]}),(0,x.jsx)("p",{className:"m-0 fa-14",children:null!==y&&void 0!==y&&y.Gst_Number||null!==y&&void 0!==y&&y.VAT_TIN_Number?(0,x.jsxs)(x.Fragment,{children:["GSTIN / UIN:",null!==y&&void 0!==y&&y.Gst_Number?" ".concat(y.Gst_Number):"",null!==y&&void 0!==y&&y.Gst_Number&&null!==y&&void 0!==y&&y.VAT_TIN_Number?" || ":"",null!==y&&void 0!==y&&y.VAT_TIN_Number?" ".concat(y.VAT_TIN_Number):""]}):(0,x.jsx)(x.Fragment,{children:"GSTIN / UIN: Not Available"})}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:["State: ",null===y||void 0===y?void 0:y.State]}),(0,x.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]}),(0,x.jsxs)("div",{className:"p-2",children:[" ",(0,x.jsx)("p",{className:"m-0 fa-12",children:"Buyer (Bill to)"}),(0,x.jsx)("p",{className:"m-0 fa-15",children:null===I||void 0===I?void 0:I.Retailer_Name}),(0,x.jsx)("p",{className:"m-0 fa-14",children:(null===I||void 0===I?void 0:I.Mobile_No)+" - "+(null===I||void 0===I?void 0:I.Reatailer_Address)}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:[null===I||void 0===I?void 0:I.Reatailer_City," - ",null===I||void 0===I?void 0:I.PinCode]}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===I||void 0===I?void 0:I.Gstno]}),(0,x.jsxs)("p",{className:"m-0 fa-14",children:["State Name: ",null===I||void 0===I?void 0:I.StateGet]}),(0,x.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]})]}),(0,x.jsx)("div",{className:"col-6 p-0 border border-bottom-0",children:(0,x.jsx)("table",{className:"table m-0",children:(0,x.jsxs)("tbody",{children:[F.map((e,l)=>(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{className:"border-end fa-12 p-0 px-1",children:[(0,x.jsx)("p",{className:"m-0",children:e.labelOne}),(0,x.jsxs)("p",{className:"m-0",children:["\u2003",e.dataOne]})]}),(0,x.jsxs)("td",{className:"fa-12 p-0 px-1",children:[(0,x.jsx)("p",{className:"m-0",children:e.labelTwo}),(0,x.jsxs)("p",{className:"m-0",children:["\u2003",e.dataTwo]})]})]},l)),(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:2,className:"border-0 fa-12 p-0",children:[(0,x.jsx)("p",{className:"m-0",children:"Terms of Delivery"}),(0,x.jsx)("p",{className:"m-0"}),(0,x.jsx)("br",{}),(0,x.jsx)("br",{})]})})]})})})]}),(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-12 p-0",children:(0,x.jsxs)("table",{className:"table m-0",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border bg-light fa-14",children:"Sno"}),(0,x.jsx)("td",{className:"border bg-light fa-14",children:"Product"}),(0,x.jsx)("td",{className:"border bg-light fa-14",children:"HSN/SAC"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Quantity"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Rate"}),(0,x.jsxs)("td",{className:"border bg-light fa-14 text-end",children:[(0,x.jsx)("p",{className:"m-2 ",children:"Rate"}),(0,x.jsxs)("p",{className:"m-0 ",children:[(0,v.id)(l.GST_Inclusive,1)&&"(Incl. of Tax)",(0,v.id)(l.GST_Inclusive,2)&&"(Tax not applicable)",(0,v.id)(l.GST_Inclusive,0)&&"(Excl. of Tax)"]})]}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Amount"})]})}),(0,x.jsxs)("tbody",{children:[B.map((e,a)=>{var d;const s=null!==(d=w?null===e||void 0===e?void 0:e.Igst_P:(null===e||void 0===e?void 0:e.Cgst)+(null===e||void 0===e?void 0:e.Sgst))&&void 0!==d?d:0,t=Number((null===e||void 0===e?void 0:e.Bill_Qty)||0),r=Number((null===e||void 0===e?void 0:e.Item_Rate)||0),o=j(l.GST_Inclusive,r,s);return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border fa-13",children:a+1}),(0,x.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.Product_Name}),(0,x.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.HSN_Code}),(0,x.jsxs)("td",{className:"border fa-13 text-end",children:[(0,v.jG)(t),(null===e||void 0===e?void 0:e.UOM)&&" ("+(null===e||void 0===e?void 0:e.UOM)+") "]}),(0,x.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)((0,v.id)(l.GST_Inclusive,1)?r-o:r)]}),(0,x.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)((0,v.id)(l.GST_Inclusive,1)?r:r+o)]}),(0,x.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)(null===e||void 0===e?void 0:e.Taxable_Amount)]})]},a)}),(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{className:"border p-2",rowSpan:w?4:5,colSpan:4,children:[(0,x.jsx)("p",{className:"m-0",children:"Amount Chargeable (in words):"}),(0,x.jsxs)("p",{className:"m-0",children:["\u2003 INR ",(0,v.GF)(parseInt(null===l||void 0===l?void 0:l.Total_Invoice_value))," Only."]})]}),(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total Taxable Amount"}),(0,x.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,v.jG)(V.TotalValue)})]}),w?(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"IGST"}),(0,x.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(l.IGST_Total)})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"CGST"}),(0,x.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,v.jG)(null===l||void 0===l?void 0:l.CSGT_Total)})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"SGST"}),(0,x.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(null===l||void 0===l?void 0:l.SGST_Total)})]})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Round Off"}),(0,x.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(null===l||void 0===l?void 0:l.Round_off)})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total"}),(0,x.jsx)("td",{className:"border p-2 fa-14 text-end fw-bold",children:(0,v.jG)(null===l||void 0===l?void 0:l.Total_Invoice_value)})]})]})]})})}),(0,x.jsxs)("table",{className:"table",children:[(0,x.jsxs)("thead",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"HSN / SAC"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"Taxable Value"}),(0,v.id)(l.IS_IGST,1)?(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"IGST Tax"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"Central Tax"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"State Tax"})]}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Total"})]}),(0,x.jsxs)("tr",{children:[(0,v.id)(l.IS_IGST,1)?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}),(0,x.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Tax Amount"})]})]}),(0,x.jsxs)("tbody",{children:[Q.map((e,a)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border fa-13 text-end",children:null===e||void 0===e?void 0:e.hsnCode}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.taxableValue)}),l.IS_IGST?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.igstPercentage)}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.igst)})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.cgstPercentage)}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.cgst)}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.sgstPercentage)}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.sgst)})]}),(0,x.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.totalTax)})]},a)),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border fa-13 text-end",children:"Total"}),(0,x.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.taxableValue),0))}),l.IS_IGST?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border fa-13 text-end"}),(0,x.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.igst),0))})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("td",{className:"border fa-13 text-end"}),(0,x.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.cgst),0))}),(0,x.jsx)("td",{className:"border fa-13 text-end"}),(0,x.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.sgst),0))})]}),(0,x.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.totalTax),0))})]}),(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:(0,v.id)(l.IS_IGST,1)?5:7,className:"border fa-13 fw-bold",children:["Tax Amount (in words) : INR \xa0",(0,v.GF)(parseInt(Q.reduce((e,l)=>e+Number(l.totalTax),0)))," only."]})})]})]}),(0,x.jsx)("div",{className:"col-12 text-center",children:(0,x.jsx)("p",{children:"This is a Computer Generated Invoice"})})]}),(0,x.jsxs)(n.A,{children:[(0,x.jsx)(i.A,{startIcon:(0,x.jsx)(c.A,{}),variant:"outlined",color:"error",onClick:L,children:"Close"}),b&&(0,x.jsx)(i.A,{startIcon:(0,x.jsx)(u.A,{}),variant:"outlined",onClick:D,children:"Download"})]})]})]})}},59383:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},65913:(e,l,a)=>{a.r(l),a.d(l,{default:()=>y});var d=a(89379),s=a(65043),t=a(17392),r=a(77739),o=a(11906),n=a(83462),i=a(26600),c=a(35316),u=a(29347),v=a(20656),h=a(63406),m=a(97707),x=a(13899),j=a(70141),b=a(83560),N=a(59383),p=a(79484),_=a(3632),g=(a(10204),a(65074)),f=a(48471),T=a(73216),S=a(42841),I=a(43735),A=a(70579);const y=e=>{let{loadingOn:l,loadingOff:a,AddRights:y,EditRights:C,pageID:G}=e;const R=sessionStorage.getItem("filterValues"),O={Fromdate:(0,m.ny)(),Todate:(0,m.ny)(),Retailer:{value:"",label:"ALL"},CreatedBy:{value:"",label:"ALL"},SalesPerson:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:0,OrderStatus:{value:"",label:"ALL"}},P=JSON.parse(localStorage.getItem("user")),w=(0,T.Zp)(),[L,B]=(0,s.useState)([]),[V,D]=(0,s.useState)([]),[F,Q]=(0,s.useState)([]),[k,E]=(0,s.useState)([]),[M,H]=(0,s.useState)([]),[z,U]=(0,s.useState)({}),[J,W]=(0,s.useState)(!1),[Y,Z]=(0,s.useState)(null),[q,K]=(0,s.useState)(!1),[X,$]=(0,s.useState)(O),[ee,le]=(0,s.useState)({filters:!1,orderDetails:!1});(0,s.useEffect)(()=>{const e=(0,m.vU)(G),{Fromdate:l,Todate:a,Retailer:s=O.Retailer,CreatedBy:t=O.CreatedBy,SalesPerson:r=O.SalesPerson,VoucherType:o=O.VoucherType,Cancel_status:n=O.Cancel_status,OrderStatus:i=O.OrderStatus}=e;$(e=>(0,d.A)((0,d.A)({},e),{},{Fromdate:l,Todate:a,Retailer:s,CreatedBy:t,SalesPerson:r,VoucherType:o,Cancel_status:n,OrderStatus:i}))},[R,G]);const ae=e=>{const l=Array.isArray(e.ProductList)?e.ProductList.filter(e=>Number(null===e||void 0===e?void 0:e.Bill_Qty)>0).map(l=>{(e=>{const l=null===e||void 0===e?void 0:e.match(/(\d+)\s?kg/i);l&&parseInt(l[1])})(null===l||void 0===l?void 0:l.Product_Name);return(0,d.A)((0,d.A)({},l),{},{Pre_Id:null===e||void 0===e?void 0:e.Pre_Id,Bill_Qty:(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0)*(Number(null===l||void 0===l?void 0:l.PackValue)||1),Act_Qty:Number(null===l||void 0===l?void 0:l.Total_Qty)||0,Total_Qty:Number(null===l||void 0===l?void 0:l.Bill_Qty)||0})}):[];return(0,d.A)((0,d.A)({},e),{},{Product_Array:l,Retailer_Id:Number(null===e||void 0===e?void 0:e.Retailer_Id)||0,Retailer_Name:(null===e||void 0===e?void 0:e.Retailer_Name)||"",Staffs_Array:(e=>{const l=[];return e.Broker_Id&&0!==e.Broker_Id&&l.push({Id:"",So_Id:"",Emp_Id:e.Broker_Id,Emp_Type_Id:e.Broker_Type||0}),e.Transporter_Id&&0!==e.Transporter_Id&&l.push({Id:"",Do_Id:"",Emp_Id:e.Transporter_Id,Emp_Type_Id:e.TrasnportType||0}),l.filter(e=>0!==e.Emp_Type_Id)})(e)})},de=e=>{var l;const a=ae(e),s=((null===e||void 0===e?void 0:e.ProductList)||(null===e||void 0===e?void 0:e.Products_List)||[]).map(l=>{const a=Number(l.Bill_Qty)||0,s=Number(null===l||void 0===l?void 0:l.Total_Qty)||0,t=((null===e||void 0===e?void 0:e.ConvertedInvoice)||[]).flatMap(e=>(null===e||void 0===e?void 0:e.InvoicedProducts)||[]).filter(e=>e.Item_Id===l.Item_Id).reduce((e,l)=>e+(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0),0),r=Math.max(a-t,0);return(0,d.A)((0,d.A)({},l),{},{Ordered_Qty:a,Delivered_Qty:t,Act_Qty:s,Bill_Qty:r,Amount:r*(Number(l.Item_Rate)||0)})}),t=(0,d.A)((0,d.A)({},e),{},{Do_Date:null===e||void 0===e?void 0:e.So_Date,ProductList:s,Staffs_Array:(null===e||void 0===e||null===(l=e.Staff_Involved_List)||void 0===l?void 0:l.map(e=>({Staff_Id:e.Involved_Emp_Id,Cost_Cat_Id:e.Cost_Center_Type_Id,Cost_Cat_Name:e.Cost_Center_Type})))||[],Retailer_Id:Number(null===e||void 0===e?void 0:e.Retailer_Id)||0,Retailer_Name:(null===e||void 0===e?void 0:e.Retailer_Name)||""});Z({row:t,payload:a}),K(!0)},se=()=>{K(!1),Z(null)};(0,s.useEffect)(()=>{(0,g.z)({address:"sales/saleOrder/retailers"}).then(e=>{e.success&&D(e.data)}).catch(e=>console.error(e)),(0,g.z)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===P||void 0===P?void 0:P.Company_id)}).then(e=>{e.success&&Q(e.data)}).catch(e=>console.error(e)),(0,g.z)({address:"masters/user/dropDown?Company_id=".concat(null===P||void 0===P?void 0:P.Company_id)}).then(e=>{e.success&&E(e.data)}).catch(e=>console.error(e)),(0,g.z)({address:"masters/voucher"}).then(e=>{e.success&&H(e.data)}).catch(e=>console.error(e))},[]);const te=()=>{var e;const d=(0,m.vU)(G),{Fromdate:s,Todate:t,Retailer:r=O.Retailer,CreatedBy:o=O.CreatedBy,SalesPerson:n=O.SalesPerson,VoucherType:i=O.VoucherType,Cancel_status:c=O.Cancel_status}=d;(0,g.z)({address:"sales/saleOrder?\n      Fromdate=".concat(s,"&\n      Todate=").concat(t,"&\n      Retailer_Id=").concat(null===r||void 0===r?void 0:r.value,"&\n      Sales_Person_Id=").concat(null===n||void 0===n?void 0:n.value,"&\n      Created_by=").concat(null===o||void 0===o?void 0:o.value,"&\n      VoucherType=").concat(null===i||void 0===i?void 0:i.value,"&\n      Cancel_status=").concat(c,"&\n      OrderStatus=").concat((null===X||void 0===X||null===(e=X.OrderStatus)||void 0===e?void 0:e.value)||""),loadingOn:l,loadingOff:a}).then(e=>{e.success&&B(null===e||void 0===e?void 0:e.data)}).catch(e=>console.error(e))};(0,s.useEffect)(()=>{te()},[R,G]);const re=e=>{var l,a;let{row:d,handleOpenModal:s}=e;const r=e=>{var l;let a=0;return(null===(l=d.ConvertedInvoice)||void 0===l?void 0:l.length)>0&&d.ConvertedInvoice.forEach(l=>{var d;(null===(d=l.InvoicedProducts)||void 0===d?void 0:d.length)>0&&l.InvoicedProducts.forEach(l=>{Number(l.Item_Id)===Number(e.Item_Id)&&(a+=Number(l.Bill_Qty||0))})}),a},o=null===(l=d.Products_List)||void 0===l?void 0:l.some(e=>{const l=r(e);return Number(e.Bill_Qty)-l>0});return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("table",{className:"table",children:(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,A.jsx)("td",{className:"border p-2",children:d.Branch_Name}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,A.jsx)("td",{className:"border p-2",children:d.Sales_Person_Name}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,A.jsx)("td",{className:"border p-2",children:d.Round_off})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,A.jsxs)("td",{className:"border p-2",children:[(0,m.id)(d.GST_Inclusive,1)&&"Inclusive",(0,m.id)(d.GST_Inclusive,0)&&"Exclusive"]}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,A.jsxs)("td",{className:"border p-2",children:[(0,m.id)(d.IS_IGST,1)&&"IGST",(0,m.id)(d.IS_IGST,0)&&"GST"]}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,A.jsx)("td",{className:"border p-2",children:d.Sales_Person_Name})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,A.jsx)("td",{className:"border p-2",colSpan:5,children:d.Narration})]})]})}),(0,A.jsxs)("table",{className:"table table-bordered",children:[(0,A.jsx)("thead",{className:"bg-light",children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"p-2",children:"Product"}),(0,A.jsx)("th",{className:"p-2",children:"Ordered Qty"}),(0,A.jsx)("th",{className:"p-2",children:"Delivered Qty"}),(0,A.jsxs)("th",{className:"p-2",children:["Pending Qty",o&&(0,A.jsx)(t.A,{size:"small",onClick:()=>s(d),children:(0,A.jsx)(S.A,{className:"text-blue-600"})})]})]})}),(0,A.jsx)("tbody",{children:null===(a=d.Products_List)||void 0===a?void 0:a.map((e,l)=>{const a=r(e),d=Number(e.Bill_Qty)-a;return(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"p-2",children:e.Product_Name}),(0,A.jsx)("td",{className:"p-2",children:e.Bill_Qty}),(0,A.jsx)("td",{className:"p-2",children:a}),(0,A.jsx)("td",{className:"p-2 font-bold ".concat(0===d?"text-green-600":"text-red-600"),children:d})]},l)})})]})]})},oe=()=>{le((0,d.A)((0,d.A)({},ee),{},{filters:!1,orderDetails:!1}))},ne=(0,s.useMemo)(()=>L.reduce((e,l)=>(0,m.Lr)(e,null===l||void 0===l?void 0:l.Total_Invoice_value),0),[L]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(f.Ay,{title:"Sale Orders",dataArray:L,EnableSerialNumber:!0,columns:[(0,f.Lj)("So_Date","date","Date"),(0,f.Lj)("So_Inv_No","string","ID"),(0,f.Lj)("Retailer_Name","string","Customer"),(0,f.Lj)("VoucherTypeGet","string","Voucher"),(0,f.Lj)("Total_Before_Tax","number","Before Tax"),(0,f.Lj)("Total_Tax","number","Tax"),(0,f.Lj)("Total_Invoice_value","number","Invoice Value"),{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,a;let{row:d}=e;if(3===Number(null===d||void 0===d?void 0:d.Cancel_status))return(0,A.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 bg-danger text-white",children:"Cancelled"});const s=((null===d||void 0===d||null===(l=d.Products_List)||void 0===l?void 0:l.reduce((e,l)=>e+(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0),0))||0)-((null===d||void 0===d||null===(a=d.ConvertedInvoice)||void 0===a?void 0:a.reduce((e,l)=>e+((null===l||void 0===l?void 0:l.InvoicedProducts)||[]).reduce((e,l)=>e+(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0),0),0))||0)<=0,t=s?"Completed":"Pending",r=s?"bg-success text-white":"bg-warning text-dark";return(0,A.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 ".concat(r),children:t})}},(0,f.Lj)("Created_BY_Name","string","Created_By"),{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(r.A,{title:"View Order",children:(0,A.jsx)(t.A,{onClick:()=>{U({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},color:"primary",size:"small",children:(0,A.jsx)(_.A,{className:"fa-16"})})}),C&&(0,A.jsx)(r.A,{title:"Edit",children:(0,A.jsx)(t.A,{onClick:()=>w("create",{state:(0,d.A)((0,d.A)({},l),{},{isEdit:!0})}),size:"small",children:(0,A.jsx)(b.A,{className:"fa-16"})})})]})}}],ButtonArea:(0,A.jsxs)(A.Fragment,{children:[y&&(0,A.jsx)(o.A,{variant:"outlined",startIcon:(0,A.jsx)(j.A,{}),onClick:()=>w("create"),children:"New"}),(0,A.jsx)(r.A,{title:"Filters",children:(0,A.jsx)(t.A,{size:"small",onClick:()=>le((0,d.A)((0,d.A)({},ee),{},{filters:!0})),children:(0,A.jsx)(N.A,{})})}),(0,A.jsx)("span",{className:"bg-light text-light fa-11 px-1 shadow-sm py-1 rounded-3 mx-1",children:(0,m.Ro)(ne)>0&&(0,A.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",(0,m.jG)(ne)]})})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>(0,A.jsx)(re,(0,d.A)((0,d.A)({},e),{},{handleOpenModal:de}))}),Object.keys(z).length>0&&(0,A.jsx)(x.A,{orderDetails:null===z||void 0===z?void 0:z.orderDetails,orderProducts:null===z||void 0===z?void 0:z.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>U({}),TitleText:"Sale Order"}),(0,A.jsxs)(n.A,{open:ee.filters,onClose:oe,fullWidth:!0,maxWidth:"sm",children:[(0,A.jsx)(i.A,{children:"Filters"}),(0,A.jsx)(c.A,{children:(0,A.jsx)("div",{className:"table-responsive pb-4",children:(0,A.jsx)("table",{className:"table",children:(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,A.jsx)("td",{children:(0,A.jsx)("input",{type:"date",value:X.Fromdate,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,A.jsx)("td",{children:(0,A.jsx)("input",{type:"date",value:X.Todate,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===X||void 0===X?void 0:X.Retailer,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{Retailer:e})),options:[{value:"",label:"ALL"},...V.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:(null===e||void 0===e?void 0:e.Retailer_Name)+"- \u20b9"+(0,m.jG)((0,m.Ro)(null===e||void 0===e?void 0:e.TotalSales))+" (".concat((0,m.Ro)(null===e||void 0===e?void 0:e.OrderCount),")")}))],styles:h.MR,isSearchable:!0,placeholder:"Retailer Name",filterOption:m.GI})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Salse Person"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===X||void 0===X?void 0:X.SalesPerson,onChange:e=>$(l=>(0,d.A)((0,d.A)({},l),{},{SalesPerson:e})),options:[{value:"",label:"ALL"},...F.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:h.MR,isSearchable:!0,placeholder:"Sales Person Name",filterOption:m.GI})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===X||void 0===X?void 0:X.CreatedBy,onChange:e=>$(l=>(0,d.A)((0,d.A)({},l),{},{CreatedBy:e})),options:[{value:"",label:"ALL"},...k.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:h.MR,isSearchable:!0,placeholder:"Sales Person Name",filterOption:m.GI})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===X||void 0===X?void 0:X.VoucherType,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{VoucherType:e})),options:[{value:"",label:"ALL"},...M.filter(e=>"SALES"===e.Type).map(e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name",filterOption:m.GI})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,A.jsx)("td",{children:(0,A.jsxs)("select",{value:X.Cancel_status,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{Cancel_status:Number(e.target.value)})),className:"cus-inpt",children:[(0,A.jsx)("option",{value:1,children:"Show"}),(0,A.jsx)("option",{value:0,children:"Hide"})]})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Order Status"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===X||void 0===X?void 0:X.OrderStatus,onChange:e=>$((0,d.A)((0,d.A)({},X),{},{OrderStatus:e})),options:[{value:"",label:"ALL"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"}],styles:h.MR,isSearchable:!1,placeholder:"Order Status",filterOption:m.GI})})]})]})})})}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(o.A,{onClick:oe,children:"close"}),(0,A.jsx)(o.A,{onClick:()=>{oe(),(0,m.Mb)({Fromdate:null===X||void 0===X?void 0:X.Fromdate,Todate:X.Todate,pageID:G,Retailer:X.Retailer,CreatedBy:X.CreatedBy,SalesPerson:X.SalesPerson,VoucherType:X.VoucherType,Cancel_status:X.Cancel_status,OrderStatus:X.OrderStatus})},startIcon:(0,A.jsx)(p.A,{}),variant:"outlined",children:"Search"})]})]}),(0,A.jsx)(I.A,{open:q,onClose:se,editValues:null===Y||void 0===Y?void 0:Y.row,defaultValues:null===Y||void 0===Y?void 0:Y.payload,loadingOn:l,loadingOff:a,transactionType:"invoice",onSuccess:()=>{te(),se()}})]})}},79484:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=5913.a6a374f3.chunk.js.map