"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[1599],{21599:(e,t,s)=>{s.r(t),s.d(t,{default:()=>se});var a=s(89379),n=s(65043),l=s(43845),r=s(81e3),o=s(77739),i=s(17392),d=s(85865),c=s(11906),u=s(83462),p=s(26600),x=s(35316),h=s(29347),m=s(76447),_=s(83560),j=s(70141),T=s(75155),g=s(51387),A=s(91036),y=s(45777),v=s(65074),S=s(28503),k=s(13448),b=s(24056),f=s(79650),C=s(71806),I=s(84882),N=s(28076),E=s(39652),D=s(73460),P=s(73086),w=s(25477),F=(s(92342),s(20491),s(12249)),z=s(5793),O=s(12412),R=s(51962),H=s(67784),M=s(97707),W=s(14792),L=s(70579);const B=(0,L.jsx)(F.A,{fontSize:"small"}),G=(0,L.jsx)(z.A,{fontSize:"small"}),V=e=>{var t;let{row:s,children:l,openAction:r,reload:o,onCloseFun:i,loadingOn:d,loadingOff:c,onTaskAdded:m,Task_Type_Id:_,Task_Type:j}=e;const T=localStorage.getItem("user"),g=JSON.parse(T),y={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:"",Entry_By:null===g||void 0===g?void 0:g.UserId,Company_id:null===g||void 0===g?void 0:g.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[S,k]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),[C,I]=(0,n.useState)([]),[N,E]=(0,n.useState)([]),[D,P]=(0,n.useState)([]),[w,F]=(0,n.useState)(y),[z,V]=(0,n.useState)(!1),[U,q]=(0,n.useState)(y);(0,n.useEffect)(()=>{(async()=>{try{const e=await(0,v.z)({address:"taskManagement/tasks/dropdown"});e.success&&I(e.data);const t=await(0,v.z)({address:"masters/taskType/dropDown"});t.success&&E(t.data);const s=await(0,v.z)({address:"taskManagement/parameters"});s.success&&P(s.data)}catch(e){console.error(e)}})()},[]),(0,n.useEffect)(()=>{k(r)},[r]),(0,n.useEffect)(()=>{(0,M.aF)(s)?(console.log(s),F(e=>(0,a.A)((0,a.A)((0,a.A)({},e),s),{},{Task_Group_Id:_||s.Task_Group_Id||""})),f(!0)):(F(e=>(0,a.A)((0,a.A)({},e),{},{Task_Group_Id:_||""})),f(!1))},[s,_]);const J=()=>{k(!1),F(e=>(0,a.A)((0,a.A)({},y),{},{Task_Group_Id:_||""})),i&&i()},Y=()=>{V(!1),q(y)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("span",{onClick:()=>k(!0),style:{cursor:"pointer"},children:l}),(0,L.jsxs)(u.A,{open:S,children:[(0,L.jsx)(p.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:b?"Edit Task":"Add Task"}),(0,L.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=_||w.Task_Group_Id,t=w.Task_Parameters.map(e=>(0,a.A)((0,a.A)({},e),{},{Param_Id:e.Paramet_Id}))||[],s=(0,a.A)((0,a.A)({},w),{},{Task_Group_Id:e,Task_Parameters:t});console.log("Submitting with Task_Group_Id:",e),d&&d();try{const e=await(0,v.z)({address:"taskManagement/tasks",method:b?"PUT":"POST",bodyData:s});e.success?(A.oR.success(e.message),F(e=>(0,a.A)((0,a.A)({},y),{},{Task_Group_Id:_||""})),J(),o&&o(),m&&m()):A.oR.error(e.message)}catch(n){console.error(n),A.oR.error("An error occurred while processing your request.")}finally{c&&c()}})()},children:[(0,L.jsx)(x.A,{children:(0,L.jsxs)("div",{className:"row",children:[(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsxs)("label",{children:["Task Group ",(0,L.jsx)(W.A,{})]}),_?(0,L.jsx)("div",{children:(0,L.jsx)("input",{type:"text",className:"cus-inpt",value:j||(null===(t=N.find(e=>e.Task_Type_Id===_))||void 0===t?void 0:t.Task_Type)||"",readOnly:!0})}):(0,L.jsxs)("select",{value:w.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>F((0,a.A)((0,a.A)({},w),{},{Task_Group_Id:e.target.value})),children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),N.map((e,t)=>(0,L.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},t))]})]}),(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsxs)("label",{children:["Task Name ",(0,L.jsx)(W.A,{})]}),(0,L.jsx)("input",{maxLength:150,onChange:e=>F((0,a.A)((0,a.A)({},w),{},{Task_Name:e.target.value})),required:!0,value:w.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsx)("label",{children:"Base Task"}),(0,L.jsxs)("select",{value:w.Under_Task_Id||0,className:"cus-inpt",onChange:e=>F((0,a.A)((0,a.A)({},w),{},{Under_Task_Id:e.target.value})),children:[(0,L.jsx)("option",{value:0,children:"Primary"}),C.map((e,t)=>(0,L.jsx)("option",{value:e.Task_Id,children:e.Task_Name},t))]})]}),(0,L.jsxs)("div",{className:"col-12",children:[(0,L.jsxs)("label",{children:["Task Description ",(0,L.jsx)(W.A,{})]}),(0,L.jsx)("textarea",{className:"cus-inpt",value:w.Task_Desc,rows:"3",onChange:e=>F((0,a.A)((0,a.A)({},w),{},{Task_Desc:e.target.value}))})]}),(0,L.jsx)("div",{className:"col-md-12 p-2",children:(0,L.jsx)(O.A,{multiple:!0,id:"checkboxes-tags-demo",options:D,disableCloseOnSelect:!0,getOptionLabel:e=>"".concat(e.Paramet_Name," - ").concat(e.Paramet_Data_Type),value:w.Task_Parameters||[],onChange:(e,t)=>F((0,a.A)((0,a.A)({},w),{},{Task_Parameters:t})),renderOption:(e,t,s)=>{let{selected:n}=s;return(0,L.jsxs)("li",(0,a.A)((0,a.A)({},e),{},{children:[(0,L.jsx)(R.A,{icon:B,checkedIcon:G,style:{marginRight:8},checked:n}),"".concat(t.Paramet_Name," - ").concat(t.Paramet_Data_Type)]}))},className:"pt-2",isOptionEqualToValue:(e,t)=>Number(e.Paramet_Id)===Number(t.Paramet_Id),renderInput:e=>(0,L.jsx)(H.A,(0,a.A)((0,a.A)({},e),{},{label:"Task Parameters",placeholder:"Choose Task Parameters"}))})}),w.Task_Parameters.map((e,t)=>(0,L.jsxs)("div",{className:"col-md-4 p-2",children:[(0,L.jsx)("label",{className:"mb-2",children:e.Paramet_Name}),(0,L.jsx)("input",{type:e.Paramet_Data_Type||"text",className:"cus-inpt",onChange:e=>{const s=[...w.Task_Parameters];s[t]=(0,a.A)((0,a.A)({},s[t]),{},{Default_Value:e.target.value}),F((0,a.A)((0,a.A)({},w),{},{Task_Parameters:s}))},value:e.Default_Value,placeholder:"Default Value"})]},t))]})}),(0,L.jsxs)(h.A,{children:[(0,L.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:J,children:"Cancel"}),(0,L.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]}),(0,L.jsxs)(u.A,{open:z,onClose:Y,children:[(0,L.jsx)(p.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Edit Task"}),(0,L.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=U.Task_Parameters.map(e=>(0,a.A)((0,a.A)({},e),{},{Param_Id:e.Paramet_Id}))||[],t=(0,a.A)((0,a.A)({},U),{},{Task_Parameters:e});d&&d();try{const e=await(0,v.z)({address:"taskManagement/tasks",method:"PUT",bodyData:t});e.success?(A.oR.success(e.message),Y(),o&&o(),m&&m()):A.oR.error(e.message)}catch(s){console.error(s),A.oR.error("An error occurred while processing your request.")}finally{c&&c()}})()},children:[(0,L.jsxs)(x.A,{children:[(0,L.jsx)(H.A,{label:"Task Name",value:U.Task_Name,onChange:e=>q((0,a.A)((0,a.A)({},U),{},{Task_Name:e.target.value})),fullWidth:!0}),(0,L.jsxs)(H.A,{label:"Task Group",select:!0,value:U.Task_Group_Id,onChange:e=>q((0,a.A)((0,a.A)({},U),{},{Task_Group_Id:e.target.value})),fullWidth:!0,children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),N.map((e,t)=>(0,L.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},t))]})]}),(0,L.jsxs)(h.A,{children:[(0,L.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:Y,children:"Cancel"}),(0,L.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Save"})]})]})]})]})};var U=s(89384),q=s(81637),J=s(51214),Y=s(53911);const K=function(e){let{open:t,onClose:s,taskDetails:a,closeDialogTask:l}=e;const[r,o]=(0,n.useState)(null),[d,h]=(0,n.useState)(!1),[m,j]=(0,n.useState)(!0),{contextObj:T}=(0,n.useContext)(y.i);(0,n.useEffect)(()=>{t&&(o(null),j(!0),setTimeout(()=>{j(!1)},500))},[t]);const g=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const s=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear();return"".concat(s,"-").concat(a,"-").concat(n)};return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(u.A,{open:t,maxWidth:"lg",children:[(0,L.jsx)(p.A,{children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsx)("span",{children:"Details"}),(0,L.jsx)(c.A,{variant:"contained",color:"primary",onClick:s,children:"Close"})]})}),(0,L.jsx)(x.A,{children:m?(0,L.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",width:"500px"},children:(0,L.jsx)(q.A,{})}):(0,L.jsx)(f.A,{children:(0,L.jsxs)(C.A,{children:[(0,L.jsx)(I.A,{children:(0,L.jsxs)(N.A,{children:[(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Employee"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Assigned By"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Start-End Date"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Start-End Time"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Total Hours"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Timer Based"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Involved Status"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Order By"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:"Action"})]})}),(0,L.jsx)(D.A,{children:0===a.length?(0,L.jsx)(N.A,{children:(0,L.jsx)(E.A,{colSpan:9,className:"fa-14 text-center",style:{textAlign:"center"},children:"No data found"})}):a.map((e,t)=>(0,L.jsxs)(N.A,{children:[(0,L.jsx)(E.A,{className:"fa-13 text-center",children:e.EmployeeName||"N/A"}),(0,L.jsx)(E.A,{className:"fa-13 text-center",children:e.AssignedUser||"N/A"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:(0,L.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,L.jsx)(J.A,{className:"fa-18 me-2"}),g(e.Est_Start_Dt)," - ",g(e.Est_End_Dt)]})}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:(0,L.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,L.jsx)(Y.A,{className:"fa-18 me-2"}),e.Sch_Time||"N/A"," - ",e.EN_Time||"N/A"]})}),(0,L.jsx)(E.A,{className:"fa-13 text-center",children:e.Sch_Period||"N/A"}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:(0,L.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Timer_Based)?"bg-success":"bg-warning"),children:Number(e.Timer_Based)?"Yes":"No"})}),(0,L.jsx)(E.A,{className:"fa-14 text-center",children:(0,L.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Invovled_Stat)?"bg-success":"bg-danger"),children:Number(e.Invovled_Stat)?"IN":"OUT"})}),(0,L.jsx)(E.A,{className:"fa-13 text-center",children:e.Ord_By||"N/A"}),1===Number(null===T||void 0===T?void 0:T.Edit_Rights)&&(0,L.jsx)(E.A,{className:"fa-13 text-center",children:(0,L.jsxs)(i.A,{size:"small",onClick:()=>(o(e),void h(!0)),children:[(0,L.jsx)(_.A,{className:"fa-18"}),"Edit"]})})]},t))})]})})})]}),d&&(0,L.jsx)(U.A,{open:d,projectId:null===r||void 0===r?void 0:r.Project_Id,taskId:r,editData:r,onClose:()=>{h(!1),s()}})]})};var Q=s(22016),X=s(15710),Z=s(86506);const $=function(e){let{dialogOpen:t,setDialogOpen:s,projectid:o,reload:m,onReload:j,selectedProject:T}=e;const[g,S]=(0,n.useState)(!1),[k,F]=(0,n.useState)(!1),[z,O]=(0,n.useState)(!1),[R,H]=(0,n.useState)(null),[M,W]=(0,n.useState)([]),[B,G]=(0,n.useState)([]),[q,J]=(0,n.useState)(!1),[Y,$]=(0,n.useState)({Sch_Type_Id:"",Sch_Type:""}),[ee,te]=(0,n.useState)(!1),[se,ae]=(0,n.useState)([]),[ne,le]=(0,n.useState)(!1),re=JSON.parse(localStorage.getItem("user")),oe=null===re||void 0===re?void 0:re.UserId,ie=null===re||void 0===re?void 0:re.Company_id,[de,ce]=(0,n.useState)(!1),[ue,pe]=(0,n.useState)(null),[xe,he]=(0,n.useState)(null),{contextObj:me}=(0,n.useContext)(y.i),[_e,je]=(0,n.useState)(!1),[Te,ge]=(0,n.useState)(!1),[Ae,ye]=(0,n.useState)("1"),[ve,Se]=(0,n.useState)([]),ke=(e,t)=>{ye(t)},be=(0,n.useCallback)(async()=>{if(null!==T&&void 0!==T&&T.Task_Type_Id){te(!0);try{const e=await(0,v.z)({address:"taskManagement/tasks/dropdown?Company_id=".concat(ie,"&Task_Group_Id=").concat(T.Task_Type_Id)});e.success?W(e.data):A.oR.error(e.message)}catch(e){console.error(e)}finally{te(!1)}}},[ie,null===T||void 0===T?void 0:T.Task_Type_Id]),fe=(0,n.useCallback)(async()=>{try{const e=await(0,v.z)({address:"taskManagement/project/schedule/ListingDetails?Project_Id=".concat(o,"&Task_Type_Id=").concat((null===T||void 0===T?void 0:T.Task_Type_Id)||"")});e.success?ae(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}},[o,null===T||void 0===T?void 0:T.Task_Type_Id]);(0,n.useEffect)(()=>{null!==T&&void 0!==T&&T.Task_Type_Id&&(be(),fe(),(async()=>{(0,v.z)({address:"taskManagement/project/schedule/newscheduleType"}).then(e=>{e.success?Se(e.data):A.oR.error(e.message)})})())},[m,o,j,null===T||void 0===T?void 0:T.Task_Type_Id]);const Ce=M.map(e=>({value:e.Task_Id,label:e.Task_Name})),Ie=e=>{const t=ve.find(t=>t.Sch_Type_Id===parseInt(e.target.value));t&&$((0,a.A)((0,a.A)({},Y),{},{Sch_Type_Id:t.Sch_Type_Id,Sch_Type:t.Sch_Type}))};return(0,L.jsxs)(L.Fragment,{children:[Te&&(0,L.jsxs)(u.A,{open:Te,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},onClose:()=>ge(!1),children:[(0,L.jsx)(p.A,{children:_e?"Edit Task":"Assign Task"}),(0,L.jsx)(x.A,{children:(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,L.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ie,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),ve.map((e,t)=>(0,L.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},t))]})]})})}),(0,L.jsxs)(h.A,{children:[(0,L.jsx)(c.A,{onClick:()=>ge(!1),children:"Cancel"}),(0,L.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>(async e=>{const t={Sch_Project_Id:e.Sch_Project_Id,Sch_Id:e.TaskSchId,schtypeid:Y.Sch_Type_Id,Task_Id:e.Task_Id};try{const e=await(0,v.z)({address:"taskManagement/project/schedule/updateScheduleTaskUpdate",method:"PUT",bodyData:t});e.success?(A.oR.success(e.message),ge(!1),je(!1),j()):(e.status,A.oR.warn(e.message||"Task already exists for this project."))}catch(s){A.oR.error(s)}})(Y),children:"Save"})]})]}),(0,L.jsxs)(u.A,{open:t,fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,L.jsx)(p.A,{children:(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,L.jsxs)("span",{children:[null===T||void 0===T?void 0:T.Task_Type," "]}),(0,L.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>F(!0),children:"Assign Task"})]})}),(0,L.jsx)(r.A,{sx:{width:"100%",typography:"body1"},children:se.map((e,t)=>{const s=e.SchTypes;return(0,L.jsxs)(Q.Ay,{value:Ae,children:[(0,L.jsx)(r.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,L.jsx)(X.A,{onChange:ke,"aria-label":"Schedule Types",children:Array.isArray(s)&&s.length>0?s.map((e,t)=>(0,L.jsx)(b.A,{label:e.SchType||"No SchType",value:(e.SchTypeId||t).toString(),id:"tab-".concat(e.SchTypeId||t),"aria-controls":"tabpanel-".concat(e.SchTypeId||t)},"".concat(e.SchTypeId||"index","-").concat(t))):(0,L.jsxs)(d.A,{variant:"body2",color:"textSecondary",sx:{padding:2},children:["No Details Available for ",s]})})}),Array.isArray(s)&&s.map((e,t)=>(0,L.jsxs)(Z.A,{value:(e.SchTypeId||t).toString(),id:"tabpanel-".concat(e.SchTypeId||t),"aria-labelledby":"tab-".concat(e.SchTypeId||t),children:[(0,L.jsx)(r.A,{sx:{marginBottom:2,padding:2,backgroundColor:"#f9f9f9",borderRadius:"8px"},children:Array.isArray(e.TaskCountsInSchType)&&e.TaskCountsInSchType.length>0?e.TaskCountsInSchType.map((t,s)=>(0,L.jsx)(d.A,{variant:"body1",display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,L.jsxs)(r.A,{children:["Schedule Type: ",(0,L.jsx)("strong",{children:e.SchType})]})},s)):(0,L.jsx)(d.A,{variant:"body2",color:"textSecondary",children:"No tasks counted for this schedule type."})}),Array.isArray(e.TaskTypeGroups)&&e.TaskTypeGroups.length>0?e.TaskTypeGroups.map(t=>(0,L.jsxs)(r.A,{sx:{mb:3},children:[(0,L.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f0f4ff",p:1,borderRadius:1,mb:1},children:[(0,L.jsx)(d.A,{variant:"h6",fontWeight:"bold",children:t.Task_Type||"Default Task Type"}),(0,L.jsxs)(r.A,{sx:{textAlign:"right"},children:[(0,L.jsx)(d.A,{variant:"body2",fontWeight:"bold",children:"Completed Task / Total Task"}),Array.isArray(t.TaskMetrics)&&t.TaskMetrics.length>0?t.TaskMetrics.map((e,t)=>(0,L.jsxs)(d.A,{variant:"h6",children:[e.CompletedTasks," / ",null===e||void 0===e?void 0:e.TotalTasks]},t)):(0,L.jsx)(d.A,{variant:"body2",color:"textSecondary",children:"No metrics available"})]})]}),Array.isArray(t.Tasks)&&t.Tasks.length>0?(0,L.jsx)(f.A,{sx:{maxHeight:"60vh",border:"1px solid #e0e0e0",borderRadius:1},children:(0,L.jsxs)(C.A,{stickyHeader:!0,children:[(0,L.jsx)(I.A,{children:(0,L.jsxs)(N.A,{children:[(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Task Name"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Description"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Schedule Type"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Assigned Employees"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Assign"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Status"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Actions"}),(0,L.jsx)(E.A,{sx:{backgroundColor:"#2C3E50",color:"white",fontWeight:"bold"},children:"Details"})]})}),(0,L.jsx)(D.A,{children:t.Tasks.map(t=>(0,L.jsxs)(N.A,{sx:{backgroundColor:"#BBE6F6","&:hover":{backgroundColor:"#a8dff0"}},children:[(0,L.jsx)(E.A,{children:(0,L.jsx)(d.A,{fontWeight:"bold",children:(null===t||void 0===t?void 0:t.Task_Name)||"DEFAULT TASK"})}),(0,L.jsx)(E.A,{children:(0,L.jsx)(d.A,{variant:"body2",children:t.Task_Desc||"No description"})}),(0,L.jsx)(E.A,{children:(0,L.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,L.jsx)(d.A,{children:e.SchType}),(0,L.jsx)(i.A,{onClick:()=>{return e=t,je(!0),$(e),void ge(!0);var e},size:"small",sx:{color:"#1976d2"},children:(0,L.jsx)(_.A,{fontSize:"small"})})]})}),(0,L.jsx)(E.A,{children:Array.isArray(t.AssignedEmployees)&&t.AssignedEmployees.length>0?(0,L.jsx)(r.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.AssignedEmployees.map((e,t)=>(0,L.jsx)(l.A,{label:e.Name,variant:"outlined",size:"small",sx:{margin:"1px",color:"green",borderColor:"green"}},t))}):(0,L.jsx)(d.A,{variant:"body2",color:"textSecondary",fontStyle:"italic",children:"No Employees Assigned"})}),(0,L.jsx)(E.A,{children:(0,L.jsx)(i.A,{onClick:()=>(async e=>{H(e),O(!0)})(t),sx:{color:"#2e7d32"},children:(0,L.jsx)(P.A,{})})}),(0,L.jsx)(E.A,{children:(0,L.jsx)(l.A,{label:t.TaskSchStatus||"New",color:"Completed"===t.TaskSchStatus?"success":"In Progress"===t.TaskSchStatus?"warning":"default",size:"small"})}),(0,L.jsx)(E.A,{children:(0,L.jsx)(i.A,{onClick:()=>(H(t),void ce(!0)),sx:{color:"#ed6c02"},children:(0,L.jsx)(_.A,{})})}),(0,L.jsx)(E.A,{children:(0,L.jsx)(i.A,{onClick:()=>(async e=>{if(J(!0),e.Task_Id&&o)try{const t=await(0,v.z)({address:"masters/employeedetails/assignedTaskDetails?Task_Id=".concat(e.Task_Id,"&ProjectId=").concat(o,"&LevelId=").concat(e.Task_Levl_Id)});t.success?G(t.data):console.error(t.message)}catch(t){console.error("Error fetching task details:",t)}else A.oR.error("Task ID and Project ID are required")})(t),sx:{color:"#1976d2"},children:(0,L.jsx)(w.A,{})})})]},t.Task_Id))})]})}):(0,L.jsx)(r.A,{sx:{textAlign:"center",p:3,backgroundColor:"#f5f5f5",borderRadius:1},children:(0,L.jsx)(d.A,{variant:"body2",color:"textSecondary",children:"No tasks available for this task type."})})]},t.Task_Type_Id)):(0,L.jsx)(r.A,{sx:{textAlign:"center",p:3,backgroundColor:"#f5f5f5",borderRadius:1},children:(0,L.jsx)(d.A,{variant:"body2",color:"textSecondary",children:"No task type groups found for this schedule type."})})]},"".concat(e.SchTypeId||"index","-").concat(t)))]},t)})}),(0,L.jsx)(h.A,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,L.jsx)(c.A,{variant:"contained",color:"primary",onClick:async()=>{s(!1),$({})},children:"Close"})})]}),(0,L.jsxs)(u.A,{open:k,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,L.jsx)(p.A,{children:"Assign Task"}),(0,L.jsxs)(x.A,{children:[(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{htmlFor:"task-group",style:{marginRight:"6px"},children:"Task Group"}),(0,L.jsx)("select",{id:"task-group",value:(null===T||void 0===T?void 0:T.Task_Type_Id)||"",className:"cus-inpt",disabled:!0,style:{flex:1,marginRight:"8px",backgroundColor:"#f5f5f5",color:"#666",cursor:"not-allowed"},children:(0,L.jsx)("option",{value:null===T||void 0===T?void 0:T.Task_Type_Id,children:null===T||void 0===T?void 0:T.Task_Type})})]})})}),(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,L.jsxs)("select",{id:"task-select",value:Y.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{$(t=>(0,a.A)((0,a.A)({},t),{},{Task_Id:e.value,TasksGet:e.label}));try{const t=await(0,v.z)({address:"taskManagement/tasks/tasklistsid?Task_Id=".concat(e.value)});if(t.success){const e=t.data;$(t=>(0,a.A)((0,a.A)({},t),{},{Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Sch_Type_Id:e.Sch_Type_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()}))}else A.oR.error("Failed to fetch task details")}catch(t){A.oR.error(t)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},disabled:ee||0===Ce.length,children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- select -"}),ee?(0,L.jsx)("option",{value:"",disabled:!0,children:"Loading tasks..."}):0===Ce.length?(0,L.jsx)("option",{value:"",disabled:!0,children:"No tasks available"}):Ce.map((e,t)=>(0,L.jsx)("option",{value:e.value,children:e.label},t))]}),(0,L.jsx)(i.A,{onClick:()=>S(!0),children:(0,L.jsx)(c.A,{variant:"contained",color:"primary",children:"Create New"})})]})}),(0,L.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,L.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,L.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,L.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ie,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,L.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),ve.map((e,t)=>(0,L.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},t))]})]})})]}),(0,L.jsxs)(h.A,{children:[(0,L.jsx)(c.A,{onClick:()=>F(!1),children:"Cancel"}),(0,L.jsx)(c.A,{variant:"contained",color:"primary",onClick:async()=>{if(!Y.Task_Id||!Y.Sch_Type_Id)return void A.oR.error("Please select a task and schedule type before saving.");const e={entryBy:oe,Project_Id:o,Sch_Type_Id:Y.Sch_Type_Id,Sch_Est_Start_Date:Y.Task_Est_Start_Date,Sch_Est_End_Date:Y.Task_Est_End_Date,tasks:[Y]};try{const t=await(0,v.z)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e});t.success?(A.oR.success(t.message),F(!1),$({}),fe(),j()):(t.status,A.oR.warn(t.message||"Task already exists for this project."))}catch(t){A.oR.error(t)}},children:"Save"})]})]}),(0,L.jsx)(U.A,{open:z,onClose:()=>O(!1),task:R,projectId:o,entryBy:oe,taskId:R,reload:m,onReload:j}),(0,L.jsxs)(u.A,{open:ne,onClose:()=>le(!1),children:[(0,L.jsx)(p.A,{children:"Delete Task"}),(0,L.jsx)(h.A,{children:(0,L.jsx)(c.A,{onClick:()=>le(!1),color:"primary",children:"Cancel"})})]}),(0,L.jsx)(V,{openAction:g,onCloseFun:()=>S(!1),onTaskAdded:be,Reload:m,Task_Type_Id:null===T||void 0===T?void 0:T.Task_Type_Id,Task_Type:null===T||void 0===T?void 0:T.Task_Type}),(0,L.jsx)(V,{row:R,openAction:de,onCloseFun:()=>ce(!1),reload:fe,Reload:m}),(0,L.jsx)(K,{open:q,onClose:()=>J(!1),taskDetails:B})]})};var ee=s(58471),te=s(48471);const se=()=>{const[e,t]=(0,n.useState)(!1),[s,b]=(0,n.useState)([]),[f,C]=(0,n.useState)([]),{contextObj:I}=(0,n.useContext)(y.i),[N,E]=(0,n.useState)(!1),[D,P]=(0,n.useState)(null),[w,F]=(0,n.useState)(!1),[z,O]=(0,n.useState)(0),[R,H]=(0,n.useState)(!1),[M,W]=(0,n.useState)(null),[B,G]=(0,n.useState)(!1),[V,U]=(0,n.useState)(!1),[q,J]=(0,n.useState)(!1),[Y,K]=(0,n.useState)([]),[Q,X]=(0,n.useState)(!1),Z=JSON.parse(localStorage.getItem("user"));(0,n.useEffect)(()=>{ae(),ne()},[null===Z||void 0===Z?void 0:Z.Company_id,e]);const se=()=>{t(e=>!e)},ae=async()=>{try{let e="";e="ADMIN"==(null===Z||void 0===Z?void 0:Z.UserType)||0==(null===Z||void 0===Z?void 0:Z.UserTypeId)||1==(null===Z||void 0===Z?void 0:Z.UserTypeId)?"":(null===Z||void 0===Z?void 0:Z.UserId)||"";const t=await(0,v.z)({address:"taskManagement/project/newProjectAbstract?Company_id=".concat(null===Z||void 0===Z?void 0:Z.Company_id,"&EmpId=").concat(e)});b(t.success?t.data:[])}catch(e){console.error(e),b([])}},ne=async()=>{try{const e=await(0,v.z)({address:"taskManagement/project?Company_id=".concat(null===Z||void 0===Z?void 0:Z.Company_id)});C(e.success?e.data:[])}catch(e){console.error(e),C([])}},le=e=>{P(e),O(e.Project_Id),U(!0)},re=()=>{E(!1),U(!1),P(null),W(null),H(!1),J(!1),X(!1)},oe=s.map(e=>{const t=f.find(t=>t.Project_Id===e.Project_Id);return(0,a.A)((0,a.A)({},e),{},{Project_Head_Name:(null===t||void 0===t?void 0:t.Project_Head_Name)||"N/A",Status_Text:(null===t||void 0===t?void 0:t.Status)||e.Status||"N/A",Progress_Percentage:(s=e.TodayTaskcounts,n=e.CompletedTasks,0===Number(s)?0:(Number(n)/Number(s)*100).toFixed(0))});var s,n}),ie=[(0,te.Lj)("Task_Type","string","Task Type","left","center",1),{Field_Name:"Est_StartTime",ColumnHeader:"Start Date",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.Est_StartTime?t.Est_StartTime.split("T")[0]:"N/A"}},{Field_Name:"Est_EndTime",ColumnHeader:"End Date",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.Est_EndTime?t.Est_EndTime.split("T")[0]:"N/A"}},{Field_Name:"Status",ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsx)(l.A,{label:1===t.Status?"Active":"Inactive",color:1===t.Status?"success":"default",size:"small"})}},{Field_Name:"View Task",ColumnHeader:"View Task",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsx)(r.A,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"center"},children:(0,L.jsx)(o.A,{title:"View Task Details",children:(0,L.jsx)(i.A,{size:"small",onClick:()=>le((0,a.A)((0,a.A)({},t),{},{Project_Name:t.Project_Name||"Task"})),children:(0,L.jsx)(m.A,{fontSize:"small"})})})})}},...1===Number(null===I||void 0===I?void 0:I.Add_Rights)?[{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsx)(r.A,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:1===Number(null===I||void 0===I?void 0:I.Edit_Rights)&&(0,L.jsx)(o.A,{title:"Edit Task Type",children:(0,L.jsx)(i.A,{size:"small",onClick:()=>(e=>{var t;const s={ProjectId:e.Project_Id,ProjectName:e.Project_Name,Est_StartDate:e.Est_StartTime?new Date(e.Est_StartTime).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],Est_EndDate:e.Est_EndTime?new Date(e.Est_EndTime).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],Task_Type:e.Task_Type,Task_Type_Id:e.Task_Type_Id,Status:(null===(t=e.Status)||void 0===t?void 0:t.toString())||"1"};K(s),X(!0),J(!0)})(t),children:(0,L.jsx)(_.A,{fontSize:"small"})})})})}}]:[]],de=t=>{let{row:s}=t;const[a,l]=(0,n.useState)(!0),o=s.TaskTypes||[];return(0,n.useEffect)(()=>{l(!0)},[o.length,e]),a?(0,L.jsxs)(r.A,{sx:{padding:2,backgroundColor:"#f8f9fa",margin:1,borderRadius:1},children:[(0,L.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,L.jsxs)(d.A,{variant:"h6",sx:{fontSize:"16px",fontWeight:"bold"},children:["Modules for ",s.Project_Name]}),(0,L.jsx)(c.A,{variant:"outlined",size:"small",startIcon:(0,L.jsx)(j.A,{}),onClick:()=>{(e=>{const t={ProjectId:e.Project_Id,ProjectName:e.Project_Name,Est_StartDate:e.Est_Start_Dt?new Date(e.Est_Start_Dt).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],Est_EndDate:e.Est_End_Dt?new Date(e.Est_End_Dt).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],Task_Type:"",Task_Type_Id:"",Status:"1"};K(t),X(!1),J(!0)})(s),l(!0)},sx:{textTransform:"none"},children:"Add Task Type"})]}),(0,L.jsx)(te.Ay,{title:"Modules",dataArray:o,EnableSerialNumber:!0,columns:ie,ButtonArea:null,isExpendable:!1,tableMaxHeight:300})]}):null},ce=[(0,te.Lj)("Project_Name","string","Project","left","center",1),(0,te.Lj)("Project_Head_Name","string","Head","left","center",1),(0,te.Lj)("Status_Text","string","Status","left","center",1),{Field_Name:"Est_Start_Dt",ColumnHeader:"Start Date",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.Est_Start_Dt?new Date(t.Est_Start_Dt).toLocaleDateString("en-IN"):"N/A"}},{Field_Name:"Est_End_Dt",ColumnHeader:"End Date",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return t.Est_End_Dt?new Date(t.Est_End_Dt).toLocaleDateString("en-IN"):"N/A"}},{Field_Name:"Progress_Percentage",ColumnHeader:"Progress",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsxs)(d.A,{variant:"body2",fontWeight:"bold",children:[t.Progress_Percentage,"%"]})}},{Field_Name:"Task_Details",ColumnHeader:"Task Details",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:.5},children:[(0,L.jsxs)(d.A,{variant:"h6",fontWeight:"bold",children:[t.CompletedTasks||0," / ",t.TodayTaskcounts||0,(0,L.jsx)(o.A,{title:"View Task Details",children:(0,L.jsx)(i.A,{size:"small",onClick:()=>le(t),sx:{mt:.5}})})]}),(0,L.jsx)(d.A,{variant:"caption",color:"textSecondary",children:"Completed / Total"})]})}},{Field_Name:"Employees",ColumnHeader:"Employees",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"center"},children:[1===Number(null===I||void 0===I?void 0:I.Add_Rights)&&(0,L.jsx)(o.A,{title:"Manage Employees",children:(0,L.jsx)(i.A,{size:"small",onClick:()=>(e=>{O(e),G(!0)})(t.Project_Id),children:(0,L.jsx)(T.A,{fontSize:"small"})})}),(0,L.jsx)(d.A,{variant:"body2",children:t.EmployeesInvolved})]})}},...1===Number(null===I||void 0===I?void 0:I.Add_Rights)?[{Field_Name:"Actions",ColumnHeader:"Actions",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,L.jsxs)(r.A,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[1===Number(null===I||void 0===I?void 0:I.Edit_Rights)&&(0,L.jsx)(o.A,{title:"Edit Project",children:(0,L.jsx)(i.A,{size:"small",onClick:()=>(P(t),F(!0),void E(!0)),children:(0,L.jsx)(_.A,{fontSize:"small"})})}),1===Number(null===I||void 0===I?void 0:I.Edit_Rights)&&(0,L.jsx)(o.A,{title:"Delete Project",children:(0,L.jsx)(i.A,{size:"small",color:"error",onClick:()=>(W(t),void H(!0)),children:(0,L.jsx)(g.A,{fontSize:"small"})})})]})}}]:[]];return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(te.Ay,{title:"Active Projects",dataArray:oe,EnableSerialNumber:!0,columns:ce,ButtonArea:(0,L.jsx)(L.Fragment,{children:1===Number(null===I||void 0===I?void 0:I.Add_Rights)&&(0,L.jsx)(c.A,{variant:"outlined",startIcon:(0,L.jsx)(j.A,{}),onClick:()=>{P(null),F(!1),E(!0)},children:"Create Project"})}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>(0,L.jsx)(de,(0,a.A)({},e))}),(0,L.jsx)($,{onClose:re,dialogOpen:V,setDialogOpen:U,isEdit:!1,parseData:Z,projectid:z,onReload:se,selectedProject:D,reload:e}),(0,L.jsx)(S.A,{open:N,onClose:re,inputValue:D,isEdit:w,setReload:se,projectData:z}),(0,L.jsx)(k.A,{open:B,onClose:()=>G(!1),projectId:z,onReload:se}),(0,L.jsx)(ee.A,{open:q,onClose:()=>J(!1),existingTaskType:Y,onCreate:async s=>{try{const a=await(0,v.z)({address:"masters/taskType",method:"POST",headers:{"Content-Type":"application/json"},bodyData:{Mode:1,Task_Type:s.Task_Type,Project_Id:parseInt(s.ProjectId),Est_StartTime:s.Est_StartDate,Est_EndTime:s.Est_EndDate,Status:parseInt(s.Status)}});a.success?(t(!e),A.oR.success("Task type created successfully!"),J(!1)):A.oR.error("Failed to create task type: "+a.message)}catch(a){console.error(a),A.oR.error("Error creating task type.")}},onUpdate:async s=>{try{const a=await(0,v.z)({address:"masters/taskType",method:"PUT",headers:{"Content-Type":"application/json"},bodyData:{Mode:2,Task_Type_Id:parseInt(s.Task_Type_Id),Task_Type:s.Task_Type,Project_Id:parseInt(s.ProjectId),Est_StartTime:s.Est_StartDate,Est_EndTime:s.Est_EndDate,Status:parseInt(s.Status)}});a.success?(t(!e),A.oR.success("Task type updated successfully!"),J(!1)):A.oR.error("Failed to update task type: "+a.message)}catch(a){console.error(a),A.oR.error("Error updating task type.")}},isEdit:Q}),(0,L.jsxs)(u.A,{open:R,onClose:re,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,L.jsx)(p.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,L.jsxs)(x.A,{className:"p-4",children:["Do you want to delete the project",(0,L.jsx)("span",{className:"text-primary",children:" "+(null===M||void 0===M?void 0:M.Project_Name)+" "}),"?"]}),(0,L.jsxs)(h.A,{children:[(0,L.jsx)("button",{onClick:()=>H(!1),className:"btn btn-secondary fa-13 shadow",children:"Cancel"}),(0,L.jsx)("button",{onClick:()=>{M&&(0,v.z)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===M||void 0===M?void 0:M.Project_Id}}).then(s=>{s.success?(t(!e),A.oR.success(s.message)):A.oR.error(s.message)}).catch(e=>console.error("Fetch Error:",e)),H(!1)},className:"btn btn-danger fa-13 shadow",children:"Delete"})]})]})]})}},48471:(e,t,s)=>{s.d(t,{Ay:()=>R,JT:()=>z,Lj:()=>w,wF:()=>F});var a=s(89379),n=s(65043),l=s(77739),r=s(17392),o=s(41020),i=s(30922),d=s(32143),c=s(2050),u=s(48734),p=s(28076),x=s(39652),h=s(12110),m=s(63336),_=s(79650),j=s(71806),T=s(84882),g=s(58093),A=s(73460),y=s(31159),v=s(97707),S=s(47968),k=s(692),b=s(8737),f=s(58558),C=s(30599),I=s(433),N=s(37762),E=(s(20557),s(11238)),D=s(70579);const P=(e,t)=>e.map(e=>{const s={};return t.forEach((t,a)=>{if(t.isVisible||t.Defult_Display)if(t.isCustomCell&&t.Cell){const n=t.Cell({row:e}),l=t.ColumnHeader?String(t.ColumnHeader).replace(/\s+/g,"_").toLowerCase():"field_".concat(a+1);"string"!==typeof n&&"number"!==typeof n&&"bigint"!==typeof n||(s[l]=n)}else{let a=t.Field_Name;s[a]=e[a]||""}}),s}),w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"left",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"center",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return(0,a.A)({isVisible:r,Field_Name:e,Fied_Data:t,align:n,verticalAlign:l},s&&{ColumnHeader:s})},F=e=>{let{buttonsData:t=[],ToolTipText:s="Options"}=e;const[a,p]=(0,n.useState)(null),x=Boolean(a);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(l.A,{title:s,children:(0,D.jsx)(r.A,{"aria-describedby":x,onClick:e=>{p(e.currentTarget)},className:"ms-2",size:"small",children:(0,D.jsx)(f.A,{})})}),(0,D.jsx)(o.Ay,{open:x,anchorEl:a,onClose:()=>{p(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,D.jsx)(i.A,{children:t.map((e,t)=>(0,D.jsxs)(d.A,{onClick:()=>(null===e||void 0===e?void 0:e.onclick)&&(null===e||void 0===e?void 0:e.onclick()),disabled:null===e||void 0===e?void 0:e.disabled,children:[(0,D.jsx)(c.A,{children:null===e||void 0===e?void 0:e.icon}),(0,D.jsx)(u.A,{children:null===e||void 0===e?void 0:e.name})]},t))})})]})},z=(e,t)=>{switch(t){case"number":return e?(0,v.jG)(e):e;case"date":return e?(0,v.yc)(e):e;case"time":return e?(0,v.JG)(e):e;case"string":return e;default:return""}},O=e=>{let{dataArray:t=[],columns:s=[],onClickFun:l=null,isExpendable:o=!1,expandableComp:i=null,tableMaxHeight:d=550,initialPageCount:c=20,EnableSerialNumber:u=!1,CellSize:f="small",disablePagination:w=!1,title:O="",PDFPrintOption:R=!1,ExcelPrintOption:H=!1,maxHeightOption:M=!1,ButtonArea:W=null,MenuButtons:L=[],bodyFontSizePx:B=13,headerFontSizePx:G=13}=e;const[V,U]=(0,n.useState)(0),[q,J]=(0,n.useState)(c),[Y,K]=(0,n.useState)([]),[Q,X]=(0,n.useState)(!0),Z=Q&&M?" max-content ":d,$=[{type:"left",class:"text-start"},{type:"right",class:"text-end"},{type:"center",class:"text-center"}],ee=[{type:"top",class:" vtop "},{type:"bottom",class:" vbottom "},{type:"center",class:" vctr "}],te=(e=>{if(!Y.length)return e;return[...e].sort((e,t)=>{for(const s of Y){const{columnId:a,direction:n}=s,l=e[a],r=t[a];if(l!==r)return"asc"===n?l>r?1:-1:l<r?1:-1}return 0})})(t),se=V*q,ae=se+q,ne=te.slice(se,ae),le=e=>{let{row:t,index:a}=e;const[d,c]=(0,n.useState)(!1),h="20px";return(0,D.jsxs)(n.Fragment,{children:[(0,D.jsxs)(p.A,{children:[!0===o&&i&&(0,D.jsx)(x.A,{className:"border-end text-center vtop",sx:{fontSize:"".concat(B,"px")},children:(0,D.jsx)(r.A,{size:"small",onClick:()=>c(e=>!e),children:d?(0,D.jsx)(b.A,{sx:{fontSize:h}}):(0,D.jsx)(k.A,{sx:{fontSize:h}})})}),!0===u&&(0,D.jsx)(x.A,{className:"border-end text-center vtop",sx:{fontSize:"".concat(B,"px")},children:q*V+a+1}),null===s||void 0===s?void 0:s.map((e,s)=>{var n,r;const o=(0,v.id)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,v.id)(null===e||void 0===e?void 0:e.isVisible,1),i=Boolean(null===e||void 0===e?void 0:e.isCustomCell)&&e.Cell,d=!i,c=(t,s,a)=>null!==e&&void 0!==e&&e.tdClass?" ".concat(null===e||void 0===e?void 0:e.tdClass({row:t,Field_Name:s,index:a})," "):"",u=e.align?null===(n=$.find(t=>t.type===String(e.align).toLowerCase()))||void 0===n?void 0:n.class:"",p=e.verticalAlign?null===(r=ee.find(t=>t.type===String(e.verticalAlign).toLowerCase()))||void 0===r?void 0:r.class:" vctr ";if(o&&d){const n=Object.entries(t).find(t=>{let[s]=t;return s===e.Field_Name});return(0,D.jsx)(x.A,{className:"border-end ".concat(u," ").concat(p," ").concat(c(t,e.Field_Name,a)),sx:{fontSize:"".concat(B,"px")},onClick:()=>l?l(t):console.log("Function not supplied"),children:n?z(n[1],null===e||void 0===e?void 0:e.Fied_Data):"-"},s)}return o&&i?(0,D.jsx)(x.A,{className:"border-end ".concat(u," ").concat(p," ").concat(c(t,e.Field_Name,a)),sx:{fontSize:"".concat(B,"px")},children:e.Cell({row:t,Field_Name:e.Field_Name,index:a})},s):(0,D.jsx)(x.A,{sx:{fontSize:"".concat(B,"px")},className:"border-end ".concat(u," ").concat(p),children:"-"},s)})]}),!0===o&&i&&d&&(0,D.jsx)(p.A,{children:(0,D.jsx)(x.A,{colSpan:Number(null===s||void 0===s?void 0:s.length)+(!0===u?2:1),children:i({row:t,index:a})})})]})};return(0,D.jsxs)(h.A,{className:"rounded-3 bg-white overflow-hidden",component:m.A,children:[(0,D.jsxs)("div",{className:"d-flex align-items-center flex-wrap px-3 py-2 flex-row-reverse ",children:[(R||H||L.length>0||M)&&(0,D.jsx)(F,{ToolTipText:"Table Options",buttonsData:[...M?[{name:"Max Height",icon:Q?(0,D.jsx)(I.A,{fontSize:"small",color:"primary"}):(0,D.jsx)(C.A,{fontSize:"small"}),onclick:()=>X(e=>!e),disabled:(0,v.id)(null===t||void 0===t?void 0:t.length,0)}]:[],...R?[{name:"PDF Print",icon:(0,D.jsx)(S.A,{fontSize:"small",color:"primary"}),onclick:()=>((e,t)=>{try{const s=new N.default,n=P(e,t),l=t.filter(e=>e.isVisible||e.Defult_Display).map(e=>e.Field_Name||String(e.ColumnHeader).replace(/\s+/g,"_").toLowerCase()),r=n.map(e=>l.map(t=>e[t])).map((e,t)=>(0,a.A)((0,a.A)({},e),{},{Sno:t+1}));s.autoTable({head:[l],body:r}),s.save("table.pdf")}catch(s){console.error(s)}})(t,s),disabled:(0,v.id)(null===t||void 0===t?void 0:t.length,0)}]:[],...H?[{name:"Excel Print",icon:(0,D.jsx)(S.A,{fontSize:"small",color:"primary"}),onclick:()=>((e,t)=>{try{const s=P(e,t),a=E.Wp.json_to_sheet(s),n=E.Wp.book_new();E.Wp.book_append_sheet(n,a,"Data"),E._h(n,"table.xlsx")}catch(s){console.error(s)}})(t,s),disabled:(0,v.id)(null===t||void 0===t?void 0:t.length,0)}]:[],...L]}),W&&W,O&&(0,D.jsx)("h6",{className:"fw-bold text-muted flex-grow-1 m-0",children:O})]}),(0,D.jsx)(_.A,{sx:{maxHeight:Z},children:(0,D.jsxs)(j.A,{stickyHeader:!0,size:f,children:[(0,D.jsx)(T.A,{children:(0,D.jsxs)(p.A,{children:[o&&i&&(0,D.jsx)(x.A,{className:"fw-bold border-end border-top text-center",sx:{fontSize:"".concat(G,"px"),backgroundColor:"#EDF0F7"},children:"#"}),u&&(0,D.jsx)(x.A,{className:"fw-bold border-end border-top text-center",sx:{fontSize:"".concat(G,"px"),backgroundColor:"#EDF0F7"},children:"SNo"}),s.map((e,t)=>{const s=(0,v.id)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,v.id)(null===e||void 0===e?void 0:e.isVisible,1),n=!1===Boolean(null===e||void 0===e?void 0:e.isCustomCell)||!e.Cell,l=Y.find(t=>t.columnId===e.Field_Name),r=l?l.direction:"asc";var o,i,d,c;return s?n?(0,D.jsx)(x.A,{className:"fw-bold border-end border-top "+(e.align?null===(o=$.find(t=>t.type===String(e.align).toLowerCase()))||void 0===o?void 0:o.class:""),sx:{fontSize:"".concat(G,"px"),backgroundColor:"#EDF0F7"},sortDirection:!!l&&r,children:(0,D.jsx)(g.A,{active:!!l,direction:r,onClick:()=>(e=>{const t=Y.find(t=>t.columnId===e);if(t){const s="asc"===t.direction;K(Y.map(t=>t.columnId===e?(0,a.A)((0,a.A)({},t),{},{direction:s?"desc":"asc"}):t))}else K([...Y,{columnId:e,direction:"asc"}])})(e.Field_Name),children:e.ColumnHeader||(null===e||void 0===e||null===(i=e.Field_Name)||void 0===i?void 0:i.replace(/_/g," "))})},t):(0,D.jsx)(x.A,{className:"".concat(e.ColumnHeader||null!==e&&void 0!==e&&e.Field_Name?" fw-bold border-end border-top p-2 appFont ":" p-0 "," ")+(e.align?null===(d=$.find(t=>t.type===String(e.align).toLowerCase()))||void 0===d?void 0:d.class:""),sx:{fontSize:"".concat(G,"px"),backgroundColor:"#EDF0F7"},children:e.ColumnHeader||(null===e||void 0===e||null===(c=e.Field_Name)||void 0===c?void 0:c.replace(/_/g," "))},t):null})]})}),(0,D.jsxs)(A.A,{children:[(w?te:ne).map((e,t)=>(0,D.jsx)(le,{row:e,index:t},t)),0===t.length&&(0,D.jsx)(p.A,{children:(0,D.jsx)(x.A,{colSpan:s.length+(!0===o&&i?1:0)+(!0===u?1:0),sx:{textAlign:"center"},children:"No Data"})})]})]})}),!w&&0!==ne.length&&(0,D.jsx)("div",{className:"p-2 pb-0",children:(0,D.jsx)(y.A,{component:"div",count:t.length,page:V,onPageChange:(e,t)=>{U(t)},rowsPerPage:q,onRowsPerPageChange:e=>{J(parseInt(e.target.value,10)),U(0)},rowsPerPageOptions:Array.from(new Set([c,5,20,50,100,200,500])).sort((e,t)=>e-t),labelRowsPerPage:"Rows per page",showFirstButton:!0,showLastButton:!0})})]})};O.defaultProps={dataArray:[],columns:[],onClickFun:null,isExpendable:!1,expandableComp:null,tableMaxHeight:550,initialPageCount:20,EnableSerialNumber:!1,CellSize:"small",disablePagination:!1,title:void 0,PDFPrintOption:!1,ExcelPrintOption:!1,maxHeightOption:!1,ButtonArea:null,MenuButtons:[],headerFontSizePx:13,bodyFontSizePx:13};const R=O},58471:(e,t,s)=>{s.d(t,{A:()=>x});var a=s(89379),n=s(65043),l=s(83462),r=s(26600),o=s(35316),i=s(67784),d=s(29347),c=s(11906),u=s(65074),p=s(70579);const x=e=>{let{open:t,onClose:s,existingTaskType:x,onCreate:h,onUpdate:m}=e;const[_,j]=(0,n.useState)({Task_Type:"",Task_Type_Id:"",ProjectId:"",ProjectName:"",Est_StartDate:(new Date).toISOString().split("T")[0],Est_EndDate:(new Date).toISOString().split("T")[0],Status:"1"}),[T,g]=(0,n.useState)([]),[A,y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t&&(async()=>{y(!0);try{var e;const t=(null===(e=JSON.parse(localStorage.getItem("user")))||void 0===e?void 0:e.Company_id)||1,s=await(0,u.z)({address:"taskManagement/project/Abstract?Company_id=".concat(t)});s.success?g(s.data||[]):console.error("Failed to fetch projects:",s.message)}catch(t){console.error("Error fetching projects:",t)}finally{y(!1)}})()},[t]),(0,n.useEffect)(()=>{if(x&&x.ProjectId){const e=(0,a.A)((0,a.A)({},x),{},{ProjectId:x.ProjectId.toString(),Est_StartDate:x.Est_StartDate?new Date(x.Est_StartDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],Est_EndDate:x.Est_EndDate?new Date(x.Est_EndDate).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0]});j(e)}else j({Task_Type:"",Task_Type_Id:"",ProjectId:"",ProjectName:"",Est_StartDate:(new Date).toISOString().split("T")[0],Est_EndDate:(new Date).toISOString().split("T")[0],Status:"1"})},[x,t,T]);const v=()=>{j({Task_Type:"",Task_Type_Id:"",ProjectId:"",ProjectName:"",Est_StartDate:(new Date).toISOString().split("T")[0],Est_EndDate:(new Date).toISOString().split("T")[0],Status:"1"}),s()},S=x&&x.ProjectId;return(0,p.jsxs)(l.A,{open:t,onClose:v,fullWidth:!0,maxWidth:"sm",children:[(0,p.jsx)(r.A,{children:x&&x.Task_Type_Id?"UPDATE TASK TYPE":"CREATE TASK TYPE"}),(0,p.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!_.Task_Type.trim())return void alert("Please enter a Task Type");if(!_.ProjectId)return void alert("Please select a Project");if(new Date(_.Est_StartDate)>new Date(_.Est_EndDate))return void alert("End date cannot be before start date");const t=(0,a.A)((0,a.A)({},_),{},{ProjectId:_.ProjectId,Status:_.Status});x&&x.Task_Type_Id?m(t):h(t),s()},children:[(0,p.jsxs)(o.A,{children:[(0,p.jsx)("label",{children:"Project"}),(0,p.jsxs)("select",{value:_.ProjectId||"",onChange:e=>{const t=e.target.value,s=T.find(e=>e.Project_Id.toString()===t);j(e=>(0,a.A)((0,a.A)({},e),{},{ProjectId:t,ProjectName:s?s.Project_Name:"",Est_StartDate:null!==s&&void 0!==s&&s.Est_Start_Dt?new Date(s.Est_Start_Dt).toISOString().split("T")[0]:e.Est_StartDate,Est_EndDate:null!==s&&void 0!==s&&s.Est_End_Dt?new Date(s.Est_End_Dt).toISOString().split("T")[0]:e.Est_EndDate}))},className:"cus-inpt",required:!0,disabled:S,children:[(0,p.jsx)("option",{value:"",disabled:!0,children:A?"Loading projects...":"Select Project"}),T.map(e=>(0,p.jsx)("option",{value:e.Project_Id.toString(),children:e.Project_Name},e.Project_Id))]}),(0,p.jsx)("label",{children:"Task Type"}),(0,p.jsx)(i.A,{value:_.Task_Type,onChange:e=>j((0,a.A)((0,a.A)({},_),{},{Task_Type:e.target.value})),fullWidth:!0,margin:"dense",variant:"outlined",required:!0,placeholder:"Enter task type (e.g., Development, Testing)"}),(0,p.jsx)("label",{children:"Estimated Start Date"}),(0,p.jsx)("input",{type:"date",value:_.Est_StartDate,onChange:e=>j((0,a.A)((0,a.A)({},_),{},{Est_StartDate:e.target.value})),className:"cus-inpt",required:!0}),(0,p.jsx)("label",{children:"Estimated End Date"}),(0,p.jsx)("input",{type:"date",value:_.Est_EndDate,onChange:e=>j((0,a.A)((0,a.A)({},_),{},{Est_EndDate:e.target.value})),className:"cus-inpt",required:!0}),(0,p.jsx)("label",{children:"Status"}),(0,p.jsxs)("select",{className:"cus-inpt",value:_.Status,onChange:e=>j((0,a.A)((0,a.A)({},_),{},{Status:e.target.value})),required:!0,children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"Select Status"}),(0,p.jsx)("option",{value:"1",children:"Active"}),(0,p.jsx)("option",{value:"0",children:"Inactive"}),(0,p.jsx)("option",{value:"2",children:"Pending"}),(0,p.jsx)("option",{value:"3",children:"Completed"})]})]}),(0,p.jsxs)(d.A,{children:[(0,p.jsx)(c.A,{onClick:v,children:"Cancel"}),(0,p.jsx)(c.A,{type:"submit",variant:"contained",children:x&&x.Task_Type_Id?"Update":"Save"})]})]})]})}}}]);
//# sourceMappingURL=1599.290b3928.chunk.js.map