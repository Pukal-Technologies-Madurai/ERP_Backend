"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[7611],{27611:(e,l,a)=>{a.r(l),a.d(l,{default:()=>k});var t=a(89379),s=a(65043),d=a(12110),r=a(11906),o=a(26494),n=a(17392),i=a(20656),c=a(63406),u=a(91036),v=a(97707),m=a(59662),_=a(70579);const h=(0,m.A)((0,_.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft");var x=a(30079),p=a(70141),I=a(47968),j=a(83560),b=a(51387),A=a(37141),g=a(65074),N=a(48471),f=a(14844),C=a(73216);const S=(0,v.aN)().user,y={So_Id:"",So_Inv_No:"",So_Year:"",So_Branch_Inv_Id:"",So_Date:(0,v.ny)(),Retailer_Id:"",Retailer_Name:"",Sales_Person_Id:"",Branch_Id:"",VoucherType:"",GST_Inclusive:2,IS_IGST:0,Narration:"",isConverted:"",Cancel_status:"",CSGT_Total:0,SGST_Total:0,IGST_Total:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Created_by:null===S||void 0===S?void 0:S.UserId,Altered_by:null===S||void 0===S?void 0:S.UserId,Approved_By:"",Approve_Status:"",Created_on:"",Alterd_on:"",Trans_Type:"",Alter_Id:""},T={BrandID:"",Brand:"",GroupID:"",Group:"",SO_St_Id:"",So_Date:"",Sales_Order_Id:"",S_No:"",Pre_Id:"",Item_Id:"",Item_Rate:0,Bill_Qty:0,Amount:0,HSN_Code:"",Unit_Id:"",Unit_Name:"",Free_Qty:0,Total_Qty:0,Taxble:0,Taxable_Rate:0,Taxable_Amount:0,Tax_Rate:0,Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Final_Amo:0,Created_on:""},G={Id:"",So_Id:"",Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",EmpType:""};var P=a(83462),w=a(26600),R=a(35316),B=a(18584);const O=e=>{let{loadingOn:l,loadingOff:a,open:d,onClose:o,retailer:i,children:c,selectedItems:u,setSelectedItems:m,products:h=[],GST_Inclusive:x,IS_IGST:p}=e;const I=(0,v.id)(x,1),j=(0,v.id)(x,2),[b,A]=(0,s.useState)([]),[N,C]=(0,s.useState)({Fromdate:(0,v.ny)(),Todate:(0,v.ny)(),search:!1});(0,s.useEffect)(()=>{if((0,v.IQ)(i)&&d){const{Fromdate:e,Todate:t}=N;l&&l(),(0,g.z)({address:"sales/saleOrder/importPosOrders?Fromdate=".concat(e,"&Todate=").concat(t,"&Retailer_Id=").concat(i)}).then(e=>{e.success?A(e.data):A([])}).catch(e=>console.error(e)).finally(()=>{a&&a()})}},[N.search]);const S=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(a=>{const t=a.filter(l=>!(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));let s;if(l)s=t;else{const l=b.filter(l=>(0,v.id)(l.Pre_Id,e.Pre_Id)).map(e=>Object.fromEntries(Object.entries(T).map(l=>{var a,t,s,d,r;let[o,n]=l;const i=(e=>{var l;return null!==(l=null===h||void 0===h?void 0:h.find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}})(e.Item_Id),c=p?i.Igst_P:i.Gst_P,u=c>0,{Item_Rate:m,Bill_Qty:_,Tonnage:x,PackValue:b}=e,A=(0,v.JH)(m,(0,v.JH)(_,b)),g=j?"zerotax":I?"remove":"add",N=(0,f.v)(m,c,g),C=(0,f.v)(A,c,g),S=p?0:C.cgst_per,y=p?C.igst_per:0,T=p?0:C.cgst_amount,G=p?C.igst_amount:0;switch(o){case"Pre_Id":return[o,null!==(a=e.Pre_Id)&&void 0!==a?a:n];case"Item_Id":return[o,null!==(t=e.Item_Id)&&void 0!==t?t:n];case"Item_Rate":return[o,(0,v.Ro)(m)];case"Bill_Qty":case"Total_Qty":return[o,(0,v.Ro)(x)];case"Amount":return[o,A];case"Unit_Id":return[o,null!==(s=e.Unit_Id)&&void 0!==s?s:n];case"Unit_Name":return[o,null!==(d=e.Units)&&void 0!==d?d:n];case"HSN_Code":return[o,null!==(r=i.HSN_Code)&&void 0!==r?r:n];case"Taxable_Rate":return[o,N.base_amount];case"Taxble":return[o,u?1:0];case"Taxable_Amount":return[o,C.base_amount];case"Tax_Rate":return[o,c];case"Cgst":case"Sgst":return[o,null!==S&&void 0!==S?S:0];case"Cgst_Amo":case"Sgst_Amo":return[o,j?0:T];case"Igst":return[o,null!==y&&void 0!==y?y:0];case"Igst_Amo":return[o,j?0:G];case"Final_Amo":return[o,C.with_tax];default:return[o,n]}})));s=[...t,...l]}return s})},y=()=>{o&&o(),A([])};return(0,_.jsxs)(_.Fragment,{children:[c,(0,_.jsxs)(P.A,{open:d,onClose:y,fullScreen:!0,children:[(0,_.jsx)(w.A,{children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,_.jsx)("span",{className:"flex-grow-1",children:"Import from POS"}),(0,_.jsx)(n.A,{onClick:y,color:"success",children:(0,_.jsx)(B.A,{className:"fa-20"})})]})}),(0,_.jsxs)(R.A,{children:[(0,_.jsx)("form",{onSubmit:e=>{e.preventDefault(),C(e=>(0,t.A)((0,t.A)({},e),{},{search:!e.search}))},children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===N||void 0===N?void 0:N.Fromdate,onChange:e=>C(l=>(0,t.A)((0,t.A)({},l),{},{Fromdate:e.target.value})),required:!0})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto ms-2",type:"date",min:N.Fromdate,value:null===N||void 0===N?void 0:N.Todate,onChange:e=>C(l=>(0,t.A)((0,t.A)({},l),{},{Todate:e.target.value})),required:!0})]}),(0,_.jsx)(r.A,{variant:"outlined",className:"ms-2",type:"submit",children:"search"})]})}),(0,_.jsx)("div",{className:"table-responsive mt-3",children:(0,_.jsxs)("table",{className:"table table-bordered fa-13",children:[(0,_.jsx)("thead",{children:(0,_.jsx)("tr",{children:["Sno","#","Item","Qty","Pack","Rate","Amount","Order ID","Date","Invoice Value"].map((e,l)=>(0,_.jsx)("th",{children:e},l))})}),(0,_.jsx)("tbody",{children:b.filter(e=>(0,v.id)(e.Custome_Id,i)).map((e,l)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:l+1}),(0,_.jsx)("td",{children:(()=>{const l=-1!==u.findIndex(l=>(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));return(0,_.jsx)("div",{children:(0,_.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:l,onChange:()=>{l?S(e,!0):S(e)}})})})()}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Tonnage}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Pre_Id}),(0,_.jsx)("td",{children:(0,v.yc)(null===e||void 0===e?void 0:e.Pre_Date)}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Total_Invoice_value})]},l))})]})})]})]})]})};var D=a(56779);const Q=e=>{let{StaffArray:l=[],setStaffArray:a,costCenter:s=[],costCategory:d=[]}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,_.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,_.jsx)(r.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>a(e=>[...e,(0,t.A)({},G)]),children:"Add"})]}),(0,_.jsxs)("table",{className:"table table-bordered",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:"fa-13",children:"Sno"}),(0,_.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,_.jsx)("th",{className:"fa-13",children:"Category"}),(0,_.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,_.jsx)("tbody",{children:(0,v.$r)(l).map((e,r)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"fa-13 vctr text-center",children:r+1}),(0,_.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,_.jsx)(i.Ay,{value:{value:null===e||void 0===e?void 0:e.Involved_Emp_Id,label:null===e||void 0===e?void 0:e.EmpName},onChange:e=>a(l=>l.map((l,a)=>{if((0,v.id)(a,r)){const a=(0,v.$r)(s).find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Cost_Center_Id,e.value));return(0,t.A)((0,t.A)({},l),{},{Cost_Center_Type_Id:(0,v.IQ)(null===l||void 0===l?void 0:l.Cost_Center_Type_Id)?Number(null===l||void 0===l?void 0:l.Cost_Center_Type_Id):(0,v.IQ)(a.User_Type)?Number(a.User_Type):0,Involved_Emp_Id:Number(e.value),EmpName:e.label})}return l})),options:[...(0,v.$r)(s).filter(e=>!l.some(l=>(0,v.id)(l.Emp_Id,e.Cost_Center_Id)))].map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:c.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,_.jsxs)("select",{value:null===e||void 0===e?void 0:e.Cost_Center_Type_Id,onChange:e=>a(l=>l.map((l,a)=>(0,v.id)(a,r)?(0,t.A)((0,t.A)({},l),{},{Cost_Center_Type_Id:e.target.value}):l)),className:"cus-inpt p-2 border-0",children:[(0,_.jsx)("option",{value:"",children:"Select"}),(0,v.$r)(d).map((e,l)=>(0,_.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},l))]})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",children:(0,_.jsx)(n.A,{onClick:()=>{a(e=>e.filter((e,l)=>r!==l))},size:"small",children:(0,_.jsx)(b.A,{color:"error"})})})]},r))})]})]})};var U=a(14792);const E=(0,v.aN)().user,V=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,v.id)(e.Product_Id,l)))&&void 0!==e?e:{}},k=e=>{var l,a;let{loadingOn:m,loadingOff:S}=e;const P=(0,C.Zp)(),w=(0,C.zy)().state,[R,B]=(0,s.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[k,H]=(0,s.useState)(y),[z,F]=(0,s.useState)([]),[M,L]=(0,s.useState)([]),[q,$]=(0,s.useState)(null),[J,W]=(0,s.useState)(!1),[X,K]=(0,s.useState)(!1),Y=(0,v.id)(k.GST_Inclusive,1),Z=(0,v.id)(k.GST_Inclusive,2),ee=(0,v.id)(k.IS_IGST,1),le=Z?"zerotax":Y?"remove":"add";(0,s.useEffect)(()=>{if((0,v.aF)(w)&&Array.isArray(null===w||void 0===w?void 0:w.Products_List)&&Array.isArray(null===w||void 0===w?void 0:w.Staff_Involved_List)){const{Products_List:e,Staff_Involved_List:l}=w;H(Object.fromEntries(Object.entries(y).map(e=>{var l;let[a,t]=e;return"So_Date"===a?[a,w[a]?(0,v.ny)(w[a]):t]:[a,null!==(l=w[a])&&void 0!==l?l:t]}))),F(e.map(e=>Object.fromEntries(Object.entries(T).map(l=>{var a;let[t,s]=l;return[t,null!==(a=e[t])&&void 0!==a?a:s]})))),L(l.map(e=>Object.fromEntries(Object.entries(G).map(l=>{var a;let[t,s]=l;return[t,null!==(a=e[t])&&void 0!==a?a:s]}))))}},[w]),(0,s.useEffect)(()=>{(async()=>{try{m&&m();const[e,l,a,s,d,r,o,n]=await Promise.all([(0,g.z)({address:"masters/branch/dropDown"}),(0,g.z)({address:"masters/products"}),(0,g.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===E||void 0===E?void 0:E.Company_id)}),(0,g.z)({address:"masters/voucher?module=SALE_ORDER"}),(0,g.z)({address:"masters/uom"}),(0,g.z)({address:"dataEntry/costCenter"}),(0,g.z)({address:"dataEntry/costCenter/category"}),(0,g.z)({address:"masters/users/salesPerson/dropDown"})]),i=(e.success?e.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===l||void 0===l?void 0:l.BranchName)),c=(l.success?l.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===l||void 0===l?void 0:l.Product_Name)),u=(a.success?a.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===l||void 0===l?void 0:l.Retailer_Name)),_=(s.success?s.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===l||void 0===l?void 0:l.Voucher_Type)),h=(d.success?d.data:[]).sort((e,l)=>String(e.Units).localeCompare(l.Units)),x=(r.success?r.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===l||void 0===l?void 0:l.Cost_Center_Name)),p=(o.success?o.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===l||void 0===l?void 0:l.Cost_Category)),I=(n.success?n.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===l||void 0===l?void 0:l.Name));B(e=>(0,t.A)((0,t.A)({},e),{},{products:c,branch:i,retailers:u,voucherType:_,uom:h,staff:x,staffType:p,salesPerson:I,brand:(0,v.Mn)(c,"Brand",["Brand_Name"])}))}catch(e){console.error("Error fetching data:",e)}finally{S&&S()}})()},[null===E||void 0===E?void 0:E.Company_id]);const ae=()=>{H(y),F([]),L([])},te=(0,s.useMemo)(()=>z.reduce((e,l)=>{const a=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(Z)return(0,v.Lr)(e,a);const t=V(R.products,l.Item_Id),s=(0,v.id)(ee,1)?t.Igst_P:t.Gst_P;return Y?(0,v.Lr)(e,(0,f.v)(a,s,"remove").with_tax):(0,v.Lr)(e,(0,f.v)(a,s,"add").with_tax)},0),[z,Z,R.products,ee,Y]),se=(0,s.useMemo)(()=>z.reduce((e,l)=>{const a=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(Z)return{TotalValue:(0,v.Lr)(e.TotalValue,a),TotalTax:0};const t=V(R.products,l.Item_Id),s=(0,v.id)(ee,1)?t.Igst_P:t.Gst_P,d=(0,f.v)(a,s,Y?"remove":"add");return{TotalValue:(0,v.Lr)(e.TotalValue,d.without_tax),TotalTax:(0,v.Lr)(e.TotalTax,d.tax_amount)}},{TotalValue:0,TotalTax:0}),[z,Z,R.products,ee,Y]);return(0,s.useEffect)(()=>{F(e=>[...e].map(e=>Object.fromEntries(Object.entries(T).map(l=>{let[a,t]=l;const s=V(R.products,null===e||void 0===e?void 0:e.Item_Id),d=ee?s.Igst_P:s.Gst_P,r=d>0,{Bill_Qty:o,Item_Rate:n,Amount:i}=e,c=(0,f.v)(n,d,le),u=(0,f.v)(i,d,le),v=ee?0:u.cgst_per,m=ee?u.igst_per:0,_=ee?0:u.cgst_amount,h=ee?u.igst_amount:0;switch(a){case"Taxable_Rate":return[a,c.base_amount];case"Total_Qty":return[a,o];case"Taxble":return[a,r?1:0];case"Taxable_Amount":return[a,u.base_amount];case"Tax_Rate":return[a,d];case"Cgst":case"Sgst":return[a,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[a,Z?0:_];case"Igst":return[a,null!==m&&void 0!==m?m:0];case"Igst_Amo":return[a,Z?0:h];case"Final_Amo":return[a,u.with_tax];default:return[a,e[a]||t]}}))))},[T,R.products,ee,le]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(D.A,{orderProducts:z,setOrderProducts:F,open:J,onClose:()=>{W(!1),$(null)},products:R.products,brands:R.brand,uom:R.uom,GST_Inclusive:k.GST_Inclusive,IS_IGST:ee,editValues:q,initialValue:T}),(0,_.jsxs)(d.A,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap p-2",children:[(0,_.jsx)("h5",{className:"flex-grow-1 ps-2",children:"Sale Order Creation"}),(0,_.jsx)(r.A,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(h,{}),onClick:()=>P("/erp/sales/saleOrder"),children:"Back"}),(0,_.jsx)(r.A,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(x.A,{}),onClick:ae,children:"Clear"})]}),(0,_.jsxs)(o.A,{children:[(0,_.jsxs)("div",{className:"row",children:[(0,_.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,_.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsx)(Q,{StaffArray:M,setStaffArray:L,costCenter:R.staff,costCategory:R.staffType})})}),(0,_.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,_.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsxs)("div",{className:"row",children:[(0,_.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Retailer Name ",(0,_.jsx)(U.A,{})]}),(0,_.jsx)(i.Ay,{value:{value:null===k||void 0===k?void 0:k.Retailer_Id,label:null===k||void 0===k?void 0:k.Retailer_Name},onChange:e=>{H((0,t.A)((0,t.A)({},k),{},{Retailer_Id:e.value,Retailer_Name:e.label}))},options:[{value:"",label:"select",isDisabled:!0},...R.retailers.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:c.MR,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200,filterOption:v.GI})]}),(0,_.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Voucher Type ",(0,_.jsx)(U.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{VoucherType:Number(e.target.value)})),value:k.VoucherType,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),null===(l=R.voucherType)||void 0===l?void 0:l.map((e,l)=>(0,_.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Date ",(0,_.jsx)(U.A,{})]}),(0,_.jsx)("input",{type:"date",value:null!==k&&void 0!==k&&k.So_Date?(0,v.ny)(null===k||void 0===k?void 0:k.So_Date):"",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{So_Date:e.target.value})),className:"cus-inpt p-2"})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Invoice Type ",(0,_.jsx)(U.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{GST_Inclusive:Number(e.target.value)})),value:k.GST_Inclusive,children:[(0,_.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,_.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,_.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Tax Type ",(0,_.jsx)(U.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{IS_IGST:Number(e.target.value)})),value:k.IS_IGST,children:[(0,_.jsx)("option",{value:"0",children:"GST"}),(0,_.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Sales Person ",(0,_.jsx)(U.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{Sales_Person_Id:Number(e.target.value)})),value:k.Sales_Person_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select sales person"}),(0,_.jsx)("option",{value:null===E||void 0===E?void 0:E.UserId,children:null===E||void 0===E?void 0:E.Name}),null===(a=R.salesPerson)||void 0===a?void 0:a.map((e,l)=>(0,_.jsx)("option",{value:e.UserId,children:e.Name},l))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Branch ",(0,_.jsx)(U.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>H((0,t.A)((0,t.A)({},k),{},{Branch_Id:Number(e.target.value)})),value:k.Branch_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),R.branch.map((e,l)=>(0,_.jsx)("option",{value:e.BranchId,children:e.BranchName},l))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsx)("label",{className:"fa-13",children:"Status"}),(0,_.jsxs)("select",{value:null===k||void 0===k?void 0:k.Cancel_status,className:"cus-inpt p-2",onChange:e=>H(l=>(0,t.A)((0,t.A)({},l),{},{Cancel_status:e.target.value})),children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,_.jsx)("option",{value:"1",children:"New"}),(0,_.jsx)("option",{value:"2",children:"Pending"}),(0,_.jsx)("option",{value:"3",children:"Cancel"}),(0,_.jsx)("option",{value:"0",children:"Pending"})]})]}),(0,_.jsxs)("div",{className:"col-12 p-2",children:[(0,_.jsx)("label",{className:"fa-13",children:"Narration"}),(0,_.jsx)("textarea",{className:"cus-inpt ",value:k.Narration,onChange:e=>H(l=>(0,t.A)((0,t.A)({},l),{},{Narration:e.target.value}))})]})]})})})]}),(0,_.jsx)(N.Ay,{title:"Products",ButtonArea:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(r.A,{onClick:()=>{$(null),W(!0)},sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(p.A,{}),disabled:!(0,v.IQ)(k.Retailer_Id)||z.length>0&&z.some(e=>(0,v.IQ)(e.Pre_Id)),children:"Add Product"}),(0,_.jsx)(O,{loadingOn:m,loadingOff:S,open:X,onClose:()=>K(!1),retailer:null===k||void 0===k?void 0:k.Retailer_Id,selectedItems:z,setSelectedItems:F,products:R.products,GST_Inclusive:k.GST_Inclusive,IS_IGST:ee,children:(0,_.jsx)(r.A,{onClick:()=>K(!0),disabled:!(0,v.IQ)(k.Retailer_Id)||z.length>0&&z.some(e=>!(0,v.IQ)(e.Pre_Id)),sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(I.A,{}),children:"Import pos"})})]}),dataArray:z,columns:[{isCustomCell:!0,Cell:e=>{let{row:l}=e;return V(R.products,null===l||void 0===l?void 0:l.Item_Id).Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;return null===(l=V(R.products,null===a||void 0===a?void 0:a.Item_Id).Product_Name)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;return(null===a||void 0===a?void 0:a.Bill_Qty)+" "+(null!==(l=null===a||void 0===a?void 0:a.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},(0,N.Lj)("Item_Rate","number","Rate","right"),(0,N.Lj)("Taxable_Amount","number","Taxable Amount","right"),{isCustomCell:!0,Cell:e=>{var l;let{row:a}=e;const t=null===(l=V(R.products,null===a||void 0===a?void 0:a.Item_Id))||void 0===l?void 0:l.Gst_P,s=(0,v.Ro)(null===a||void 0===a?void 0:a.Amount),d=(0,f.v)(s,t,le);return(0,v.jG)(d.tax_amount)+" ("+d.tax_per+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var l,a;let{row:t}=e;const s=null===(l=V(R.products,null===t||void 0===t?void 0:t.Item_Id))||void 0===l?void 0:l.Gst_P,d=null!==(a=t.Amount)&&void 0!==a?a:0,r=(0,f.v)(d,s,le).tax_amount;return(0,v.jG)((0,v.id)(k.GST_Inclusive,1)?d:(0,v.Lr)(d,r))},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(n.A,{onClick:()=>{$(l),W(!0)},size:"small",children:(0,_.jsx)(j.A,{})}),(0,_.jsx)(n.A,{size:"small",onClick:()=>{(0,v.IQ)(null===l||void 0===l?void 0:l.Pre_Id)?F(e=>e.filter(e=>!(0,v.id)(null===e||void 0===e?void 0:e.Pre_Id,null===l||void 0===l?void 0:l.Pre_Id))):F(e=>e.filter(e=>!(0,v.id)(e.Item_Id,l.Item_Id)))},color:"error",children:(0,_.jsx)(b.A,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),z.length>0&&(0,_.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,_.jsx)("table",{className:"table",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{className:"border p-2",rowSpan:(0,v.id)(k.IS_IGST,1)?4:5,children:["Total in words: ",(0,v.GF)(parseInt(te))]}),(0,_.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(se.TotalValue)})]}),(0,v.id)(k.IS_IGST,1)?(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"IGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(se.TotalTax)})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"CGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(se.TotalTax/2)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"SGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(se.TotalTax/2)})]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.e3)(Math.round(te)-te)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Total"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(Math.round(te))})]})]})})}),(0,_.jsx)("div",{className:"d-flex justify-content-end",children:(0,_.jsx)(r.A,{onClick:()=>{if((null===z||void 0===z?void 0:z.length)>0&&null!==k&&void 0!==k&&k.Retailer_Id)m(),(0,g.z)({address:"sales/saleOrder",method:(0,v.IQ)(null===k||void 0===k?void 0:k.So_Id)?"PUT":"POST",bodyData:(0,t.A)((0,t.A)({},k),{},{Product_Array:z.filter(e=>(0,v.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),Staff_Involved_List:M})}).then(e=>{e.success?(u.oR.success(null===e||void 0===e?void 0:e.message),ae()):u.oR.error(null===e||void 0===e?void 0:e.message)}).catch(e=>console.error(e)).finally(()=>S());else{if(z.length<=0)return u.oR.error("Enter any one product quantity");if(null===k||void 0===k||!k.Retailer_Id)return u.oR.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,_.jsx)(A.A,{}),disabled:0===(null===z||void 0===z?void 0:z.length)||!(null!==k&&void 0!==k&&k.Retailer_Id),children:"Save"})})]})]})]})}},30079:(e,l,a)=>{a.d(l,{A:()=>d});var t=a(59662),s=a(70579);const d=(0,t.A)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},37141:(e,l,a)=>{a.d(l,{A:()=>d});var t=a(59662),s=a(70579);const d=(0,t.A)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},56779:(e,l,a)=>{a.d(l,{A:()=>j});var t=a(89379),s=a(65043),d=a(83462),r=a(26600),o=a(35316),n=a(29347),i=a(11906),c=a(97707),u=a(34496),v=a(14792),m=a(14844),_=a(20656),h=a(63406),x=a(91036),p=a(34104),I=a(70579);const j=e=>{var l,a;let{children:j,orderProducts:b=[],setOrderProducts:A,open:g=!1,onClose:N,products:f=[],brands:C=[],uom:S=[],godowns:y=[],GST_Inclusive:T,IS_IGST:G,editValues:P=null,initialValue:w={},stockInGodown:R=[]}=e;const[B,O]=(0,s.useState)(w),D=(0,c.id)(T,1),Q=(0,c.id)(T,2);(0,s.useEffect)(()=>{(0,c.aF)(P)&&g&&O(e=>Object.fromEntries(Object.entries(e).map(e=>{let[l,a]=e;return[l,P[l]?P[l]:a]})))},[P]);const U=e=>{var l;return null!==(l=null===f||void 0===f?void 0:f.find(l=>(0,c.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}},E=()=>{O(w),N()};return(0,I.jsxs)(I.Fragment,{children:[j,(0,I.jsxs)(d.A,{open:g,onClose:E,maxWidth:"md",fullWidth:!0,children:[(0,I.jsx)(r.A,{className:"border-bottom",children:(0,I.jsx)("span",{children:"Add Products Details"})}),(0,I.jsxs)("form",{onSubmit:e=>{e.preventDefault(),B.Item_Id?(A(e=>[...e.filter(e=>!(0,c.id)(e.Item_Id,B.Item_Id)),Object.fromEntries(Object.entries(w).map(e=>{let[l,a]=e;const t=U(B.Item_Id),s=G?t.Igst_P:t.Gst_P,d=s>0,{Bill_Qty:r,Item_Rate:o,Amount:n}=B,i=Q?"zerotax":D?"remove":"add",c=(0,m.v)(o,s,i),u=(0,m.v)(n,s,i),v=G?0:u.cgst_per,_=G?u.igst_per:0,h=G?0:u.cgst_amount,x=G?u.igst_amount:0;switch(l){case"Item_Name":return[l,t.Product_Name];case"Taxable_Rate":return[l,c.base_amount];case"Total_Qty":return[l,r];case"Taxble":return[l,d?1:0];case"Taxable_Amount":return[l,u.base_amount];case"Tax_Rate":return[l,s];case"Cgst":case"Sgst":return[l,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[l,Q?0:h];case"Igst":return[l,null!==_&&void 0!==_?_:0];case"Igst_Amo":return[l,Q?0:x];case"Final_Amo":return[l,u.with_tax];default:return[l,B[l]||a]}}))]),E()):x.oR.warn("Select Product")},children:[(0,I.jsx)(o.A,{children:(0,I.jsxs)("div",{className:"row pb-5",children:[(0,I.jsxs)("div",{className:"col-6 p-2",children:[(0,I.jsx)("label",{children:"Brand"}),(0,I.jsx)(_.Ay,{value:{value:B.BrandID,label:B.Brand},onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{BrandID:e.value,Brand:e.label})),options:[{value:"",label:"select",isDisabled:!0},...C.map(e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200,filterOption:c.GI})]}),(0,I.jsxs)("div",{className:"col-6 p-2",children:[(0,I.jsx)("label",{children:"Group"}),(0,I.jsx)(_.Ay,{value:{value:B.GroupID,label:B.Group},onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{GroupID:e.value,Group:e.label})),options:[{value:"",label:"select",isDisabled:!0},...f.filter(e=>!B.BrandID||(0,c.id)(e.Brand,B.BrandID)).reduce((e,l)=>(e.some(e=>e.value===l.Product_Group)||e.push({value:l.Product_Group,label:l.Pro_Group}),e),[])],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200,filterOption:c.GI})]}),(0,I.jsxs)("div",{className:Object.hasOwn(B,"GoDown_Id")?"col-md-8 p-2":"col-12 p-2",children:[(0,I.jsxs)("label",{children:["Item Name ",(0,I.jsx)(v.A,{})]}),(0,I.jsx)(_.Ay,{value:{value:B.Item_Id,label:null===(l=U(B.Item_Id))||void 0===l?void 0:l.Product_Name},isDisabled:(0,c.IQ)(B.Pre_Id),menuPortalTarget:document.body,onChange:e=>{const l=U(e.value);O(a=>{var s,d,r,o,n,i,c;return(0,t.A)((0,t.A)({},a),{},{Group:null!==(s=l.Pro_Group)&&void 0!==s?s:a.Group,GroupID:null!==(d=l.Product_Group)&&void 0!==d?d:a.GroupID,Brand:null!==(r=l.Brand_Name)&&void 0!==r?r:a.Brand,BrandID:null!==(o=l.Brand)&&void 0!==o?o:a.BrandID,Item_Id:e.value,Item_Rate:null!==(n=l.Item_Rate)&&void 0!==n?n:0,Bill_Qty:0,Amount:0,Unit_Id:null!==(i=l.UOM_Id)&&void 0!==i?i:a.Unit_Id,Unit_Name:null!==(c=l.Units)&&void 0!==c?c:a.Unit_Name,HSN_Code:null===l||void 0===l?void 0:l.HSN_Code})})},options:[{value:"",label:"select",isDisabled:!0},...[...f.filter(e=>!B.BrandID||(0,c.id)(e.Brand,B.BrandID)).filter(e=>!B.GroupID||(0,c.id)(e.Product_Group,B.GroupID))].map(e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==b.findIndex(l=>(0,c.id)(null===l||void 0===l?void 0:l.Item_Id,null===e||void 0===e?void 0:e.Product_Id))}))],styles:h.MR,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200,filterOption:c.GI})]}),Object.hasOwn(B,"GoDown_Id")&&(0,I.jsxs)("div",{className:"col-md-4 p-2",children:[(0,I.jsx)("label",{children:"Godown"}),(0,I.jsx)(_.Ay,{value:{value:null===B||void 0===B?void 0:B.GoDown_Id,label:(null===(a=y.find(e=>(0,c.id)(e.Godown_Id,null===B||void 0===B?void 0:B.GoDown_Id)))||void 0===a?void 0:a.Godown_Name)||""},onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{GoDown_Id:e.value})),options:[{value:"",label:"select",isDisabled:!0},{label:"Stock-Available-Godowns",options:(0,c.$r)(y).filter(e=>{const l=(0,c.$r)(R);return 0!==l.length&&l.some(l=>(0,c.id)(null===l||void 0===l?void 0:l.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===B||void 0===B?void 0:B.Item_Id,null===l||void 0===l?void 0:l.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:(null===e||void 0===e?void 0:e.Godown_Name)+" (Bal: "+(0,p.K)(null===B||void 0===B?void 0:B.Item_Id,null===e||void 0===e?void 0:e.Godown_Id,R)+")"}))},{label:"Other Godowns",options:(0,c.$r)(y).filter(e=>{const l=(0,c.$r)(R);return 0===l.length||!l.some(l=>(0,c.id)(null===l||void 0===l?void 0:l.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===B||void 0===B?void 0:B.Item_Id,null===l||void 0===l?void 0:l.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:null===e||void 0===e?void 0:e.Godown_Name}))}],styles:h.MR,isDisabled:!(0,c.IQ)(null===B||void 0===B?void 0:B.Item_Id),menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Godown",filterOption:c.GI})]}),(0,I.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,I.jsxs)("label",{children:["Quantity ",(0,I.jsx)(v.A,{})]}),(0,I.jsx)("input",{required:!0,value:B.Bill_Qty?B.Bill_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(B.Item_Id),onChange:e=>{B.Item_Rate?O(l=>(0,t.A)((0,t.A)({},l),{},{Amount:(0,c.JH)(B.Item_Rate,e.target.value),Bill_Qty:e.target.value})):B.Amount?O(l=>(0,t.A)((0,t.A)({},l),{},{Item_Rate:(0,c.SX)(l.Amount,e.target.value),Bill_Qty:e.target.value})):O(l=>(0,t.A)((0,t.A)({},l),{},{Bill_Qty:e.target.value}))},className:"cus-inpt",min:1})]}),Object.hasOwn(B,"Act_Qty")&&(0,I.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,I.jsx)("label",{children:"Actual Quantity "}),(0,I.jsx)("input",{value:B.Act_Qty?B.Act_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(B.Item_Id),onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{Act_Qty:e.target.value})),required:!0,className:"cus-inpt"})]}),(0,I.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,I.jsx)("label",{children:"Rate "}),(0,I.jsx)("input",{value:B.Item_Rate?B.Item_Rate:"",onInput:c.BE,disabled:!(0,c.IQ)(B.Item_Id),onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{Item_Rate:e.target.value,Amount:l.Bill_Qty?(0,c.JH)(e.target.value,l.Bill_Qty):l.Amount})),required:!0,className:"cus-inpt"})]}),(0,I.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,I.jsx)("label",{children:"UOM"}),(0,I.jsxs)("select",{value:Object.hasOwn(B,"UOM")?B.UOM:Object.hasOwn(B,"Unit_Id")?B.Unit_Id:"",onChange:e=>{const l=e.target.selectedIndex,a=e.target.options[l].text,s=e.target.value;O(e=>(0,t.A)((0,t.A)({},e),{},{UOM:s,Unit_Id:s,Units:a,Unit_Name:a}))},className:"cus-inpt",disabled:!(0,c.IQ)(B.Item_Id),children:[(0,I.jsx)("option",{value:"",disabled:!0,children:"select"}),S.map((e,l)=>(0,I.jsx)("option",{value:e.Unit_Id,children:e.Units},l))]})]}),(0,I.jsxs)("div",{className:"col-md-6 p-2",children:[(0,I.jsx)("label",{children:"Amount"}),(0,I.jsx)("input",{required:!0,value:B.Amount?B.Amount:"",onInput:c.BE,disabled:!(0,c.IQ)(B.Item_Id),onChange:e=>O(l=>(0,t.A)((0,t.A)({},l),{},{Amount:e.target.value,Item_Rate:l.Bill_Qty?(0,c.SX)(e.target.value,l.Bill_Qty):l.Item_Rate})),className:"cus-inpt",min:1})]})]})}),(0,I.jsxs)(n.A,{className:"d-flex justify-content-between align-items-center",children:[(0,I.jsx)(i.A,{onClick:()=>O(w),type:"button",startIcon:(0,I.jsx)(u.A,{}),children:"Clear"}),(0,I.jsxs)("span",{children:[(0,I.jsx)(i.A,{type:"button",onClick:E,children:"cancel"}),(0,I.jsx)(i.A,{type:"submit",variant:"outlined",children:"Add"})]})]})]})]})]})}}}]);
//# sourceMappingURL=7611.b679bb64.chunk.js.map