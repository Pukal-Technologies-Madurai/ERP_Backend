"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[3096],{4391(e,t,o){o.r(t),o.d(t,{capitalize:()=>a.A,createChainedFunction:()=>s.A,createSvgIcon:()=>n.A,debounce:()=>r.A,deprecatedPropType:()=>d,isMuiElement:()=>i.A,ownerDocument:()=>c.A,ownerWindow:()=>u.A,requirePropFactory:()=>_,setRef:()=>m,unstable_ClassNameGenerator:()=>C,unstable_useEnhancedEffect:()=>v.A,unstable_useId:()=>I.A,unsupportedProp:()=>p,useControlled:()=>g.A,useEventCallback:()=>A.A,useForkRef:()=>x.A,useIsFocusVisible:()=>h.A});var l=o(79386),a=o(6803),s=o(6593),n=o(59662),r=o(80950);const d=function(e,t){return()=>null};var i=o(27328),c=o(22427),u=o(36078);const _=function(e,t){return()=>null};const m=o(26564).A;var v=o(55013),I=o(45879);const p=function(e,t,o,l,a){return null};var g=o(54516),A=o(93319),x=o(95849),h=o(87844);const C={configure:e=>{l.A.configure(e)}}},6593(e,t,o){o.d(t,{A:()=>l});const l=o(42456).A},10204(e,t,o){o.d(t,{T:()=>l,X:()=>a});const l=[{id:0,label:"New",color:" bg-info text-white "},{id:1,label:"Verified",color:" bg-warning text-white "},{id:2,label:"Converted",color:" bg-success text-white "},{id:3,label:"Canceled",color:" bg-danger text-white "}],a=[{id:1,label:"New",color:" bg-info text-white "},{id:2,label:"Progess",color:" bg-warning text-white "},{id:3,label:"Completed",color:" bg-success text-white "},{id:4,label:"Canceled",color:" bg-danger text-white "}]},27328(e,t,o){o.d(t,{A:()=>a});var l=o(65043);const a=function(e,t){var o,a;return l.isValidElement(e)&&-1!==t.indexOf(null!=(o=e.type.muiName)?o:null==(a=e.type)||null==(a=a._payload)||null==(a=a.value)?void 0:a.muiName)}},40039(e,t,o){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l.createSvgIcon}});var l=o(4391)},42841(e,t,o){var l=o(24994);t.A=void 0;var a=l(o(40039)),s=o(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M6 6v2h8.59L5 17.59 6.41 19 16 9.41V18h2V6z"}),"ArrowOutward")},43735(e,t,o){o.d(t,{A:()=>T});var l=o(89379),a=o(65043),s=o(83462),n=o(12110),r=o(17392),d=o(11906),i=o(26494),c=o(7204),u=o(63406),_=o(91036),m=o(97707),v=o(70141),I=o(33438),p=o(51387),g=o(83560),A=o(65074),x=o(48471),h=o(14844),C=o(97280),f=o(38641),b=o(24651),y=o(56779),j=o(34104),N=o(35786),S=o(70579);const w=(0,m.aN)().user,T=e=>{let{loadingOn:t,loadingOff:o,open:c,onClose:u,editValues:T,defaultValues:P,transactionType:B,onSuccess:E}=e;const[R,D]=(0,a.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],brand:[],godown:[],expence:[],stockInGodown:[],stockItemLedgerName:[]}),[O,Q]=(0,a.useState)({addProductDialog:!1,importFromSaleOrder:!1}),[k,L]=(0,a.useState)(C.Q4),[U,z]=(0,a.useState)([]),[M,V]=(0,a.useState)([]),[F,H]=(0,a.useState)([]),[$,W]=(0,a.useState)(null),q=(0,m.id)(k.GST_Inclusive,1),X=(0,m.id)(k.GST_Inclusive,2),J=(0,m.id)(k.IS_IGST,1),K=X?"zerotax":q?"remove":"add",Y=3-U.length;(0,a.useEffect)(()=>{if(!c)return;(async()=>{try{t&&t();const[e,o,a,s,n,r,d,i,c,u,_]=await Promise.all([(0,A.z)({address:"masters/branch/dropDown"}),(0,A.z)({address:"masters/products"}),(0,A.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===w||void 0===w?void 0:w.Company_id)}),(0,A.z)({address:"masters/voucher?module=SALES"}),(0,A.z)({address:"masters/uom"}),(0,A.z)({address:"dataEntry/costCenter"}),(0,A.z)({address:"dataEntry/costCenter/category"}),(0,A.z)({address:"dataEntry/godownLocationMaster"}),(0,A.z)({address:"masters/defaultAccountMaster"}),(0,A.z)({address:"sales/stockInGodown"}),(0,A.z)({address:"purchase/stockItemLedgerName?type=SALES"})]),v=(e.success?e.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===t||void 0===t?void 0:t.BranchName)),I=(o.success?o.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===t||void 0===t?void 0:t.Product_Name)),p=(a.success?a.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===t||void 0===t?void 0:t.Retailer_Name)),g=(s.success?s.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===t||void 0===t?void 0:t.Voucher_Type)),x=(n.success?n.data:[]).sort((e,t)=>String(e.Units).localeCompare(t.Units)),h=(r.success?r.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===t||void 0===t?void 0:t.Cost_Center_Name)),C=(d.success?d.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===t||void 0===t?void 0:t.Cost_Category)),f=(i.success?i.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Godown_Name).localeCompare(null===t||void 0===t?void 0:t.Godown_Name)),b=(c.success?(0,m.$r)(c.data):[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Account_Name).localeCompare(null===t||void 0===t?void 0:t.Account_Name)),y=(u.success?u.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.stock_item_name).localeCompare(null===t||void 0===t?void 0:t.stock_item_name)),j=(_.success?_.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name).localeCompare(null===t||void 0===t?void 0:t.Stock_Item_Ledger_Name));D(e=>(0,l.A)((0,l.A)({},e),{},{products:I,branch:v,retailers:p,voucherType:g,uom:x,staff:h,staffType:C,godown:f,brand:(0,m.Mn)(I,"Brand",["Brand_Name"]),expence:b.filter(e=>!(0,m.xL)(e.Type,"DEFAULT")).map(e=>({Id:e.Acc_Id,Expence_Name:e.Account_Name})),stockInGodown:y,stockItemLedgerName:j}))}catch(e){console.error("Error fetching data:",e)}finally{o&&o()}})()},[null===w||void 0===w?void 0:w.Company_id,c]);(0,a.useEffect)(()=>{z(e=>[...e].map(e=>Object.fromEntries(Object.entries(e).map(t=>{let[o,l]=t;const a=function(){var e;let t=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,m.id)(e.Product_Id,t)))&&void 0!==e?e:{}}(R.products,null===e||void 0===e?void 0:e.Item_Id),s=J?a.Igst_P:a.Gst_P,n=s>0,{Bill_Qty:r,Item_Rate:d,Amount:i}=e,c=(0,h.v)(d,s,K),u=(0,h.v)(i,s,K),_=J?0:u.cgst_per,v=J?u.igst_per:0,I=J?0:u.cgst_amount,p=J?u.igst_amount:0;switch(o){case"Taxable_Rate":return[o,c.base_amount];case"Total_Qty":return[o,r];case"Taxble":return[o,n?1:0];case"Taxable_Amount":return[o,u.base_amount];case"Tax_Rate":return[o,s];case"Cgst":case"Sgst":return[o,null!==_&&void 0!==_?_:0];case"Cgst_Amo":case"Sgst_Amo":return[o,X?0:I];case"Igst":return[o,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[o,X?0:p];case"Final_Amo":return[o,u.with_tax];default:return[o,e[o]||l]}}))))},[R.products,J,K]),(0,a.useEffect)(()=>{V(e=>[...e].map(e=>{const t=J?(0,m.Ro)(null===e||void 0===e?void 0:e.Igst):0,o=J?0:(0,m.Ro)(null===e||void 0===e?void 0:e.Cgst),a=J?0:(0,m.Ro)(null===e||void 0===e?void 0:e.Sgst),s=(0,m.Ro)(null===e||void 0===e?void 0:e.Expence_Value),n=J?t:(0,m.Lr)(o,a),r=(0,h.v)(s,n,K);return(0,l.A)((0,l.A)({},e),{},{Cgst:o,Sgst:a,Igst:t,Expence_Value:s,Cgst_Amo:o>0?r.cgst_amount:0,Sgst_Amo:a>0?r.sgst_amount:0,Igst_Amo:t>0?r.igst_amount:0})}))},[R.expence,J,K]),(0,a.useEffect)(()=>{if((0,m.aF)(T)&&Array.isArray(null===T||void 0===T?void 0:T.ProductList)&&R.staff.length>0&&R.staffType.length>0){const{ProductList:e,Staffs_Array:t,Broker_Id:o,Broker_Name:a,Expence_Array:s,Transporter_Id:n,Transporter_Name:r}=T,d=(T.Expence_Array||T.expenceArray||T.Expenses||T.expenses||T.ExpenceList||T.expenceList,T.Retailer_Id||T.Custome_Id||0),i=R.retailers.find(e=>(0,m.id)(e.Retailer_Id,d));V((0,m.$r)(s).map(e=>Object.fromEntries(Object.entries(C.ju).map(t=>{var o;let[l,a]=t;return[l,null!==(o=e[l])&&void 0!==o?o:a]})))),L(e=>(0,l.A)((0,l.A)({},e),{},{Do_Id:T.Pre_Id||"",So_No:T.Pre_Id||"",So_Date:T.Pre_Date?(0,m.ny)(T.Pre_Date):"",Retailer_Id:T.Custome_Id||(null===T||void 0===T?void 0:T.Retailer_Id)||"",Retailer_Name:(null===i||void 0===i?void 0:i.Retailer_Name)||"",Broker_Id:T.Broker_Id||"",Broker_Name:T.Broker_Name||"",Transporter_Id:T.Transporter_Id||"",Transporter_Name:T.Transporter_Name||"",TrasnportType:T.TrasnportType||2,Voucher_Type:T.baseData||0,Status:T.Status||"",isConverted:T.isConverted||0,Total_Invoice_value:T.Total_Invoice_value||0})),z(e.map(e=>(0,l.A)((0,l.A)({},C.a4),{},{Item_Id:e.Item_Id||"",Item_Name:e.Product_Name||"",HSN_Code:e.HSN_Code||"",Bill_Qty:e.Bill_Qty||0,Act_Qty:e.Bill_Qty||0,Item_Rate:e.Item_Rate||0,Amount:e.Amount||0,GoDown_Id:e.Godown_Id||"",Tax_Rate:e.Tax_Rate||0,Cgst:e.Cgst||0,UOM:e.Unit_Id||0,Units:e.Unit_Name||"",Sgst:e.Sgst||0,Igst:e.Igst||0,Cgst_Amo:e.Cgst_Amo||0,Sgst_Amo:e.Sgst_Amo||0,Igst_Amo:e.Igst_Amo||0,Taxable_Amount:e.Taxable_Amount||0,Final_Amo:e.Final_Amo||0})));let c=[];const u=e=>{const t=R.staffType.find(t=>(0,m.xL)(t.Cost_Category,e));return(null===t||void 0===t?void 0:t.Cost_Category_Id)||""};if(o&&!(0,m.id)(o,0)){const e=R.staff.find(e=>(0,m.id)(e.Cost_Center_Id,o)),t=u("Broker");e&&c.push({Involved_Emp_Id:e.Cost_Center_Id,EmpName:e.Cost_Center_Name,Cost_Center_Type_Id:t,Cost_Center_Type:"Broker"})}if(n&&!(0,m.id)(n,0)){const e=R.staff.find(e=>(0,m.id)(e.Cost_Center_Id,n)),t=u("Transport");e&&c.push({Involved_Emp_Id:e.Cost_Center_Id,EmpName:e.Cost_Center_Name,Cost_Center_Type_Id:t,Cost_Center_Type:"Transporter"})}(0,m.$r)(t).forEach((e,t)=>{const o=R.staff.find(t=>(0,m.id)(t.Cost_Center_Id,e.Staff_Id));let l=e.Cost_Cat_Id,a=e.Cost_Cat_Name;!l&&a&&(l=u(a)),o&&c.push({Involved_Emp_Id:o.Cost_Center_Id,EmpName:o.Cost_Center_Name,Cost_Center_Type_Id:l||"",Cost_Center_Type:a||""})}),H(c)}},[T,R.staff,R.staffType,R.retailers]),(0,a.useEffect)(()=>{V(e=>[...e].map(e=>{const t=J?(0,m.Ro)(null===e||void 0===e?void 0:e.Igst):0,o=J?0:(0,m.Ro)(null===e||void 0===e?void 0:e.Cgst),a=J?0:(0,m.Ro)(null===e||void 0===e?void 0:e.Sgst),s=(0,m.Ro)(null===e||void 0===e?void 0:e.Expence_Value),n=J?t:(0,m.Lr)(o,a),r=(0,h.v)(s,n,K);return(0,l.A)((0,l.A)({},e),{},{Cgst:o,Sgst:a,Igst:t,Expence_Value:s,Cgst_Amo:o>0?r.cgst_amount:0,Sgst_Amo:a>0?r.sgst_amount:0,Igst_Amo:t>0?r.igst_amount:0})}))},[R.expence,J,K]);const Z=()=>{t&&t();const e=F.map(e=>({Involved_Emp_Id:e.Involved_Emp_Id,Cost_Center_Type_Id:e.Cost_Center_Type_Id})),a=U.filter(e=>!(0===Number(e.Bill_Qty)&&0===Number(e.Act_Qty)));(0,A.z)({address:"sales/salesOrderSalesInvoice",method:"POST",bodyData:(0,l.A)((0,l.A)((0,l.A)({},P),k),{},{Pre_Id:k.Do_Id,Product_Array:a,staff_Involved_List:e,Expence_Array:M,transactionType:B})}).then(e=>{e.success?(L(C.Q4),z([]),V([]),H([]),_.oR.success(e.message),E&&E(),u(!0)):_.oR.warn(e.message)}).catch(e=>console.error(e)).finally(()=>{o&&o()})};return c?(0,S.jsx)(s.A,{open:c,onClose:()=>u(!1),maxWidth:"xl",fullWidth:!0,children:(0,S.jsxs)("div",{style:{maxHeight:"90vh",overflow:"auto"},children:[(0,S.jsx)(y.A,{orderProducts:U,setOrderProducts:z,open:O.addProductDialog,onClose:()=>{Q(e=>(0,l.A)((0,l.A)({},e),{},{addProductDialog:!1})),W(null)},products:R.products,brands:R.brand,uom:R.uom,godowns:R.godown,GST_Inclusive:k.GST_Inclusive,IS_IGST:J,editValues:$,initialValue:(0,l.A)((0,l.A)({},C.a4),{},{Pre_Id:k.So_No}),stockInGodown:R.stockInGodown}),(0,S.jsxs)(n.A,{children:[(0,S.jsxs)("div",{className:"d-flex flex-wrap align-items-center border-bottom py-2 px-3",children:[(0,S.jsx)("span",{className:"flex-grow-1 fa-16 fw-bold",children:"Sales Invoice"}),(0,S.jsxs)("span",{children:[(0,S.jsx)(r.A,{onClick:()=>u(!1),children:(0,S.jsx)(I.A,{})}),(0,S.jsx)(d.A,{onClick:()=>Z(),variant:"contained",children:"Submit"})]})]}),(0,S.jsxs)(i.A,{children:[(0,S.jsxs)("div",{className:"row p-0",children:[(0,S.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,S.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,S.jsx)(G,{StaffArray:F,setStaffArray:e=>{H(e)},costCenter:R.staff,costCategory:R.staffType})})}),(0,S.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,S.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,S.jsx)(f.A,{invoiceInfo:k,setInvoiceInfo:L,retailers:R.retailers,branches:R.branch,voucherType:R.voucherType,stockItemLedgerName:R.stockItemLedgerName})})})]}),(0,S.jsx)(x.Ay,{title:"Items",headerFontSizePx:13,bodyFontSizePx:13,EnableSerialNumber:!0,disablePagination:!0,ButtonArea:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.A,{onClick:()=>{W(null),Q(e=>(0,l.A)((0,l.A)({},e),{},{addProductDialog:!0}))},sx:{ml:1},variant:"outlined",type:"button",startIcon:(0,S.jsx)(v.A,{}),disabled:!(0,m.IQ)(k.Retailer_Id)||U.length>0&&(0,m.IQ)(k.So_No),children:"Add Product"}),(0,S.jsx)(j.A,{loadingOn:t,loadingOff:o,open:O.importFromSaleOrder,onClose:()=>Q(e=>(0,l.A)((0,l.A)({},e),{},{importFromSaleOrder:!1})),retailer:null===k||void 0===k?void 0:k.Retailer_Id,selectedItems:U,setSelectedItems:z,staffArray:F,setStaffArray:H,products:R.products,GST_Inclusive:k.GST_Inclusive,IS_IGST:J,invoiceInfo:k,setInvoiceInfo:L,godowns:R.godown,stockInGodown:R.stockInGodown})]}),dataArray:[...[...U,...Array.from({length:Y>0?Y:0}).map(e=>C.a4)].filter(e=>!(0===Number(e.Bill_Qty)&&0===Number(e.Act_Qty)))],columns:[(0,x.Lj)("Item_Name","string"),(0,x.Lj)("HSN_Code","string"),(0,x.Lj)("Bill_Qty","number"),(0,x.Lj)("Act_Qty","number"),(0,x.Lj)("Item_Rate","number"),{isVisible:1,ColumnHeader:"Tax",isCustomCell:!0,Cell:e=>{let{row:t}=e;const{Cgst:o=0,Sgst:l=0,Igst:a=0,Cgst_Amo:s=0,Sgst_Amo:n=0,Igst_Amo:r=0}=t,d=J?a:(0,m.Lr)(o,l),i=J?r:(0,m.Lr)(s,n);return(0,m.IQ)(null===t||void 0===t?void 0:t.Item_Id)?"".concat(i," - (").concat(d," %)"):""}},{isVisible:1,ColumnHeader:"Godown",isCustomCell:!0,Cell:e=>{var t,o;let{row:l}=e;return null!==(t=null===(o=R.godown.find(e=>(0,m.id)(e.Godown_Id,null===l||void 0===l?void 0:l.GoDown_Id)))||void 0===o?void 0:o.Godown_Name)&&void 0!==t?t:""}},(0,x.Lj)("Amount","number"),{isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(r.A,{onClick:()=>{W(t),Q(e=>(0,l.A)((0,l.A)({},e),{},{addProductDialog:!0}))},size:"small",type:"button",disabled:!(0,m.IQ)(null===t||void 0===t?void 0:t.Item_Id),children:(0,S.jsx)(g.A,{})}),(0,S.jsx)(r.A,{size:"small",type:"button",onClick:()=>z(e=>e.filter(e=>!(0,m.id)(e.Item_Id,t.Item_Id))),color:"error",disabled:!(0,m.IQ)(null===t||void 0===t?void 0:t.Item_Id),children:(0,S.jsx)(p.A,{})})]})},ColumnHeader:"Action",isVisible:1}]}),(0,S.jsx)("br",{}),(0,S.jsx)(N.A,{invoiceExpences:M,setInvoiceExpences:V,expenceMaster:R.expence,IS_IGST:J,taxType:K}),(0,S.jsx)("br",{}),(0,S.jsx)(b.A,{invoiceProducts:U,invoiceExpences:M,isNotTaxableBill:X,isInclusive:q,IS_IGST:J,products:R.products,invoiceInfo:k,setInvoiceInfo:L})]})]})]})}):null},G=e=>{let{StaffArray:t=[],setStaffArray:o,costCenter:a=[],costCategory:s=[]}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,S.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,S.jsx)(d.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>o(e=>[...e,{Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",Cost_Center_Type:""}]),children:"Add"})]}),(0,S.jsxs)("table",{className:"table table-bordered",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"fa-13",children:"Sno"}),(0,S.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,S.jsx)("th",{className:"fa-13",children:"Category"}),(0,S.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,S.jsx)("tbody",{children:(0,m.$r)(t).map((e,n)=>{const d=e.Cost_Center_Type_Id||(e=>{const t=s.find(t=>(0,m.xL)(t.Cost_Category,e));return(null===t||void 0===t?void 0:t.Cost_Category_Id)||""})(e.Cost_Center_Type);return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"fa-13 vctr text-center",children:n+1}),(0,S.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,S.jsx)(c.Ay,{value:{value:e.Involved_Emp_Id,label:e.EmpName||"Select Staff"},onChange:e=>{a.find(t=>(0,m.id)(t.Cost_Center_Id,e.value));const s=t.map((t,o)=>o===n?(0,l.A)((0,l.A)({},t),{},{Involved_Emp_Id:Number(e.value),EmpName:e.label}):t);o(s)},options:a.filter(e=>!t.some((t,o)=>o!==n&&(0,m.id)(t.Involved_Emp_Id,e.Cost_Center_Id))).map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:u.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,S.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,S.jsxs)("select",{value:d,onChange:e=>{const a=s.find(t=>(0,m.id)(t.Cost_Category_Id,e.target.value)),r=t.map((t,o)=>o===n?(0,l.A)((0,l.A)({},t),{},{Cost_Center_Type_Id:e.target.value,Cost_Center_Type:(null===a||void 0===a?void 0:a.Cost_Category)||""}):t);o(r)},className:"cus-inpt p-2 border-0",children:[(0,S.jsx)("option",{value:"",children:"Select"}),s.map((e,t)=>(0,S.jsx)("option",{value:e.Cost_Category_Id,children:e.Cost_Category},t))]})}),(0,S.jsx)("td",{className:"fa-13 vctr p-0",children:(0,S.jsx)(r.A,{onClick:()=>{const e=t.filter((e,t)=>t!==n);o(e)},size:"small",children:(0,S.jsx)(p.A,{color:"error"})})})]},n)})})]})]})}},56779(e,t,o){o.d(t,{A:()=>x});var l=o(89379),a=o(65043),s=o(83462),n=o(26600),r=o(35316),d=o(29347),i=o(11906),c=o(97707),u=o(34496),_=o(14792),m=o(14844),v=o(7204),I=o(63406),p=o(91036),g=o(34104),A=o(70579);const x=e=>{var t,o;let{children:x,orderProducts:h=[],setOrderProducts:C,open:f=!1,onClose:b,products:y=[],brands:j=[],uom:N=[],godowns:S=[],GST_Inclusive:w,IS_IGST:T,editValues:G=null,initialValue:P={},stockInGodown:B=[]}=e;const[E,R]=(0,a.useState)(P),D=(0,c.id)(w,1),O=(0,c.id)(w,2);(0,a.useEffect)(()=>{(0,c.aF)(G)&&f&&R(e=>Object.fromEntries(Object.entries(e).map(e=>{let[t,o]=e;return[t,G[t]?G[t]:o]})))},[G]);const Q=e=>{var t;return null!==(t=null===y||void 0===y?void 0:y.find(t=>(0,c.id)(null===t||void 0===t?void 0:t.Product_Id,e)))&&void 0!==t?t:{}},k=()=>{R(P),b()};return(0,A.jsxs)(A.Fragment,{children:[x,(0,A.jsxs)(s.A,{open:f,onClose:k,maxWidth:"md",fullWidth:!0,children:[(0,A.jsx)(n.A,{className:"border-bottom",children:(0,A.jsx)("span",{children:"Add Products Details"})}),(0,A.jsxs)("form",{onSubmit:e=>{e.preventDefault(),E.Item_Id?(C(e=>[...e.filter(e=>!(0,c.id)(e.Item_Id,E.Item_Id)),Object.fromEntries(Object.entries(P).map(e=>{let[t,o]=e;const l=Q(E.Item_Id),a=T?l.Igst_P:l.Gst_P,s=a>0,{Bill_Qty:n,Item_Rate:r,Amount:d}=E,i=O?"zerotax":D?"remove":"add",c=(0,m.v)(r,a,i),u=(0,m.v)(d,a,i),_=T?0:u.cgst_per,v=T?u.igst_per:0,I=T?0:u.cgst_amount,p=T?u.igst_amount:0;switch(t){case"Item_Name":return[t,l.Product_Name];case"Taxable_Rate":return[t,c.base_amount];case"Total_Qty":return[t,n];case"Taxble":return[t,s?1:0];case"Taxable_Amount":return[t,u.base_amount];case"Tax_Rate":return[t,a];case"Cgst":case"Sgst":return[t,null!==_&&void 0!==_?_:0];case"Cgst_Amo":case"Sgst_Amo":return[t,O?0:I];case"Igst":return[t,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[t,O?0:p];case"Final_Amo":return[t,u.with_tax];default:return[t,E[t]||o]}}))]),k()):p.oR.warn("Select Product")},children:[(0,A.jsx)(r.A,{children:(0,A.jsxs)("div",{className:"row pb-5",children:[(0,A.jsxs)("div",{className:"col-6 p-2",children:[(0,A.jsx)("label",{children:"Brand"}),(0,A.jsx)(v.Ay,{value:{value:E.BrandID,label:E.Brand},onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{BrandID:e.value,Brand:e.label})),options:[{value:"",label:"select",isDisabled:!0},...j.map(e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name}))],styles:I.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200,filterOption:c.GI})]}),(0,A.jsxs)("div",{className:"col-6 p-2",children:[(0,A.jsx)("label",{children:"Group"}),(0,A.jsx)(v.Ay,{value:{value:E.GroupID,label:E.Group},onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{GroupID:e.value,Group:e.label})),options:[{value:"",label:"select",isDisabled:!0},...y.filter(e=>!E.BrandID||(0,c.id)(e.Brand,E.BrandID)).reduce((e,t)=>(e.some(e=>e.value===t.Product_Group)||e.push({value:t.Product_Group,label:t.Pro_Group}),e),[])],styles:I.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200,filterOption:c.GI})]}),(0,A.jsxs)("div",{className:Object.hasOwn(E,"GoDown_Id")?"col-md-8 p-2":"col-12 p-2",children:[(0,A.jsxs)("label",{children:["Item Name ",(0,A.jsx)(_.A,{})]}),(0,A.jsx)(v.Ay,{value:{value:E.Item_Id,label:null===(t=Q(E.Item_Id))||void 0===t?void 0:t.Product_Name},isDisabled:(0,c.IQ)(E.Pre_Id),menuPortalTarget:document.body,onChange:e=>{const t=Q(e.value);R(o=>{var a,s,n,r,d,i,c;return(0,l.A)((0,l.A)({},o),{},{Group:null!==(a=t.Pro_Group)&&void 0!==a?a:o.Group,GroupID:null!==(s=t.Product_Group)&&void 0!==s?s:o.GroupID,Brand:null!==(n=t.Brand_Name)&&void 0!==n?n:o.Brand,BrandID:null!==(r=t.Brand)&&void 0!==r?r:o.BrandID,Item_Id:e.value,Item_Rate:null!==(d=t.Item_Rate)&&void 0!==d?d:0,Bill_Qty:0,Amount:0,Unit_Id:null!==(i=t.UOM_Id)&&void 0!==i?i:o.Unit_Id,Unit_Name:null!==(c=t.Units)&&void 0!==c?c:o.Unit_Name,HSN_Code:null===t||void 0===t?void 0:t.HSN_Code})})},options:[{value:"",label:"select",isDisabled:!0},...[...y.filter(e=>!E.BrandID||(0,c.id)(e.Brand,E.BrandID)).filter(e=>!E.GroupID||(0,c.id)(e.Product_Group,E.GroupID))].map(e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==h.findIndex(t=>(0,c.id)(null===t||void 0===t?void 0:t.Item_Id,null===e||void 0===e?void 0:e.Product_Id))}))],styles:I.MR,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200,filterOption:c.GI})]}),Object.hasOwn(E,"GoDown_Id")&&(0,A.jsxs)("div",{className:"col-md-4 p-2",children:[(0,A.jsx)("label",{children:"Godown"}),(0,A.jsx)(v.Ay,{value:{value:null===E||void 0===E?void 0:E.GoDown_Id,label:(null===(o=S.find(e=>(0,c.id)(e.Godown_Id,null===E||void 0===E?void 0:E.GoDown_Id)))||void 0===o?void 0:o.Godown_Name)||""},onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{GoDown_Id:e.value})),options:[{value:"",label:"select",isDisabled:!0},{label:"Stock-Available-Godowns",options:(0,c.$r)(S).filter(e=>{const t=(0,c.$r)(B);return 0!==t.length&&t.some(t=>(0,c.id)(null===t||void 0===t?void 0:t.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===E||void 0===E?void 0:E.Item_Id,null===t||void 0===t?void 0:t.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:(null===e||void 0===e?void 0:e.Godown_Name)+" (Bal: "+(0,g.K)(null===E||void 0===E?void 0:E.Item_Id,null===e||void 0===e?void 0:e.Godown_Id,B)+")"}))},{label:"Other Godowns",options:(0,c.$r)(S).filter(e=>{const t=(0,c.$r)(B);return 0===t.length||!t.some(t=>(0,c.id)(null===t||void 0===t?void 0:t.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===E||void 0===E?void 0:E.Item_Id,null===t||void 0===t?void 0:t.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:null===e||void 0===e?void 0:e.Godown_Name}))}],styles:I.MR,isDisabled:!(0,c.IQ)(null===E||void 0===E?void 0:E.Item_Id),menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Godown",filterOption:c.GI})]}),(0,A.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,A.jsxs)("label",{children:["Quantity ",(0,A.jsx)(_.A,{})]}),(0,A.jsx)("input",{required:!0,value:E.Bill_Qty?E.Bill_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(E.Item_Id),onChange:e=>{E.Item_Rate?R(t=>(0,l.A)((0,l.A)({},t),{},{Amount:(0,c.JH)(E.Item_Rate,e.target.value),Bill_Qty:e.target.value})):E.Amount?R(t=>(0,l.A)((0,l.A)({},t),{},{Item_Rate:(0,c.SX)(t.Amount,e.target.value),Bill_Qty:e.target.value})):R(t=>(0,l.A)((0,l.A)({},t),{},{Bill_Qty:e.target.value}))},className:"cus-inpt",min:1})]}),Object.hasOwn(E,"Act_Qty")&&(0,A.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,A.jsx)("label",{children:"Actual Quantity "}),(0,A.jsx)("input",{value:E.Act_Qty?E.Act_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(E.Item_Id),onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{Act_Qty:e.target.value})),required:!0,className:"cus-inpt"})]}),(0,A.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,A.jsx)("label",{children:"Rate "}),(0,A.jsx)("input",{value:E.Item_Rate?E.Item_Rate:"",onInput:c.BE,disabled:!(0,c.IQ)(E.Item_Id),onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{Item_Rate:e.target.value,Amount:t.Bill_Qty?(0,c.JH)(e.target.value,t.Bill_Qty):t.Amount})),required:!0,className:"cus-inpt"})]}),(0,A.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,A.jsx)("label",{children:"UOM"}),(0,A.jsxs)("select",{value:Object.hasOwn(E,"UOM")?E.UOM:Object.hasOwn(E,"Unit_Id")?E.Unit_Id:"",onChange:e=>{const t=e.target.selectedIndex,o=e.target.options[t].text,a=e.target.value;R(e=>(0,l.A)((0,l.A)({},e),{},{UOM:a,Unit_Id:a,Units:o,Unit_Name:o}))},className:"cus-inpt",disabled:!(0,c.IQ)(E.Item_Id),children:[(0,A.jsx)("option",{value:"",disabled:!0,children:"select"}),N.map((e,t)=>(0,A.jsx)("option",{value:e.Unit_Id,children:e.Units},t))]})]}),(0,A.jsxs)("div",{className:"col-md-6 p-2",children:[(0,A.jsx)("label",{children:"Amount"}),(0,A.jsx)("input",{required:!0,value:E.Amount?E.Amount:"",onInput:c.BE,disabled:!(0,c.IQ)(E.Item_Id),onChange:e=>R(t=>(0,l.A)((0,l.A)({},t),{},{Amount:e.target.value,Item_Rate:t.Bill_Qty?(0,c.SX)(e.target.value,t.Bill_Qty):t.Item_Rate})),className:"cus-inpt",min:1})]})]})}),(0,A.jsxs)(d.A,{className:"d-flex justify-content-between align-items-center",children:[(0,A.jsx)(i.A,{onClick:()=>R(P),type:"button",startIcon:(0,A.jsx)(u.A,{}),children:"Clear"}),(0,A.jsxs)("span",{children:[(0,A.jsx)(i.A,{type:"button",onClick:k,children:"cancel"}),(0,A.jsx)(i.A,{type:"submit",variant:"outlined",children:"Add"})]})]})]})]})]})}}}]);
//# sourceMappingURL=3096.9c7ccbed.chunk.js.map