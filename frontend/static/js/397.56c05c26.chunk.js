"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[397],{3632:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),r=t(70579);const s=(0,a.A)((0,r.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},10397:(e,l,t)=>{t.r(l),t.d(l,{default:()=>_e});var a=t(89379),r=t(65043),s=t(12110),n=t(77739),i=t(17392),o=t(26494),d=t(97707),c=t(48471),u=t(70579);const m=e=>{let{dataArray:l,days:t}=e;const s=(0,r.useMemo)(()=>l.map(e=>{var l,r,s,n,i;return(0,a.A)((0,a.A)({},e),{},{M2_Avg:null!==(l=(0,d.SX)(e.ALL_Avg_M2,(0,d.Dl)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(r=(0,d.SX)(e.ALL_Avg_M3,(0,d.Dl)(3)/3))&&void 0!==r?r:0,M6_Avg:null!==(s=(0,d.SX)(e.ALL_Avg_M6,(0,d.Dl)(6)/6))&&void 0!==s?s:0,M9_Avg:null!==(n=(0,d.SX)(e.ALL_Avg_M9,(0,d.Dl)(9)/9))&&void 0!==n?n:0,M12_Avg:null!==(i=(0,d.SX)(e.ALL_Avg_One_Year,(0,d.Dl)(12)/12))&&void 0!==i?i:0,Billed_Qty:(0,d.Wd)(e.StockTransaction,"bill_qty"),Billed_Avg:(0,d.Wd)(e.StockTransaction,"bill_qty")/t,StockTransaction:e.StockTransaction.map(e=>{var l,t,r,s,n;return(0,a.A)((0,a.A)({},e),{},{Grade_Item_Group:e.Item_Name_Modified,M2_Avg:null!==(l=(0,d.SX)(e.M2_AVG_Qty,(0,d.Dl)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(t=(0,d.SX)(e.M3_AVG_Qty,(0,d.Dl)(3)/3))&&void 0!==t?t:0,M6_Avg:null!==(r=(0,d.SX)(e.M6_AVG_Qty,(0,d.Dl)(6)/6))&&void 0!==r?r:0,M9_Avg:null!==(s=(0,d.SX)(e.M9_AVG_Qty,(0,d.Dl)(9)/9))&&void 0!==s?s:0,M12_Avg:null!==(n=(0,d.SX)(e.One_Year_AVG_Qty,(0,d.Dl)(12)/12))&&void 0!==n?n:0})})})}).map(e=>(0,a.A)((0,a.A)({},e),{},{Billed_Qty:(0,d.Wd)(e.StockTransaction,"bill_qty")})),[l]);return(0,u.jsx)(r.Fragment,{children:(0,u.jsx)(c.Ay,{dataArray:s,isExpendable:!0,columns:[{Field_Name:"Stock_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"Billed_Qty",isVisible:1,Fied_Data:"number"},{Field_Name:"Billed_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}],expandableComp:e=>{let{row:l}=e;return(0,u.jsx)(c.Ay,{initialPageCount:10,dataArray:Array.isArray(l.StockTransaction)?l.StockTransaction:[],columns:[{Field_Name:"Grade_Item_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"bill_qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}]})},tableMaxHeight:540})})};var p=t(47805),h=t(65074),g=t(28076),x=t(39652),A=t(31159),v=t(67784),b=t(51787),f=t(53193),_=t(79190),j=t(72221),y=t(32143),C=t(79650),N=t(71806),S=t(84882),F=t(73460),D=t(8737),w=t(692),V=t(79484),z=t(433),M=t(30599),O=t(59383),k=t(3632),T=t(59662);const P=(0,T.A)((0,u.jsx)("path",{d:"M22 18v-2H8V4h2L7 1 4 4h2v2H2v2h4v8c0 1.1.9 2 2 2h8v2h-2l3 3 3-3h-2v-2zM10 8h6v6h2V8c0-1.1-.9-2-2-2h-6z"}),"Transform");var H=t(37141),G=t(38504);const B=(0,T.A)((0,u.jsx)("path",{d:"M4 18h2.5v-2.5H4zm0-4.75h2.5v-2.5H4zM4 8.5h2.5V6H4zM17.5 6v2.5H20V6zM13 8.5h2.5V6H13zm4.5 9.5H20v-2.5h-2.5zm0-4.75H20v-2.5h-2.5zM8.5 18H11v-2.5H8.5zm4.5 0h2.5v-2.5H13zM8.5 8.5H11V6H8.5zm4.5 4.75h2.5v-2.5H13zm-4.5 0H11v-2.5H8.5z"}),"ViewCompact"),I=(0,T.A)((0,u.jsx)("path",{d:"M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2zm2.5 2.1h-15V5h15zm0-16.1h-15c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"InsertChartOutlined"),E=(e,l,t)=>{const[s,n]=(0,r.useState)({}),[i,o]=(0,r.useState)(e);(0,r.useEffect)(()=>{o(((e,l,t,a)=>{let r=[...e];return l.forEach(e=>{const l=t[e.Field_Name];l&&("range"===l.type&&(r=r.filter(t=>{const a=t[e.Field_Name];return(void 0===l.min||a>=l.min)&&(void 0===l.max||a<=l.max)})),"date"===l.type&&(r=r.filter(t=>{var a,r;const s=new Date(t[e.Field_Name]);return(!(null!==(a=l.value)&&void 0!==a&&a.start)||s>=new Date(l.value.start))&&(!(null!==(r=l.value)&&void 0!==r&&r.end)||s<=new Date(l.value.end))})),Array.isArray(l)&&(r=l.length?r.filter(t=>{const a=t[e.Field_Name];return l.some(e=>(0,d.GI)({label:String(a)},String(e)))}):r))}),a&&(r=r.filter(e=>l.some(l=>{const t=e[l.Field_Name];return t&&(0,d.GI)({label:String(t)},a)}))),r})(e,l,s,t))},[s,e,l,t]);return{filters:s,filteredData:i,updateFilter:(e,l)=>{n(t=>(0,a.A)((0,a.A)({},t),{},{[e]:l}))},setFilters:n}},L={count:e=>e.length,sum:e=>e.reduce((e,l)=>e+(+l||0),0),min:e=>Math.min(...e),max:e=>Math.max(...e),mean:e=>e.reduce((e,l)=>e+(+l||0),0)/e.length,median:e=>{const l=[...e].sort((e,l)=>e-l),t=Math.floor(l.length/2);return l.length%2?l[t]:(l[t-1]+l[t])/2}},R=(e,l,t)=>{if(!t.length)return e;const a=(e,r)=>{const s=t[r];if(!s)return e;const n={};return e.forEach(e=>{var l;const t=null!==(l=e[s])&&void 0!==l?l:"N/A";n[t]=n[t]||[],n[t].push(e)}),Object.entries(n).map(e=>{let[n,i]=e;const o=((e,l,t)=>{const a={};return l.forEach(l=>{const r=l.Field_Name;if(t.includes(r))return;const s=e.map(e=>e[r]).filter(e=>void 0!==e&&null!==e);if(s.length)if(l.Aggregation&&L[l.Aggregation])a[r]=L[l.Aggregation](s);else switch(l.Fied_Data){case"number":a[r]=L.sum(s);break;case"date":case"time":a[r]=s.reduce((e,l)=>new Date(e)>new Date(l)?e:l);break;default:a[r]=L.count(s)}}),a})(i,l,t);return{__isGroup:!0,__level:r,__groupField:s,__groupValue:n,__aggregates:o,__rows:a(i,r+1)}})};return a(e,0)};var W=t(64912),U=t(10489);const X=e=>{let{open:l,onClose:t,columns:a,grouping:r,onChange:s,onApply:n}=e;return(0,u.jsx)(U.A,{open:l,onClose:t,title:"Group By Columns",onSubmit:n,submitText:"Apply",maxWidth:"sm",children:(0,u.jsx)(W.A,{spacing:2,children:[0,1,2].map(e=>{const l=1===e&&!r[0]||2===e&&!r[1];return(0,u.jsxs)(j.A,{size:"small",displayEmpty:!0,disabled:l,value:r[e]||"",onChange:l=>{const t=l.target.value||"";let a=[...r];if(a[e]=t,!t)for(let r=e+1;r<3;r++)a[r]="";s(void 0,void 0,a)},children:[(0,u.jsxs)(y.A,{value:"",children:["No Grouping (Level ",e+1,")"]}),a.filter(e=>!e.isCustomCell&&1==e.isVisible).map(e=>(0,u.jsx)(y.A,{value:e.Field_Name,children:e.ColumnHeader||e.Field_Name},(0,d.RZ)()))]},(0,d.RZ)())})})})};var Q=t(45424),q=t(98082),Z=t(34535),Y=t(90310);const $=(0,Z.Ay)(e=>(0,u.jsx)(Q.A,(0,a.A)({elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e)))(e=>{let{theme:l}=e;return{"& .MuiPaper-root":(0,a.A)({borderRadius:6,marginTop:l.spacing(1),minWidth:180,color:"rgb(55, 65, 81)",boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":(0,a.A)({fontSize:18,color:l.palette.text.secondary,marginRight:l.spacing(1.5)},l.applyStyles("dark",{color:"inherit"})),"&:active":{backgroundColor:(0,Y.X4)(l.palette.primary.main,l.palette.action.selectedOpacity)}}},l.applyStyles("dark",{color:l.palette.grey[300]}))}}),J=e=>{let{options:l}=e;const[t,a]=(0,r.useState)(null);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.A,{onClick:e=>a(e.currentTarget),children:(0,u.jsx)(q.A,{})}),(0,u.jsx)($,{id:"demo-customized-menu",slotProps:{list:{"aria-labelledby":"demo-customized-button"}},open:!!t,anchorEl:t,onClose:()=>a(null),children:l.map((e,l)=>(0,u.jsxs)(y.A,{disabled:e.disabled,onClick:()=>{e.onClick(),a(null)},children:[(null===e||void 0===e?void 0:e.icon)&&e.icon,e.label]},l))})]})};var K=t(83462),ee=t(26600),le=t(35316),te=t(4598),ae=t(29347),re=t(11906);const se=e=>{let{open:l,columns:t,dispColumns:a,onToggle:r,onOrderChange:n,onClose:i}=e;return(0,u.jsxs)(K.A,{open:l,onClose:i,maxWidth:"lg",fullWidth:!0,children:[(0,u.jsx)(ee.A,{children:"Column Settings"}),(0,u.jsx)(le.A,{children:(0,u.jsx)("div",{className:"row",children:t.map((e,l)=>{var t;const i=a.find(l=>l.Field_Name===e.Field_Name);return(0,u.jsx)("div",{className:"col-md-6 col-lg-4 p-2",children:(0,u.jsxs)(s.A,{className:"p-2 d-flex justify-content-between",children:[(0,u.jsx)(te.A,{checked:!(null===i||void 0===i||!i.isVisible),onChange:l=>r(e.Field_Name,l.target.checked)}),(0,u.jsx)("h6",{className:"mb-0 mx-2 flex-grow-1",style:{fontSize:"0.9rem"},children:e.ColumnHeader||e.Field_Name}),(0,u.jsx)("input",{type:"number",className:"border-0",value:null!==(t=null===i||void 0===i?void 0:i.OrderBy)&&void 0!==t?t:"",onChange:l=>n(e.Field_Name,l.target.value),placeholder:"Order",style:{width:60}})]})},l)})})}),(0,u.jsx)(ae.A,{children:(0,u.jsx)(re.A,{color:"error",onClick:i,children:"Close"})})]})},ne=[{value:"",label:"Default"},{value:"sum",label:"Sum"},{value:"mean",label:"Average"},{value:"median",label:"Median"},{value:"min",label:"Min"},{value:"max",label:"Max"},{value:"count",label:"Count"}],ie=e=>{let{open:l,onClose:t,columns:a,onUpdateAggregation:r}=e;const s=e=>{switch(e){case"number":return"Sum";case"date":case"time":return"Max";default:return"Count"}};return(0,u.jsxs)(K.A,{open:l,onClose:t,maxWidth:"md",fullWidth:!0,children:[(0,u.jsx)(ee.A,{children:"Column Aggregations"}),(0,u.jsx)(le.A,{dividers:!0,children:(0,u.jsxs)(N.A,{size:"small",children:[(0,u.jsx)(S.A,{children:(0,u.jsxs)(g.A,{children:[(0,u.jsx)(x.A,{children:"Column"}),(0,u.jsx)(x.A,{children:"Data Type"}),(0,u.jsx)(x.A,{children:"Default Aggregation"}),(0,u.jsx)(x.A,{children:"Custom Aggregation"})]})}),(0,u.jsx)(F.A,{children:a.filter(e=>!e.isCustomCell&&1==e.isVisible).map(e=>(0,u.jsxs)(g.A,{children:[(0,u.jsx)(x.A,{children:e.ColumnHeader||e.Field_Name}),(0,u.jsx)(x.A,{children:e.Fied_Data||"string"}),(0,u.jsx)(x.A,{className:"text-muted",children:s(e.Fied_Data)}),(0,u.jsx)(x.A,{children:(0,u.jsx)(f.A,{size:"small",fullWidth:!0,children:(0,u.jsx)(j.A,{value:e.Aggregation||"",onChange:l=>r(e.Field_Name,l.target.value),displayEmpty:!0,children:ne.map(e=>(0,u.jsx)(y.A,{value:e.value,children:e.label},e.value))})})})]},(0,d.RZ)()))})]})}),(0,u.jsx)(ae.A,{children:(0,u.jsx)(re.A,{onClick:t,variant:"contained",color:"primary",children:"Done"})})]})},oe=e=>{let{open:l,onSave:t,onClose:s,defaults:n={}}=e;const[i,o]=(0,r.useState)({name:"",displayName:"",reportUrl:"",reportGroup:""});return(0,r.useEffect)(()=>{l&&o({name:"",displayName:"",reportUrl:n.reportUrl||"",reportGroup:n.reportGroup||""})},[l,n]),(0,u.jsxs)(K.A,{open:l,onClose:s,children:[(0,u.jsx)(ee.A,{children:"Save Table State"}),(0,u.jsx)(le.A,{children:(0,u.jsxs)("div",{className:"d-flex flex-column gap-3 mt-1",children:[(0,u.jsx)("label",{htmlFor:"",children:"State Name"}),(0,u.jsx)("input",{type:"text",value:i.name,onChange:e=>o((0,a.A)((0,a.A)({},i),{},{name:e.target.value,displayName:e.target.value})),className:"cus-inpt",style:{minWidth:"310px"}})]})}),(0,u.jsxs)(ae.A,{children:[(0,u.jsx)(re.A,{onClick:s,children:"Cancel"}),(0,u.jsx)(re.A,{variant:"contained",onClick:()=>t(i),disabled:!i.name||!i.displayName,children:"Save"})]})]})};var de=t(12412),ce=t(51962);const ue=e=>{let{column:l,showData:t,filters:r,onChange:s}=e;const{Field_Name:n,Fied_Data:i}=l,o=(e,l)=>{const t=r[n]||{type:"range"};s(n,(0,a.A)((0,a.A)({},t),{},{type:"range",[e]:""===l?void 0:Number(l)}))},d=(e,l)=>{const t=r[n]||{type:"date",value:{}};s(n,(0,a.A)((0,a.A)({},t),{},{type:"date",value:(0,a.A)((0,a.A)({},t.value),{},{[e]:l||void 0})}))};if("number"===i){var c,m;const e=r[n]||{};return(0,u.jsxs)("div",{className:"d-flex gap-1",children:[(0,u.jsx)("input",{type:"number",className:"form-control form-control-sm",placeholder:"Min",value:null!==(c=e.min)&&void 0!==c?c:"",onChange:e=>o("min",e.target.value),style:{minWidth:"60px"}}),(0,u.jsx)("input",{type:"number",className:"form-control form-control-sm",placeholder:"Max",value:null!==(m=e.max)&&void 0!==m?m:"",onChange:e=>o("max",e.target.value),style:{minWidth:"60px"}})]})}if(["date","time"].includes(i)){var p,h,g;const e=(null===(p=r[n])||void 0===p?void 0:p.value)||{},l="time"===i?"time":"date";return(0,u.jsxs)("div",{className:"d-flex flex-column gap-1",children:[(0,u.jsx)("input",{type:l,className:"form-control form-control-sm",placeholder:"Start",value:null!==(h=e.start)&&void 0!==h?h:"",onChange:e=>d("start",e.target.value)}),(0,u.jsx)("input",{type:l,className:"form-control form-control-sm",placeholder:"End",value:null!==(g=e.end)&&void 0!==g?g:"",onChange:e=>d("end",e.target.value)})]})}const x=[...new Set(t.map(e=>{var l;return null===(l=e[n])||void 0===l?void 0:l.toString().toLowerCase().trim()}).filter(Boolean))];return(0,u.jsx)(de.A,{multiple:!0,options:x,value:r[n]||[],onChange:(e,l)=>s(n,l),disableCloseOnSelect:!0,getOptionLabel:e=>e,isOptionEqualToValue:(e,l)=>e===l,renderOption:(e,l,t)=>{let{selected:r}=t;return(0,u.jsxs)("li",(0,a.A)((0,a.A)({},e),{},{children:[(0,u.jsx)(ce.A,{checked:r,style:{marginRight:8}}),l]}))},renderInput:e=>(0,u.jsx)(v.A,(0,a.A)((0,a.A)({},e),{},{size:"small",placeholder:"Select...",variant:"standard"}))})},me=e=>{let{open:l,onClose:t,columns:a,showData:r,filters:n,onChange:i,onClear:o}=e;return(0,u.jsxs)(K.A,{open:l,onClose:t,maxWidth:"md",fullWidth:!0,children:[(0,u.jsx)(ee.A,{children:(0,u.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,u.jsx)("span",{children:"Filters"}),(0,u.jsx)(re.A,{onClick:o,size:"small",color:"error",children:"Clear All"})]})}),(0,u.jsx)(le.A,{dividers:!0,children:(0,u.jsx)("div",{className:"row",children:a.filter(e=>1===e.isVisible&&!e.isCustomCell).map((e,l)=>(0,u.jsx)("div",{className:"col-md-6 p-2",children:(0,u.jsxs)(s.A,{variant:"outlined",className:"p-3",children:[(0,u.jsx)("h6",{className:"mb-2 fw-bold text-secondary",style:{fontSize:"0.9rem"},children:e.ColumnHeader||e.Field_Name}),(0,u.jsx)(ue,{column:e,showData:r,filters:n,onChange:i})]})},(0,d.RZ)()))})}),(0,u.jsx)(ae.A,{children:(0,u.jsx)(re.A,{onClick:t,variant:"contained",children:"Close"})})]})};var pe=t(37762),he=(t(20557),t(11238));const ge=(e,l)=>e.map(e=>{const t={};return l.forEach((l,a)=>{if(l.isVisible||l.Defult_Display)if(l.isCustomCell&&l.Cell){const r=l.Cell({row:e}),s=l.ColumnHeader?String(l.ColumnHeader).replace(/\s+/g,"_").toLowerCase():"field_".concat(a+1);"string"!==typeof r&&"number"!==typeof r&&"bigint"!==typeof r||(t[s]=r)}else{let a=l.Field_Name;t[a]=e[a]||""}}),t}),xe=e=>{let{dataArray:l=[],columns:t=[],title:n="",stateName:o,stateUrl:c,stateGroup:m,PDFPrintOption:p,ExcelPrintOption:T,MenuButtons:L=[],onClickFun:W,isExpendable:U=!1,expandableComp:Q,tableMaxHeight:q=550,initialPageCount:Z=20,EnableSerialNumber:Y=!1,CellSize:$="small",disablePagination:K=!1,maxHeightOption:ee=!1,ButtonArea:le,bodyFontSizePx:te=13,headerFontSizePx:ae=14,enableGlobalSearch:re=!1,loadingOn:ne,loadingOff:de}=e;const[ce,ue]=(0,r.useState)(!1),[xe,Ae]=(0,r.useState)(!1),[ve,be]=(0,r.useState)(!1),[fe,_e]=(0,r.useState)(!1),[je,ye]=(0,r.useState)(!1),[Ce,Ne]=(0,r.useState)([]),[Se,Fe]=(0,r.useState)({}),[De,we]=(0,r.useState)(0),[Ve,ze]=(0,r.useState)({}),[Me,Oe]=(0,r.useState)(Z),[ke,Te]=(0,r.useState)(!1),[Pe,He]=(0,r.useState)(""),Ge=(0,r.useDeferredValue)(Pe),Be=e=>{Oe(parseInt(e.target.value,10)),we(0),ze({})},Ie=(e,l)=>{switch(l){case"number":return e?(0,d.jG)(e):e;case"date":return e?(0,d.yc)(e):e;case"time":return e?(0,d.JG)(e):e;default:return e}},{dispColumns:Ee,setDispColumns:Le,toggleVisibility:Re,updateOrder:We,updateAggregation:Ue}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const[l,t]=(0,r.useState)(e);return{dispColumns:(0,r.useMemo)(()=>[...l].sort((e,l)=>{var t,a;return(null!==(t=e.OrderBy)&&void 0!==t?t:999)-(null!==(a=l.OrderBy)&&void 0!==a?a:999)}),[l]),rawColumns:l,setDispColumns:t,toggleVisibility:(e,l)=>{t(t=>t.map(t=>t.Field_Name===e?(0,a.A)((0,a.A)({},t),{},{isVisible:l?1:0}):t))},updateOrder:(e,l)=>{t(t=>t.map(t=>t.Field_Name===e?(0,a.A)((0,a.A)({},t),{},{OrderBy:Number(l)}):t))},updateAggregation:(e,l)=>{t(t=>t.map(t=>t.Field_Name===e?(0,a.A)((0,a.A)({},t),{},{Aggregation:l}):t))}}}(t),{filteredData:Xe,filters:Qe,setFilters:qe,updateFilter:Ze}=E(l,Ee,Ge),{enabled:Ye,availableViews:$e,savedVisibility:Je,savedGrouping:Ke,checkIfNameExists:el,saveState:ll}=(e=>{let{stateName:l,stateUrl:t,stateGroup:a,dispColumns:s,grouping:n,loadingOn:i,loadingOff:o}=e;const[c,u]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[g,x]=(0,r.useState)(1),[A,v]=(0,r.useState)([]),b=l&&t&&a;return(0,r.useEffect)(()=>{b&&(p([]),u([]),Promise.all([(0,h.z)({address:"reports/reportState/columnVisiblity?reportGroup=".concat(a)}).then(e=>(0,d.$r)(e.data)),(0,h.z)({address:"reports/reportState/columnGrouping?reportGroup=".concat(a)}).then(e=>(0,d.$r)(e.data))]).then(e=>{let[l,t]=e;u(l),p(t);const a=[],r=new Set;[...l,...t].forEach(e=>{e.reportName&&!r.has(e.reportName)&&(r.add(e.reportName),a.push({reportName:e.reportName,displayName:e.displayName||e.reportName}))}),v(a)}))},[b,a,g]),{enabled:b,savedVisibility:c,savedGrouping:m,availableViews:A,checkIfNameExists:e=>A.some(l=>l.reportName===e||l.displayName===e),saveState:e=>{let{name:l,displayName:t,reportUrl:a,reportGroup:r}=e;const d={visibleColumns:s.filter(e=>1==e.isVisible).map(e=>({ColumnName:e.Field_Name,ColumnOrder:e.OrderBy})),reportName:l,displayName:t,reportUrl:a,reportGroup:r},c={groupingColumns:n.filter(Boolean).map((e,l)=>({ColumnName:e,ColumnOrder:l+1})),reportName:l,reportUrl:a,reportGroup:r};return i&&i(),Promise.all([(0,h.z)({address:"reports/reportState/columnVisiblity",method:"POST",bodyData:d}),(0,h.z)({address:"reports/reportState/columnGrouping",method:"POST",bodyData:c})]).then(()=>{x(e=>e+1)}).finally(()=>{o&&o()})}}})({stateName:o,stateUrl:c,stateGroup:m,dispColumns:Ee,grouping:Ce,loadingOn:ne,loadingOff:de}),tl=Ce.filter(Boolean),al=tl.length?R(Xe,Ee,tl):Xe,rl=e=>{let{row:l,rowIndex:t}=e;const[a,s]=(0,r.useState)(!1);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(g.A,{hover:!0,onClick:()=>W&&W(l),style:{cursor:W?"pointer":"default"},children:[tl.length>0&&(0,u.jsx)(x.A,{}),U&&Q&&(0,u.jsx)(x.A,{className:"text-center",style:{width:50,fontSize:te},children:(0,u.jsx)(i.A,{size:"small",onClick:e=>{e.stopPropagation(),s(!a)},children:a?(0,u.jsx)(D.A,{}):(0,u.jsx)(w.A,{})})}),Y&&(0,u.jsx)(x.A,{className:"text-center",style:{width:60,fontSize:te},children:t+1+De*Me}),Ee.filter(e=>1===e.isVisible).map((e,t)=>{var a;return e.isCustomCell&&"function"===typeof e.Cell?(0,u.jsx)(x.A,{style:{fontSize:te},children:e.Cell({row:l})},t):(0,u.jsx)(x.A,{style:{fontSize:te},children:null!==(a=Ie(l[e.Field_Name],e.Fied_Data))&&void 0!==a?a:"-"},t)})]},t),U&&Q&&a&&(0,u.jsx)(g.A,{children:(0,u.jsx)(x.A,{colSpan:Ee.filter(e=>1===e.isVisible&&!tl.includes(e.Field_Name)).length+(Y?1:0)+(tl.length>0?1:0)+1,children:Q({row:l,index:t})})})]})},sl=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((e,t)=>{if(e.__isGroup){const r="".concat(l,"-").concat(e.__groupValue);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(g.A,{className:"bg-light",children:[(0,u.jsx)(x.A,{style:{fontSize:te},className:"",children:(0,u.jsx)(i.A,{size:"small",onClick:()=>(e=>Fe(l=>(0,a.A)((0,a.A)({},l),{},{[e]:!l[e]})))(r),children:Se[r]?(0,u.jsx)(D.A,{}):(0,u.jsx)(w.A,{})})}),U&&(0,u.jsx)(x.A,{}),Y&&(0,u.jsx)(x.A,{className:"text-center ",style:{width:60,fontSize:te},children:t+1+De*Me}),Ee.filter(e=>1===e.isVisible).map((l,t)=>{var a;return l.Field_Name===e.__groupField?(0,u.jsx)(x.A,{style:{fontSize:te},className:"",children:(0,u.jsx)("strong",{children:e.__groupValue})},t):l.isCustomCell?(0,u.jsx)(x.A,{style:{fontSize:te},className:""},t):(0,u.jsx)(x.A,{style:{fontSize:te},className:"",children:null!==(a=Ie(e.__aggregates[l.Field_Name],l.Fied_Data))&&void 0!==a?a:""},t)})]},r),Se[r]&&(0,u.jsxs)(u.Fragment,{children:[sl(e.__rows.slice((Ve[r]||0)*Me,(Ve[r]||0)*Me+Me),l+1),e.__rows.length>Me&&(0,u.jsx)(g.A,{children:(0,u.jsx)(x.A,{colSpan:Ee.filter(e=>1===e.isVisible).length+(tl.length>0?1:0)+(U?1:0)+(Y?1:0),style:{padding:0},children:(0,u.jsx)(A.A,{component:"div",count:e.__rows.length,rowsPerPage:Me,page:Ve[r]||0,onPageChange:(e,l)=>((e,l)=>{ze(t=>(0,a.A)((0,a.A)({},t),{},{[e]:l}))})(r,l),onRowsPerPageChange:Be,rowsPerPageOptions:[Me],labelRowsPerPage:""})})})]})]})}return(0,u.jsx)(rl,{row:e,rowIndex:t},t)})},nl={maxHeight:ke&&ee?"none":q,overflowY:ke&&ee?"visible":"auto"};return(0,u.jsxs)(s.A,{children:[(0,u.jsxs)("div",{className:"d-flex p-2 align-items-center flex-wrap",children:[(0,u.jsx)("h6",{className:"flex-grow-1 mb-0",children:n}),(0,u.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[re&&(0,u.jsx)(v.A,{size:"small",placeholder:"Search...",variant:"outlined",value:Pe,onChange:e=>He(e.target.value),InputProps:{startAdornment:(0,u.jsx)(b.A,{position:"start",children:(0,u.jsx)(V.A,{})})},style:{minWidth:200}}),Ye&&$e.length>0&&(0,u.jsxs)(f.A,{size:"small",style:{minWidth:150},children:[(0,u.jsx)(_.A,{children:"Saved View"}),(0,u.jsxs)(j.A,{label:"Saved View",onChange:e=>(e=>{if(!e)return Le(t.map((e,l)=>{var t,r;return(0,a.A)((0,a.A)({},e),{},{isVisible:null!==(t=e.isVisible)&&void 0!==t?t:1,OrderBy:null!==(r=e.OrderBy)&&void 0!==r?r:l+1,Aggregation:e.Aggregation||(["number","currency"].includes(e.Fied_Data)?"sum":["date","time"].includes(e.Fied_Data)?"max":"count")})})),void Ne([]);const l=Je.filter(l=>l.reportName===e);l.length>0&&Le(e=>e.map(e=>{const t=l.find(l=>l.columnName===e.Field_Name);return t?(0,a.A)((0,a.A)({},e),{},{isVisible:1,OrderBy:t.orderNum}):(0,a.A)((0,a.A)({},e),{},{isVisible:0})}));const r=Ke.filter(l=>l.reportName===e),s=[];r.sort((e,l)=>(e.orderNum||0)-(l.orderNum||0)),r.forEach((e,l)=>{l<3&&(s[l]=e.columnName)}),Ne(s)})(e.target.value),defaultValue:"",children:[(0,u.jsx)(y.A,{value:"",children:"Select View (Default)"}),$e.map((e,l)=>(0,u.jsx)(y.A,{value:e.reportName,children:e.reportName},l))]})]}),le&&le,(0,u.jsx)(J,{options:[ee&&{label:ke?"Min Height":"Max Height",onClick:()=>Te(!ke),icon:ke?(0,u.jsx)(z.A,{color:"primary"}):(0,u.jsx)(M.A,{})},{label:"Filters",onClick:()=>ye(!0),icon:(0,u.jsx)(O.A,{})},{label:"Columns",onClick:()=>Ae(!0),icon:(0,u.jsx)(k.A,{})},{label:"Group By",onClick:()=>ue(!0),icon:(0,u.jsx)(P,{})},Ye&&{label:"Save View",onClick:()=>_e(!0),icon:(0,u.jsx)(H.A,{})},p&&{label:"Print PDF",onClick:()=>"function"===typeof p?p():((e,l)=>{try{const t=new pe.default,r=ge(e,l),s=l.filter(e=>e.isVisible||e.Defult_Display).map(e=>e.Field_Name||String(e.ColumnHeader).replace(/\s+/g,"_").toLowerCase()),n=r.map(e=>s.map(l=>e[l])).map((e,l)=>(0,a.A)((0,a.A)({},e),{},{Sno:l+1}));t.autoTable({head:[s],body:n}),t.save("table.pdf")}catch(t){console.error(t)}})(Xe,Ee),icon:(0,u.jsx)(G.A,{})},T&&{label:"Export Excel",onClick:()=>"function"===typeof T?T():((e,l)=>{try{const t=ge(e,l),a=he.Wp.json_to_sheet(t),r=he.Wp.book_new();he.Wp.book_append_sheet(r,a,"Data"),he._h(r,"table.xlsx")}catch(t){console.error(t)}})(Xe,Ee),icon:(0,u.jsx)(B,{})},{label:"Aggregations",onClick:()=>be(!0),icon:(0,u.jsx)(I,{})},...L.map(e=>({label:e.name,onClick:e.onclick||e.onClick,disabled:e.disabled,icon:e.icon}))].filter(Boolean)})]})]}),(0,u.jsx)(C.A,{style:nl,children:(0,u.jsxs)(N.A,{size:$,stickyHeader:!0,children:[(0,u.jsx)(S.A,{children:(0,u.jsxs)(g.A,{children:[tl.length>0&&(0,u.jsx)(x.A,{style:{width:50,fontSize:ae,backgroundColor:"#EDF0F7"},className:"fw-bold text-center",padding:"checkbox"}),U&&(0,u.jsx)(x.A,{style:{width:50,fontSize:ae,backgroundColor:"#EDF0F7"},className:"fw-bold text-center",children:"#"}),Y&&(0,u.jsx)(x.A,{style:{width:60,fontSize:ae,backgroundColor:"#EDF0F7"},className:"fw-bold text-center ",children:"SNo"}),Ee.filter(e=>1===e.isVisible).map(e=>(0,u.jsx)(x.A,{style:{fontSize:ae,backgroundColor:"#EDF0F7"},className:"fw-bold",children:e.ColumnHeader||e.Field_Name},(0,d.RZ)()))]})}),(0,u.jsx)(F.A,{children:Array.isArray(al)?sl(al.slice(De*Me,De*Me+Me)):null})]})}),!K&&(0,u.jsx)(A.A,{rowsPerPageOptions:Array.from(new Set([Z,5,10,25,50,100,200,500,1e3,2e3])).sort((e,l)=>e-l),component:"div",count:al.length,rowsPerPage:Me,page:De,onPageChange:(e,l)=>{we(l)},onRowsPerPageChange:Be,showFirstButton:!0,showLastButton:!0}),(0,u.jsx)(X,{open:ce,onClose:()=>ue(!1),columns:Ee,grouping:Ce,onChange:(e,l,t)=>{if(t)Ne(t);else{const t=[...Ce];t[e]=l,Ne(t)}},onApply:()=>ue(!1)}),(0,u.jsx)(se,{open:xe,onClose:()=>Ae(!1),columns:t,dispColumns:Ee,onToggle:Re,onOrderChange:We}),(0,u.jsx)(ie,{open:ve,onClose:()=>be(!1),columns:Ee,onUpdateAggregation:Ue}),(0,u.jsx)(me,{open:je,onClose:()=>ye(!1),columns:Ee,showData:l,filters:Qe,onChange:Ze,onClear:()=>qe({})}),(0,u.jsx)(oe,{open:fe,onClose:()=>_e(!1),onSave:async e=>{try{await ll(e),_e(!1)}catch(l){console.error("Failed to save state",l),alert("Failed to save state: "+l.message)}},defaults:{reportUrl:c,reportGroup:m}})]})};var Ae=t(592);const ve=e=>{let{row:l,Fromdate:t,Todate:s}=e;const[n,i]=(0,r.useState)([]),[o,d]=(0,r.useState)([]),[c,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{m(!0),(0,h.z)({address:"reports/salesReport/ledger/itemDetails?Fromdate=".concat(t,"&Todate=").concat(s,"&Ledger_Id=").concat(null===l||void 0===l?void 0:l.Ledger_Tally_Id)}).then(e=>{let{success:l,data:t,others:r}=e;if(l){const{dataTypeInfo:e}=r;i(t),d(l=>(0,a.A)((0,a.A)({},l),{},{salesInfo:Array.isArray(e)?e:[]}))}else i([])}).catch(e=>console.error(e)).finally(()=>{m(!1)})},[null===l||void 0===l?void 0:l.Ledger_Tally_Id,t,s]),c?(0,u.jsx)("h5",{className:"text-center text-primary ",children:"Loading..."}):(0,u.jsx)(Ae.A,{dataArray:n,columns:o.salesInfo})},be=e=>{let{dataArray:l,colTypes:t,Fromdate:a,Todate:s,loadingOn:n,loadingOff:i}=e;const o=(0,r.useMemo)(()=>t.map((e,l)=>{var t;return{Field_Name:null===e||void 0===e?void 0:e.Column_Name,ColumnHeader:null===e||void 0===e||null===(t=e.Column_Name)||void 0===t?void 0:t.replace(/_/g," "),Fied_Data:null===e||void 0===e?void 0:e.Data_Type,isVisible:l<10?1:0,OrderBy:l+1}}),[t]);return(0,u.jsx)("div",{className:"p-2",children:(0,u.jsx)(xe,{title:"Ledger Based Sales Report",dataArray:l,columns:o,ExcelPrintOption:!0,PDFPrintOption:!0,maxHeightOption:!0,EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,enableGlobalSearch:!0,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,u.jsx)(ve,{row:l,Fromdate:a,Todate:s})},loadingOn:n,loadingOff:i,stateName:"ledger_based_sales_report",stateUrl:"/reports/salesReport/ledger",stateGroup:"sales_reports"})})},fe=e=>{let{dataArray:l,colTypes:t,loadingOn:a,loadingOff:s}=e;const n=(0,r.useMemo)(()=>t.map((e,l)=>{var t;return{Field_Name:null===e||void 0===e?void 0:e.Column_Name,ColumnHeader:null===e||void 0===e||null===(t=e.Column_Name)||void 0===t?void 0:t.replace(/_/g," "),Fied_Data:null===e||void 0===e?void 0:e.Data_Type,isVisible:l<10?1:0,OrderBy:l+1}}),[t]);return(0,u.jsx)("div",{className:"p-2",children:(0,u.jsx)(xe,{title:"Item Based Sales Report",dataArray:l,columns:n,ExcelPrintOption:!0,PDFPrintOption:!0,maxHeightOption:!0,EnableSerialNumber:!0,headerFontSizePx:12,bodyFontSizePx:12,enableGlobalSearch:!0,loadingOn:a,loadingOff:s,stateName:"item_based_sales_report",stateUrl:"/reports/salesReport/",stateGroup:"sales_reports_item_based"})})},_e=e=>{let{loadingOn:l,loadingOff:t}=e;const c=JSON.parse(localStorage.getItem("user")),[g,x]=(0,r.useState)(null),[A,v]=(0,r.useState)({salesInfo:[],salesItemInfo:[]}),[b,f]=(0,r.useState)(null),[_,j]=(0,r.useState)({Fromdate:(0,d.IS)(1),Todate:(0,d.ny)(),ReportType:"LedgerBased",filterDialog:!1,reload:!0});(0,r.useEffect)(()=>{x(null),f(null),v({salesInfo:[],salesItemInfo:[]}),(0,h.z)({address:"reports/salesReport/ledger?Fromdate=".concat(null===_||void 0===_?void 0:_.Fromdate,"&Todate=").concat(null===_||void 0===_?void 0:_.Todate),headers:{Db:null===c||void 0===c?void 0:c.Company_id}}).then(e=>{let{success:l,data:t,others:r}=e;if(l){const{dataTypeInfo:e}=r;x(t),v(l=>(0,a.A)((0,a.A)({},l),{},{salesInfo:Array.isArray(e)?e:[]}))}else x([])}).catch(console.error),(0,h.z)({address:"reports/salesReport/products?Fromdate=".concat(null===_||void 0===_?void 0:_.Fromdate,"&Todate=").concat(null===_||void 0===_?void 0:_.Todate),headers:{Db:null===c||void 0===c?void 0:c.Company_id}}).then(e=>{let{success:l,data:t,others:r}=e;if(l){const{LOSAbstract:e}=r;v(l=>(0,a.A)((0,a.A)({},l),{},{salesItemInfo:(0,d.$r)(e)})),f(t)}else f([])}).catch(e=>console.error(e))},[_.reload]);const y=(0,d.kY)(new Date(_.Fromdate),new Date(_.Todate));return(0,u.jsx)(r.Fragment,{children:(0,u.jsxs)(s.A,{className:"mt-3",children:[(0,u.jsxs)("div",{className:"px-3 py-2 d-flex justify-content-between align-items-center fw-bold text-dark",style:{backgroundColor:"#eae0cc"},children:[(0,u.jsx)("span",{children:(0,u.jsxs)("form",{onSubmit:e=>{e.preventDefault(),j(e=>(0,a.A)((0,a.A)({},e),{},{reload:!e.reload}))},children:[(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5 me-1",value:_.Fromdate,onChange:e=>j(l=>(0,a.A)((0,a.A)({},l),{},{Fromdate:e.target.value}))}),(0,u.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5",value:_.Todate,onChange:e=>j(l=>(0,a.A)((0,a.A)({},l),{},{Todate:e.target.value}))}),(0,u.jsx)(n.A,{title:"Reload Data",children:(0,u.jsx)(i.A,{size:"small",className:"ms-2",type:"submit",children:(0,u.jsx)(p.A,{})})})]})}),(0,u.jsx)("span",{children:(0,u.jsxs)("select",{value:_.ReportType,className:"cus-inpt ps-3 w-100 rounded-5 border-0",onChange:e=>j(l=>(0,a.A)((0,a.A)({},l),{},{ReportType:e.target.value})),children:[(0,u.jsx)("option",{value:"LedgerBased",children:"Ledger Based"}),(0,u.jsx)("option",{value:"ProductBased",children:"Product Based"})]})})]}),(0,u.jsxs)(o.A,{className:"p-0",children:[null===g&&"LedgerBased"===_.ReportType&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Ledger Based data..."}),null===b&&("ProductBased"===_.ReportType||"ProductDayAverage"===_.ReportType)&&(0,u.jsx)("h6",{className:"blue-text text-center",children:"Fetching Product Based data..."}),"LedgerBased"===_.ReportType&&Array.isArray(g)&&(0,u.jsx)(be,{dataArray:g,colTypes:A.salesInfo,Fromdate:null===_||void 0===_?void 0:_.Fromdate,Todate:null===_||void 0===_?void 0:_.Todate,loadingOn:l,loadingOff:t}),"ProductBased"===_.ReportType&&Array.isArray(b)&&(0,u.jsx)(fe,{dataArray:b,colTypes:A.salesItemInfo,loadingOn:l,loadingOff:t}),"ProductDayAverage"===_.ReportType&&Array.isArray(b)&&(0,u.jsx)(m,{filterDialog:_.filterDialog,closeDialog:()=>{j(e=>(0,a.A)((0,a.A)({},e),{},{filterDialog:!1}))},dataArray:b,days:y})]})]})})}},10489:(e,l,t)=>{t.d(l,{A:()=>d});t(65043);var a=t(83462),r=t(26600),s=t(35316),n=t(29347),i=t(11906),o=t(70579);const d=e=>{let{open:l=!1,onClose:t,children:d,title:c,onSubmit:u,submitText:m="Submit",closeText:p="Close",maxWidth:h="sm",fullWidth:g=!0,isSubmit:x=!1}=e;return(0,o.jsxs)(a.A,{open:l,onClose:t,fullWidth:g,maxWidth:h,children:[c&&(0,o.jsx)(r.A,{children:c}),(0,o.jsx)(s.A,{children:d}),(0,o.jsxs)(n.A,{children:[(0,o.jsx)(i.A,{onClick:t,children:p}),u&&(0,o.jsx)(i.A,{variant:"contained",onClick:u,type:x?"submit":"button",children:m})]})]})}},37141:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),r=t(70579);const s=(0,a.A)((0,r.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},38504:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),r=t(70579);const s=(0,a.A)((0,r.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf")},79484:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),r=t(70579);const s=(0,a.A)((0,r.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=397.56c05c26.chunk.js.map