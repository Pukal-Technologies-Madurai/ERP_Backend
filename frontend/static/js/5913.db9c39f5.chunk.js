"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5913],{3632:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},13899:(e,l,a)=>{a.d(l,{A:()=>b});var d=a(89379),s=a(65043),t=a(83462),r=a(26600),o=a(35316),n=a(29347),i=a(11906),c=a(33438),u=a(47968),v=a(97707),h=a(93141),x=a(65074),m=a(70579);const j=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:return(0,v.e3)(e*(l/100));case 1:return(0,v.e3)(e-e*(100/(100+l)));default:return 0}},b=e=>{let{orderDetails:l,orderProducts:a,download:b,actionOpen:p,clearDetails:N,children:_,TitleText:g}=e;const f=JSON.parse(localStorage.getItem("user")),[S,T]=(0,s.useState)(!1),[A,y]=(0,s.useState)({}),[I,C]=(0,s.useState)({}),G=(0,s.useRef)(null),R=(0,v.id)(l.GST_Inclusive,0),P=(0,v.id)(l.GST_Inclusive,1),O=(0,v.id)(l.GST_Inclusive,2),w=(0,v.id)(l.IS_IGST,1);(0,s.useEffect)(()=>{(0,x.z)({address:"masters/company?Company_id=".concat(null===f||void 0===f?void 0:f.Company_id)}).then(e=>{e.success&&C(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===f||void 0===f?void 0:f.Company_id]),(0,s.useEffect)(()=>{p&&T(!0)},[p]),(0,s.useEffect)(()=>{null!==l&&void 0!==l&&l.Retailer_Id&&(0,x.z)({address:"masters/retailers/info?Retailer_Id=".concat(null===l||void 0===l?void 0:l.Retailer_Id)}).then(e=>{e.success&&y(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===l||void 0===l?void 0:l.Retailer_Id]);const L=()=>{T(!1),N&&N()},B=a.filter(e=>(0,v.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),V=a.reduce((e,l)=>{const a=(0,v.e3)(null===l||void 0===l?void 0:l.Item_Rate),d=parseInt(null===l||void 0===l?void 0:l.Bill_Qty)||0;if(O)return e.TotalValue+=(0,v.JH)(d,a),e;const s=w?null===l||void 0===l?void 0:l.Igst:(0,v.Lr)(null===l||void 0===l?void 0:l.Sgst,null===l||void 0===l?void 0:l.Cgst);if(P){const l=j(1,a,s),t=(0,v.DG)(a,l);e.TotalTax+=(0,v.JH)(d,l),e.TotalValue+=(0,v.JH)(d,t)}if(R){const l=j(0,a,s);e.TotalTax+=(0,v.JH)(d,l),e.TotalValue+=(0,v.JH)(d,a)}return e},{TotalValue:0,TotalTax:0}),D=(0,h.useReactToPrint)({content:()=>G.current}),F=[{labelOne:"Invoice No",dataOne:null===l||void 0===l?void 0:l.So_Id,labelTwo:"Dated",dataTwo:(0,v.yc)(null===l||void 0===l?void 0:l.So_Date)},{labelOne:"Delivery Note",dataOne:"",labelTwo:"Mode/Terms of Payment",dataTwo:""},{labelOne:"Reference No. & Date",dataOne:"",labelTwo:"Other References",dataTwo:""},{labelOne:"Buyer's Order No",dataOne:"",labelTwo:"Dated",dataTwo:""},{labelOne:"Dispatch Doc No",dataOne:"",labelTwo:"Delivery Note Date",dataTwo:""},{labelOne:"Dispatched through",dataOne:"",labelTwo:"Destination",dataTwo:""},{labelOne:"Bill of Lading/LR-RR No",dataOne:"",labelTwo:"Motor Vehicle No",dataTwo:""}],Q=null===a||void 0===a?void 0:a.reduce((e,a)=>{const s=e.findIndex(e=>e.hsnCode==a.HSN_Code),{Taxable_Amount:t,Cgst_Amo:r,Sgst_Amo:o,Igst_Amo:n,HSN_Code:i,Cgst:c,Sgst:u,Igst:h}=a;if(-1!==s){const a=e[s],i=(0,d.A)((0,d.A)({},a),{},{taxableValue:a.taxableValue+t,cgst:(0,v.Lr)(a.cgst,r),sgst:(0,v.Lr)(a.sgst,o),igst:(0,v.Lr)(a.igst,n),totalTax:a.totalTax+Number(l.IS_IGST?n:(0,v.Lr)(r,o))});return e[s]=i,e}const x={hsnCode:i,taxableValue:t,cgst:r,cgstPercentage:c,sgst:o,sgstPercentage:u,igst:n,igstPercentage:h,totalTax:l.IS_IGST?Number(n):(0,v.Lr)(r,o)};return[...e,x]},[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{onClick:()=>{T(!0)},children:_}),(0,m.jsxs)(t.A,{open:S,onClose:L,fullWidth:!0,maxWidth:"lg",children:[(0,m.jsx)(r.A,{children:"Order Preview"}),(0,m.jsxs)(o.A,{ref:G,children:[(0,m.jsx)("h3",{className:"text-center mb-2",children:null!==g&&void 0!==g?g:"Invoice Details"}),(0,m.jsxs)("div",{className:"row",children:[(0,m.jsxs)("div",{className:"col-6 p-0 border border-bottom-0 border-end-0",children:[" ",(0,m.jsxs)("div",{className:"border-bottom p-2",children:[(0,m.jsx)("p",{className:"m-0 fa-17",children:null===I||void 0===I?void 0:I.Company_Name}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["Address: ",null===I||void 0===I?void 0:I.Company_Address]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["City: ",null===I||void 0===I?void 0:I.Region," - ",null===I||void 0===I?void 0:I.Pincode]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===I||void 0===I?void 0:I.Gst_Number]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["State: ",null===I||void 0===I?void 0:I.State]}),(0,m.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]}),(0,m.jsxs)("div",{className:"p-2",children:[" ",(0,m.jsx)("p",{className:"m-0 fa-12",children:"Buyer (Bill to)"}),(0,m.jsx)("p",{className:"m-0 fa-15",children:null===A||void 0===A?void 0:A.Retailer_Name}),(0,m.jsx)("p",{className:"m-0 fa-14",children:(null===A||void 0===A?void 0:A.Mobile_No)+" - "+(null===A||void 0===A?void 0:A.Reatailer_Address)}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:[null===A||void 0===A?void 0:A.Reatailer_City," - ",null===A||void 0===A?void 0:A.PinCode]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===I||void 0===I?void 0:I.Gstno]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["State Name: ",null===I||void 0===I?void 0:I.StateGet]}),(0,m.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]})]}),(0,m.jsx)("div",{className:"col-6 p-0 border border-bottom-0",children:(0,m.jsx)("table",{className:"table m-0",children:(0,m.jsxs)("tbody",{children:[F.map((e,l)=>(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{className:"border-end fa-12 p-0 px-1",children:[(0,m.jsx)("p",{className:"m-0",children:e.labelOne}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003",e.dataOne]})]}),(0,m.jsxs)("td",{className:"fa-12 p-0 px-1",children:[(0,m.jsx)("p",{className:"m-0",children:e.labelTwo}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003",e.dataTwo]})]})]},l)),(0,m.jsx)("tr",{children:(0,m.jsxs)("td",{colSpan:2,className:"border-0 fa-12 p-0",children:[(0,m.jsx)("p",{className:"m-0",children:"Terms of Delivery"}),(0,m.jsx)("p",{className:"m-0"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{})]})})]})})})]}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12 p-0",children:(0,m.jsxs)("table",{className:"table m-0",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border bg-light fa-14",children:"Sno"}),(0,m.jsx)("td",{className:"border bg-light fa-14",children:"Product"}),(0,m.jsx)("td",{className:"border bg-light fa-14",children:"HSN/SAC"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Quantity"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Rate"}),(0,m.jsxs)("td",{className:"border bg-light fa-14 text-end",children:[(0,m.jsx)("p",{className:"m-2 ",children:"Rate"}),(0,m.jsxs)("p",{className:"m-0 ",children:[(0,v.id)(l.GST_Inclusive,1)&&"(Incl. of Tax)",(0,v.id)(l.GST_Inclusive,2)&&"(Tax not applicable)",(0,v.id)(l.GST_Inclusive,0)&&"(Excl. of Tax)"]})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Amount"})]})}),(0,m.jsxs)("tbody",{children:[B.map((e,a)=>{var d;const s=null!==(d=w?null===e||void 0===e?void 0:e.Igst_P:(null===e||void 0===e?void 0:e.Cgst)+(null===e||void 0===e?void 0:e.Sgst))&&void 0!==d?d:0,t=Number((null===e||void 0===e?void 0:e.Bill_Qty)||0),r=Number((null===e||void 0===e?void 0:e.Item_Rate)||0),o=j(l.GST_Inclusive,r,s);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13",children:a+1}),(0,m.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.Product_Name}),(0,m.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.HSN_Code}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[(0,v.jG)(t),(null===e||void 0===e?void 0:e.UOM)&&" ("+(null===e||void 0===e?void 0:e.UOM)+") "]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)((0,v.id)(l.GST_Inclusive,1)?r-o:r)]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)((0,v.id)(l.GST_Inclusive,1)?r:r+o)]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,v.jG)(null===e||void 0===e?void 0:e.Taxable_Amount)]})]},a)}),(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{className:"border p-2",rowSpan:w?4:5,colSpan:4,children:[(0,m.jsx)("p",{className:"m-0",children:"Amount Chargeable (in words):"}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003 INR ",(0,v.GF)(parseInt(null===l||void 0===l?void 0:l.Total_Invoice_value))," Only."]})]}),(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total Taxable Amount"}),(0,m.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,v.jG)(V.TotalValue)})]}),w?(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"IGST"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(l.IGST_Total)})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"CGST"}),(0,m.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,v.jG)(null===l||void 0===l?void 0:l.CSGT_Total)})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"SGST"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(null===l||void 0===l?void 0:l.SGST_Total)})]})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Round Off"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,v.jG)(null===l||void 0===l?void 0:l.Round_off)})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end fw-bold",children:(0,v.jG)(null===l||void 0===l?void 0:l.Total_Invoice_value)})]})]})]})})}),(0,m.jsxs)("table",{className:"table",children:[(0,m.jsxs)("thead",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"HSN / SAC"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"Taxable Value"}),(0,v.id)(l.IS_IGST,1)?(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"IGST Tax"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"Central Tax"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"State Tax"})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Total"})]}),(0,m.jsxs)("tr",{children:[(0,v.id)(l.IS_IGST,1)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Tax Amount"})]})]}),(0,m.jsxs)("tbody",{children:[Q.map((e,a)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:null===e||void 0===e?void 0:e.hsnCode}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.taxableValue)}),l.IS_IGST?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.igstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.igst)})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.cgstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.cgst)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.sgstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.sgst)})]}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,v.jG)(null===e||void 0===e?void 0:e.totalTax)})]},a)),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:"Total"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.taxableValue),0))}),l.IS_IGST?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.igst),0))})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.cgst),0))}),(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.sgst),0))})]}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,v.jG)(Q.reduce((e,l)=>e+Number(l.totalTax),0))})]}),(0,m.jsx)("tr",{children:(0,m.jsxs)("td",{colSpan:(0,v.id)(l.IS_IGST,1)?5:7,className:"border fa-13 fw-bold",children:["Tax Amount (in words) : INR \xa0",(0,v.GF)(parseInt(Q.reduce((e,l)=>e+Number(l.totalTax),0)))," only."]})})]})]}),(0,m.jsx)("div",{className:"col-12 text-center",children:(0,m.jsx)("p",{children:"This is a Computer Generated Invoice"})})]}),(0,m.jsxs)(n.A,{children:[(0,m.jsx)(i.A,{startIcon:(0,m.jsx)(c.A,{}),variant:"outlined",color:"error",onClick:L,children:"Close"}),b&&(0,m.jsx)(i.A,{startIcon:(0,m.jsx)(u.A,{}),variant:"outlined",onClick:D,children:"Download"})]})]})]})}},59383:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},65913:(e,l,a)=>{a.r(l),a.d(l,{default:()=>C});var d=a(89379),s=a(65043),t=a(17392),r=a(77739),o=a(11906),n=a(83462),i=a(26600),c=a(35316),u=a(29347),v=a(20656),h=a(63406),x=a(97707),m=a(13899),j=a(70141),b=a(83560),p=a(59383),N=a(79484),_=a(3632),g=a(10204),f=a(65074),S=a(48471),T=a(73216),A=a(42841),y=a(43735),I=a(70579);const C=e=>{let{loadingOn:l,loadingOff:a,AddRights:C,EditRights:G,pageID:R}=e;const P=sessionStorage.getItem("filterValues"),O={Fromdate:(0,x.ny)(),Todate:(0,x.ny)(),Retailer:{value:"",label:"ALL"},CreatedBy:{value:"",label:"ALL"},SalesPerson:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:0,OrderStatus:{value:"",label:"ALL"}},w=JSON.parse(localStorage.getItem("user")),L=(0,T.Zp)(),[B,V]=(0,s.useState)([]),[D,F]=(0,s.useState)([]),[Q,E]=(0,s.useState)([]),[k,M]=(0,s.useState)([]),[H,z]=(0,s.useState)([]),[U,J]=(0,s.useState)({}),[W,Z]=(0,s.useState)(!1),[q,K]=(0,s.useState)(null),[X,Y]=(0,s.useState)(!1),[$,ee]=(0,s.useState)(O),[le,ae]=(0,s.useState)({filters:!1,orderDetails:!1});(0,s.useEffect)(()=>{const e=(0,x.vU)(R),{Fromdate:l,Todate:a,Retailer:s=O.Retailer,CreatedBy:t=O.CreatedBy,SalesPerson:r=O.SalesPerson,VoucherType:o=O.VoucherType,Cancel_status:n=O.Cancel_status,OrderStatus:i=O.OrderStatus}=e;ee(e=>(0,d.A)((0,d.A)({},e),{},{Fromdate:l,Todate:a,Retailer:s,CreatedBy:t,SalesPerson:r,VoucherType:o,Cancel_status:n,OrderStatus:i}))},[P,R]);const de=e=>{const l=Array.isArray(e.ProductList)?e.ProductList.filter(e=>Number(null===e||void 0===e?void 0:e.Bill_Qty)>0).map(l=>{(e=>{const l=null===e||void 0===e?void 0:e.match(/(\d+)\s?kg/i);l&&parseInt(l[1])})(null===l||void 0===l?void 0:l.Product_Name);return(0,d.A)((0,d.A)({},l),{},{Pre_Id:null===e||void 0===e?void 0:e.Pre_Id,Bill_Qty:(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0)*(Number(null===l||void 0===l?void 0:l.PackValue)||1),Act_Qty:Number(null===l||void 0===l?void 0:l.Total_Qty)||0,Total_Qty:Number(null===l||void 0===l?void 0:l.Bill_Qty)||0})}):[];return(0,d.A)((0,d.A)({},e),{},{Product_Array:l,Retailer_Id:Number(null===e||void 0===e?void 0:e.Retailer_Id)||0,Retailer_Name:(null===e||void 0===e?void 0:e.Retailer_Name)||"",Staffs_Array:(e=>{const l=[];return e.Broker_Id&&0!==e.Broker_Id&&l.push({Id:"",So_Id:"",Emp_Id:e.Broker_Id,Emp_Type_Id:e.Broker_Type||0}),e.Transporter_Id&&0!==e.Transporter_Id&&l.push({Id:"",Do_Id:"",Emp_Id:e.Transporter_Id,Emp_Type_Id:e.TrasnportType||0}),l.filter(e=>0!==e.Emp_Type_Id)})(e)})},se=e=>{var l;const a=de(e),s=((null===e||void 0===e?void 0:e.ProductList)||(null===e||void 0===e?void 0:e.Products_List)||[]).map(l=>{const a=Number(l.Bill_Qty)||0,s=Number(null===l||void 0===l?void 0:l.Total_Qty)||0,t=((null===e||void 0===e?void 0:e.ConvertedInvoice)||[]).flatMap(e=>(null===e||void 0===e?void 0:e.InvoicedProducts)||[]).filter(e=>e.Item_Id===l.Item_Id).reduce((e,l)=>e+(Number(null===l||void 0===l?void 0:l.Bill_Qty)||0),0),r=Math.max(a-t,0);return(0,d.A)((0,d.A)({},l),{},{Ordered_Qty:a,Delivered_Qty:t,Act_Qty:s,Bill_Qty:r,Amount:r*(Number(l.Item_Rate)||0)})}),t=(0,d.A)((0,d.A)({},e),{},{ProductList:s,Staffs_Array:(null===e||void 0===e||null===(l=e.Staff_Involved_List)||void 0===l?void 0:l.map(e=>({Staff_Id:e.Involved_Emp_Id,Cost_Cat_Id:e.Cost_Center_Type_Id,Cost_Cat_Name:e.Cost_Center_Type})))||[],Retailer_Id:Number(null===e||void 0===e?void 0:e.Retailer_Id)||0,Retailer_Name:(null===e||void 0===e?void 0:e.Retailer_Name)||""});K({row:t,payload:a}),Y(!0)};(0,s.useEffect)(()=>{(0,f.z)({address:"sales/saleOrder/retailers"}).then(e=>{e.success&&F(e.data)}).catch(e=>console.error(e)),(0,f.z)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===w||void 0===w?void 0:w.Company_id)}).then(e=>{e.success&&E(e.data)}).catch(e=>console.error(e)),(0,f.z)({address:"masters/user/dropDown?Company_id=".concat(null===w||void 0===w?void 0:w.Company_id)}).then(e=>{e.success&&M(e.data)}).catch(e=>console.error(e)),(0,f.z)({address:"masters/voucher"}).then(e=>{e.success&&z(e.data)}).catch(e=>console.error(e))},[]),(0,s.useEffect)(()=>{var e;const d=(0,x.vU)(R),{Fromdate:s,Todate:t,Retailer:r=O.Retailer,CreatedBy:o=O.CreatedBy,SalesPerson:n=O.SalesPerson,VoucherType:i=O.VoucherType,Cancel_status:c=O.Cancel_status}=d;(0,f.z)({address:"sales/saleOrder?\n            Fromdate=".concat(s,"&\n            Todate=").concat(t,"&\n            Retailer_Id=").concat(null===r||void 0===r?void 0:r.value,"&\n            Sales_Person_Id=").concat(null===n||void 0===n?void 0:n.value,"&\n            Created_by=").concat(null===o||void 0===o?void 0:o.value,"&\n            VoucherType=").concat(null===i||void 0===i?void 0:i.value,"&\n            Cancel_status=").concat(c,"&\n            OrderStatus=").concat((null===$||void 0===$||null===(e=$.OrderStatus)||void 0===e?void 0:e.value)||""),loadingOn:l,loadingOff:a}).then(e=>{e.success&&V(null===e||void 0===e?void 0:e.data)}).catch(e=>console.error(e))},[P,R]);const te=e=>{var l,a;let{row:d,handleOpenModal:s}=e;const r=e=>{var l;let a=0;return(null===(l=d.ConvertedInvoice)||void 0===l?void 0:l.length)>0&&d.ConvertedInvoice.forEach(l=>{var d;(null===(d=l.InvoicedProducts)||void 0===d?void 0:d.length)>0&&l.InvoicedProducts.forEach(l=>{Number(l.Item_Id)===Number(e.Item_Id)&&(a+=Number(l.Bill_Qty||0))})}),a},o=null===(l=d.Products_List)||void 0===l?void 0:l.some(e=>{const l=r(e);return Number(e.Bill_Qty)-l>0});return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("table",{className:"table",children:(0,I.jsxs)("tbody",{children:[(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,I.jsx)("td",{className:"border p-2",children:d.Branch_Name}),(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,I.jsx)("td",{className:"border p-2",children:d.Sales_Person_Name}),(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,I.jsx)("td",{className:"border p-2",children:d.Round_off})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,I.jsxs)("td",{className:"border p-2",children:[(0,x.id)(d.GST_Inclusive,1)&&"Inclusive",(0,x.id)(d.GST_Inclusive,0)&&"Exclusive"]}),(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,I.jsxs)("td",{className:"border p-2",children:[(0,x.id)(d.IS_IGST,1)&&"IGST",(0,x.id)(d.IS_IGST,0)&&"GST"]}),(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,I.jsx)("td",{className:"border p-2",children:d.Sales_Person_Name})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,I.jsx)("td",{className:"border p-2",colSpan:5,children:d.Narration})]})]})}),(0,I.jsxs)("table",{className:"table table-bordered",children:[(0,I.jsx)("thead",{className:"bg-light",children:(0,I.jsxs)("tr",{children:[(0,I.jsx)("th",{className:"p-2",children:"Product"}),(0,I.jsx)("th",{className:"p-2",children:"Ordered Qty"}),(0,I.jsx)("th",{className:"p-2",children:"Delivered Qty"}),(0,I.jsxs)("th",{className:"p-2",children:["Pending Qty",o&&(0,I.jsx)(t.A,{size:"small",onClick:()=>s(d),children:(0,I.jsx)(A.A,{className:"text-blue-600"})})]})]})}),(0,I.jsx)("tbody",{children:null===(a=d.Products_List)||void 0===a?void 0:a.map((e,l)=>{const a=r(e),d=Number(e.Bill_Qty)-a;return(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{className:"p-2",children:e.Product_Name}),(0,I.jsx)("td",{className:"p-2",children:e.Bill_Qty}),(0,I.jsx)("td",{className:"p-2",children:a}),(0,I.jsx)("td",{className:"p-2 font-bold ".concat(0===d?"text-green-600":"text-red-600"),children:d})]},l)})})]})]})},re=()=>{ae((0,d.A)((0,d.A)({},le),{},{filters:!1,orderDetails:!1}))},oe=(0,s.useMemo)(()=>B.reduce((e,l)=>(0,x.Lr)(e,null===l||void 0===l?void 0:l.Total_Invoice_value),0),[B]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(S.Ay,{title:"Sale Orders",dataArray:B,EnableSerialNumber:!0,columns:[(0,S.Lj)("So_Date","date","Date"),(0,S.Lj)("So_Inv_No","string","ID"),(0,S.Lj)("Retailer_Name","string","Customer"),(0,S.Lj)("VoucherTypeGet","string","Voucher"),(0,S.Lj)("Total_Before_Tax","number","Before Tax"),(0,S.Lj)("Total_Tax","number","Tax"),(0,S.Lj)("Total_Invoice_value","number","Invoice Value"),{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,a;let{row:d}=e;const s=g.T.find(e=>e.id===Number(null===d||void 0===d?void 0:d.isConverted));return(0,I.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 "+(null!==(l=null===s||void 0===s?void 0:s.color)&&void 0!==l?l:"bg-secondary text-white"),children:null!==(a=null===s||void 0===s?void 0:s.label)&&void 0!==a?a:"Undefined"})}},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(r.A,{title:"View Order",children:(0,I.jsx)(t.A,{onClick:()=>{J({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},color:"primary",size:"small",children:(0,I.jsx)(_.A,{className:"fa-16"})})}),G&&(0,I.jsx)(r.A,{title:"Edit",children:(0,I.jsx)(t.A,{onClick:()=>L("create",{state:(0,d.A)((0,d.A)({},l),{},{isEdit:!0})}),size:"small",children:(0,I.jsx)(b.A,{className:"fa-16"})})})]})}}],ButtonArea:(0,I.jsxs)(I.Fragment,{children:[C&&(0,I.jsx)(o.A,{variant:"outlined",startIcon:(0,I.jsx)(j.A,{}),onClick:()=>L("create"),children:"New"}),(0,I.jsx)(r.A,{title:"Filters",children:(0,I.jsx)(t.A,{size:"small",onClick:()=>ae((0,d.A)((0,d.A)({},le),{},{filters:!0})),children:(0,I.jsx)(p.A,{})})}),(0,I.jsx)("span",{className:"bg-light text-light fa-11 px-1 shadow-sm py-1 rounded-3 mx-1",children:(0,x.Ro)(oe)>0&&(0,I.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",(0,x.jG)(oe)]})})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>(0,I.jsx)(te,(0,d.A)((0,d.A)({},e),{},{handleOpenModal:se}))}),Object.keys(U).length>0&&(0,I.jsx)(m.A,{orderDetails:null===U||void 0===U?void 0:U.orderDetails,orderProducts:null===U||void 0===U?void 0:U.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>J({}),TitleText:"Sale Order"}),(0,I.jsxs)(n.A,{open:le.filters,onClose:re,fullWidth:!0,maxWidth:"sm",children:[(0,I.jsx)(i.A,{children:"Filters"}),(0,I.jsx)(c.A,{children:(0,I.jsx)("div",{className:"table-responsive pb-4",children:(0,I.jsx)("table",{className:"table",children:(0,I.jsxs)("tbody",{children:[(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,I.jsx)("td",{children:(0,I.jsx)("input",{type:"date",value:$.Fromdate,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,I.jsx)("td",{children:(0,I.jsx)("input",{type:"date",value:$.Todate,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,I.jsx)("td",{children:(0,I.jsx)(v.Ay,{value:null===$||void 0===$?void 0:$.Retailer,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{Retailer:e})),options:[{value:"",label:"ALL"},...D.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:(null===e||void 0===e?void 0:e.Retailer_Name)+"- \u20b9"+(0,x.jG)((0,x.Ro)(null===e||void 0===e?void 0:e.TotalSales))+" (".concat((0,x.Ro)(null===e||void 0===e?void 0:e.OrderCount),")")}))],styles:h.MR,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Salse Person"}),(0,I.jsx)("td",{children:(0,I.jsx)(v.Ay,{value:null===$||void 0===$?void 0:$.SalesPerson,onChange:e=>ee(l=>(0,d.A)((0,d.A)({},l),{},{SalesPerson:e})),options:[{value:"",label:"ALL"},...Q.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:h.MR,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,I.jsx)("td",{children:(0,I.jsx)(v.Ay,{value:null===$||void 0===$?void 0:$.CreatedBy,onChange:e=>ee(l=>(0,d.A)((0,d.A)({},l),{},{CreatedBy:e})),options:[{value:"",label:"ALL"},...k.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:h.MR,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,I.jsx)("td",{children:(0,I.jsx)(v.Ay,{value:null===$||void 0===$?void 0:$.VoucherType,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{VoucherType:e})),options:[{value:"",label:"ALL"},...H.filter(e=>"SALES"===e.Type).map(e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name"})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,I.jsx)("td",{children:(0,I.jsxs)("select",{value:$.Cancel_status,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{Cancel_status:Number(e.target.value)})),className:"cus-inpt",children:[(0,I.jsx)("option",{value:1,children:"Show"}),(0,I.jsx)("option",{value:0,children:"Hide"})]})})]}),(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{style:{verticalAlign:"middle"},children:"Order Status"}),(0,I.jsx)("td",{children:(0,I.jsx)(v.Ay,{value:null===$||void 0===$?void 0:$.OrderStatus,onChange:e=>ee((0,d.A)((0,d.A)({},$),{},{OrderStatus:e})),options:[{value:"",label:"ALL"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"}],styles:h.MR,isSearchable:!1,placeholder:"Order Status"})})]})]})})})}),(0,I.jsxs)(u.A,{children:[(0,I.jsx)(o.A,{onClick:re,children:"close"}),(0,I.jsx)(o.A,{onClick:()=>{re(),(0,x.Mb)({Fromdate:null===$||void 0===$?void 0:$.Fromdate,Todate:$.Todate,pageID:R,Retailer:$.Retailer,CreatedBy:$.CreatedBy,SalesPerson:$.SalesPerson,VoucherType:$.VoucherType,Cancel_status:$.Cancel_status,OrderStatus:$.OrderStatus})},startIcon:(0,I.jsx)(N.A,{}),variant:"outlined",children:"Search"})]})]}),(0,I.jsx)(y.A,{open:X,onClose:()=>{Y(!1),K(null)},editValues:null===q||void 0===q?void 0:q.row,defaultValues:null===q||void 0===q?void 0:q.payload,loadingOn:l,loadingOff:a,transactionType:"invoice"})]})}},79484:(e,l,a)=>{a.d(l,{A:()=>t});var d=a(59662),s=a(70579);const t=(0,d.A)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=5913.db9c39f5.chunk.js.map