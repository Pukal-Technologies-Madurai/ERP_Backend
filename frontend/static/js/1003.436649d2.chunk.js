"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[1003],{41003:(e,l,a)=>{a.r(l),a.d(l,{default:()=>P});var t=a(89379),r=a(65043),i=a(12110),o=a(26494),d=a(77739),n=a(17392),s=a(97707),u=a(592),c=a(48471),m=a(70579);const v=e=>{let{dataArray:l}=e;const a=["Stock_Group","Item_Name_Modified","Y1","M6","M2","LM","Total_Qty"],[i,o]=(0,r.useState)([]),d=(0,r.useMemo)(()=>l.map(e=>{const l=Array.isArray(null===e||void 0===e?void 0:e.StockTransaction)?null===e||void 0===e?void 0:e.StockTransaction:[],r=l[0]||{},i=Object.fromEntries(Object.entries(r).filter(e=>{let[l]=e;return!a.includes(l)&&!isNaN(Number(l))}).map(e=>{let[a]=e;o(e=>e.includes(a)?e:[...e,a]);const t=l.reduce((e,l)=>e+(Number(l[a])||0),0);return[a,t]}));return(0,t.A)((0,t.A)({},e),i)}),[l]);return(0,m.jsx)(r.Fragment,{children:(0,m.jsx)(c.Ay,{dataArray:d,isExpendable:!0,columns:[(0,c.Lj)("Stock_Group","string"),(0,c.Lj)("Y1","number"),(0,c.Lj)("M6","number"),(0,c.Lj)("M2","number"),(0,c.Lj)("LM","number"),(0,c.Lj)("Total_Qty","number"),...i.map(e=>(0,c.Lj)(e,"number","Day ".concat(e)))],expandableComp:e=>{let{row:l}=e;const t=Array.isArray(null===l||void 0===l?void 0:l.StockTransaction)?null===l||void 0===l?void 0:l.StockTransaction:[],r=[(0,c.Lj)("Item_Name_Modified","string","Item"),(0,c.Lj)("Y1","number"),(0,c.Lj)("M6","number"),(0,c.Lj)("M2","number"),(0,c.Lj)("LM","number"),(0,c.Lj)("Total_Qty","number")],i=Object.keys(t[0]||{}).filter(e=>!a.includes(e)&&"Stock_Group"!==e).map(e=>(0,c.Lj)(e,"number"));return(0,m.jsx)(c.Ay,{initialPageCount:10,dataArray:t,columns:[...r,...i]})},tableMaxHeight:540})})},p=e=>{let{dataArray:l,days:a}=e;const i=(0,r.useMemo)(()=>l.map(e=>{var l,r,i,o,d;return(0,t.A)((0,t.A)({},e),{},{M2_Avg:null!==(l=(0,s.SX)(e.ALL_Avg_M2,(0,s.Dl)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(r=(0,s.SX)(e.ALL_Avg_M3,(0,s.Dl)(3)/3))&&void 0!==r?r:0,M6_Avg:null!==(i=(0,s.SX)(e.ALL_Avg_M6,(0,s.Dl)(6)/6))&&void 0!==i?i:0,M9_Avg:null!==(o=(0,s.SX)(e.ALL_Avg_M9,(0,s.Dl)(9)/9))&&void 0!==o?o:0,M12_Avg:null!==(d=(0,s.SX)(e.ALL_Avg_One_Year,(0,s.Dl)(12)/12))&&void 0!==d?d:0,Billed_Qty:(0,s.Wd)(e.StockTransaction,"bill_qty"),Billed_Avg:(0,s.Wd)(e.StockTransaction,"bill_qty")/a,StockTransaction:e.StockTransaction.map(e=>{var l,a,r,i,o;return(0,t.A)((0,t.A)({},e),{},{Grade_Item_Group:e.Item_Name_Modified,M2_Avg:null!==(l=(0,s.SX)(e.M2_AVG_Qty,(0,s.Dl)(2)/2))&&void 0!==l?l:0,M3_Avg:null!==(a=(0,s.SX)(e.M3_AVG_Qty,(0,s.Dl)(3)/3))&&void 0!==a?a:0,M6_Avg:null!==(r=(0,s.SX)(e.M6_AVG_Qty,(0,s.Dl)(6)/6))&&void 0!==r?r:0,M9_Avg:null!==(i=(0,s.SX)(e.M9_AVG_Qty,(0,s.Dl)(9)/9))&&void 0!==i?i:0,M12_Avg:null!==(o=(0,s.SX)(e.One_Year_AVG_Qty,(0,s.Dl)(12)/12))&&void 0!==o?o:0})})})}).map(e=>(0,t.A)((0,t.A)({},e),{},{Billed_Qty:(0,s.Wd)(e.StockTransaction,"bill_qty")})),[l]);return(0,m.jsx)(r.Fragment,{children:(0,m.jsx)(c.Ay,{dataArray:i,isExpendable:!0,columns:[{Field_Name:"Stock_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"Billed_Qty",isVisible:1,Fied_Data:"number"},{Field_Name:"Billed_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}],expandableComp:e=>{let{row:l}=e;return(0,m.jsx)(c.Ay,{initialPageCount:10,dataArray:Array.isArray(l.StockTransaction)?l.StockTransaction:[],columns:[{Field_Name:"Grade_Item_Group",isVisible:1,Fied_Data:"string"},{Field_Name:"bill_qty",isVisible:1,Fied_Data:"number"},{Field_Name:"M2_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M3_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M6_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M9_Avg",isVisible:1,Fied_Data:"number"},{Field_Name:"M12_Avg",isVisible:1,Fied_Data:"number"}]})},tableMaxHeight:540})})};var A=a(47805),g=a(65074),_=a(12412),y=a(51962),x=a(67784),h=a(83462),j=a(35316),b=a(29347),F=a(11906),f=a(26600),D=a(63336),N=a(4598),S=a(12249),T=a(5793),w=a(32069),C=a(8846),B=a(59383),M=a(433),L=a(30599);const k=(0,m.jsx)(S.A,{fontSize:"small"}),O=(0,m.jsx)(T.A,{fontSize:"small"}),I=e=>{let{row:l,Fromdate:a,Todate:i,DB:o}=e;const[d,n]=(0,r.useState)([]),[s,c]=(0,r.useState)([]),[v,p]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{p(!0),(0,g.z)({address:"reports/salesReport/ledger/itemDetails?Fromdate=".concat(a,"&Todate=").concat(i,"&Ledger_Id=").concat(null===l||void 0===l?void 0:l.Ledger_Tally_Id),headers:{Db:o}}).then(e=>{let{success:l,data:a,others:r}=e;if(l){const{dataTypeInfo:e}=r;n(a),c(l=>(0,t.A)((0,t.A)({},l),{},{salesInfo:Array.isArray(e)?e:[]}))}else n([])}).catch(e=>console.error(e)).finally(()=>{p(!1)})},[null===l||void 0===l?void 0:l.Ledger_Tally_Id,a,i]),v?(0,m.jsx)("h5",{className:"text-center text-primary ",children:"Loading..."}):(0,m.jsx)(u.A,{dataArray:d,columns:s.salesInfo})},V=e=>{let{row:l,Fromdate:a,Todate:i,DB:o}=e;const[d,n]=(0,r.useState)([]),[c,v]=(0,r.useState)([]),[p,A]=(0,r.useState)(!1),_=(0,r.useMemo)(()=>(0,s.$r)(null===l||void 0===l?void 0:l.groupedData).map(e=>null===e||void 0===e?void 0:e.Ledger_Tally_Id).filter(Boolean).sort((e,l)=>String(e).localeCompare(String(l))).join(","),[null===l||void 0===l?void 0:l.groupedData]);return(0,r.useEffect)(()=>{if(!_)return void n([]);let e=!1;return A(!0),(0,g.z)({address:"reports/salesReport/ledger/groupSales?Fromdate=".concat(a,"&Todate=").concat(i,"&Ledger_Id=").concat(_),headers:{Db:o}}).then(l=>{let{success:a,data:r,others:i}=l;if(!e)if(a){const{dataTypeInfo:e}=i||{};n(r||[]),v(l=>(0,t.A)((0,t.A)({},l),{},{salesInfo:Array.isArray(e)?e:[]}))}else n([])}).catch(console.error).finally(()=>{e||A(!1)}),()=>{e=!0}},[_,a,i,o]),p?(0,m.jsx)("h5",{className:"text-center text-primary ",children:"Loading..."}):(0,m.jsx)(u.A,{dataArray:d,columns:c.salesInfo})},G=e=>{let{row:l,groupByFields:a,level:i,DB:o,Fromdate:d,Todate:n,DisplayColumn:u,showGroupSalesDetails:v}=e;const p=a[i],A=(0,r.useMemo)(()=>u.filter(e=>"number"===(0,s.iw)(e.Fied_Data)).map(e=>e.Field_Name),[u]),g=(0,r.useMemo)(()=>{if(!p)return[];const e=(0,s.$r)(null===l||void 0===l?void 0:l.groupedData);if(!e.length)return[];return(0,s.Sq)(e,p).map(e=>{const l=(0,s.$r)(null===e||void 0===e?void 0:e.groupedData);return(0,t.A)((0,t.A)({},e),Object.fromEntries(A.map(e=>[e,"Total_Qty"===e?l.reduce((l,a)=>(0,s.Lr)(l,(0,s.Ro)(a[e])||0),0):(0,s.SX)(l.reduce((l,a)=>(0,s.Lr)(l,(0,s.Ro)(a[e])||0),0),l.length||1)])))})},[null===l||void 0===l?void 0:l.groupedData,p,A]),_=(0,r.useMemo)(()=>p&&0!==g.length?u.filter(e=>Object.keys(g[0]).includes(e.Field_Name)).map(e=>(0,t.A)((0,t.A)({},e),{},{ColumnHeader:e.Field_Name===p?p:e.ColumnHeader})):u,[u,g,p]);if(!p){const e=(0,s.$r)(null===l||void 0===l?void 0:l.groupedData);return v?(0,m.jsx)(V,{row:(0,t.A)((0,t.A)({},l),{},{groupedData:e}),DB:o,Fromdate:d,Todate:n}):(0,m.jsx)(c.Ay,{title:"Ledgers",dataArray:e,columns:u,ExcelPrintOption:!0,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,m.jsx)(I,{row:l,DB:o,Fromdate:d,Todate:n})}})}return(0,m.jsx)(c.Ay,{title:"".concat((null===p||void 0===p?void 0:p.replace(/_/g," "))||"Group"," - Sub Group"),dataArray:g,columns:_,ExcelPrintOption:!0,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,m.jsx)(G,{row:l,groupByFields:a,level:i+1,DB:o,Fromdate:d,Todate:n,DisplayColumn:u,showGroupSalesDetails:v})}})},R=e=>{let{row:l,groupBy:a,groupBy2:t,groupBy3:r,DB:i,Fromdate:o,Todate:d,DisplayColumn:n,showGroupSalesDetails:s}=e;const u=[a,t,r];return a?(0,m.jsx)(G,{row:l,groupByFields:u,level:1,DB:i,Fromdate:o,Todate:d,DisplayColumn:n,showGroupSalesDetails:s}):(0,m.jsx)(I,{row:l,DB:i,Fromdate:o,Todate:d})},E=e=>{let{dataArray:l,colTypes:a,DB:o,Fromdate:u,Todate:v}=e;const[p,A]=(0,r.useState)({}),[g,S]=(0,r.useState)(""),[T,I]=(0,r.useState)(""),[V,G]=(0,r.useState)(""),[E,P]=(0,r.useState)([]),[z,Q]=(0,r.useState)(!1),[X,q]=(0,r.useState)(!1),[H,W]=(0,r.useState)(!1),Y=a.map((e,l)=>({isVisible:l<10?1:0,Field_Name:null===e||void 0===e?void 0:e.Column_Name,Fied_Data:null===e||void 0===e?void 0:e.Data_Type,OrderBy:l+1})),[$,J]=(0,r.useState)(Y),K=(0,r.useMemo)(()=>[...$].sort((e,l)=>null!==e&&void 0!==e&&e.OrderBy&&null!==l&&void 0!==l&&l.OrderBy?(null===e||void 0===e?void 0:e.OrderBy)-(null===l||void 0===l?void 0:l.OrderBy):(null===l||void 0===l?void 0:l.OrderBy)-(null===e||void 0===e?void 0:e.OrderBy)),[$]),U=(0,r.useMemo)(()=>K.filter(e=>(0,s.id)(null===e||void 0===e?void 0:e.Defult_Display,1)||(0,s.id)(null===e||void 0===e?void 0:e.isVisible,1)),[K]),Z=(0,r.useMemo)(()=>U.filter(e=>"string"===(0,s.iw)(e.Fied_Data)&&"Ledger_Name"!==(null===e||void 0===e?void 0:e.Field_Name)),[U]),ee=(0,r.useMemo)(()=>{const e=Object.keys(p).length>0,a=!!g,r=e?E:l,i=a?(0,s.Sq)(r,g):[],o=U.filter(e=>"number"===(0,s.iw)(e.Fied_Data)).map(e=>e.Field_Name),d=i.map(e=>(0,t.A)((0,t.A)({},e),Object.fromEntries(o.map(l=>{var a,t;return[l,"Total_Qty"===l?null===e||void 0===e||null===(a=e.groupedData)||void 0===a?void 0:a.reduce((e,a)=>(0,s.Lr)(e,(0,s.Ro)(a[l])||0),0):(0,s.SX)(null===e||void 0===e||null===(t=e.groupedData)||void 0===t?void 0:t.reduce((e,a)=>(0,s.Lr)(e,(0,s.Ro)(a[l])||0),0),e.groupedData.length)]}))));return a?d:r},[p,l,E,g,U]);(0,r.useEffect)(()=>{ae()},[p]);const le=(e,l)=>{A(a=>(0,t.A)((0,t.A)({},a),{},{[e]:l}))},ae=()=>{let e=[...l];for(const l of K)if(p[l.Field_Name])if("range"===p[l.Field_Name].type){const{min:a,max:t}=p[l.Field_Name];e=e.filter(e=>{const r=e[l.Field_Name];return(void 0===a||r>=a)&&(void 0===t||r<=t)})}else if("date"===p[l.Field_Name].type){const{start:a,end:t}=p[l.Field_Name].value;e=e.filter(e=>{const r=new Date(e[l.Field_Name]);return(void 0===a||r>=new Date(a))&&(void 0===t||r<=new Date(t))})}else if(Array.isArray(p[l.Field_Name])){var a;e=(null===(a=p[l.Field_Name])||void 0===a?void 0:a.length)>0?e.filter(e=>{var a;return p[l.Field_Name].includes(null===(a=e[l.Field_Name])||void 0===a?void 0:a.toLowerCase().trim())}):e}P(e)},te=e=>{const{Field_Name:a,Fied_Data:r}=e;var i,o,d,n,s,u,c,v,A,g;if("number"===r)return(0,m.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,m.jsx)("input",{placeholder:"Min",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(i=null===(o=p[a])||void 0===o?void 0:o.min)&&void 0!==i?i:"",onChange:e=>le(a,(0,t.A)((0,t.A)({type:"range"},p[a]),{},{min:e.target.value?parseFloat(e.target.value):void 0}))}),(0,m.jsx)("input",{placeholder:"Max",type:"number",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(d=null===(n=p[a])||void 0===n?void 0:n.max)&&void 0!==d?d:"",onChange:e=>le(a,(0,t.A)((0,t.A)({type:"range"},p[a]),{},{max:e.target.value?parseFloat(e.target.value):void 0}))})]});if("date"===r)return(0,m.jsxs)("div",{className:"d-flex justify-content-between px-2",children:[(0,m.jsx)("input",{placeholder:"Start Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(s=null===(u=p[a])||void 0===u||null===(c=u.value)||void 0===c?void 0:c.start)&&void 0!==s?s:"",onChange:e=>{var l;return le(a,{type:"date",value:(0,t.A)((0,t.A)({},null===(l=p[a])||void 0===l?void 0:l.value),{},{start:e.target.value||void 0})})}}),(0,m.jsx)("input",{placeholder:"End Date",type:"date",className:"bg-light border-0 m-1 p-1 w-50",value:null!==(v=null===(A=p[a])||void 0===A||null===(g=A.value)||void 0===g?void 0:g.end)&&void 0!==v?v:"",onChange:e=>{var l;return le(a,{type:"date",value:(0,t.A)((0,t.A)({},null===(l=p[a])||void 0===l?void 0:l.value),{},{end:e.target.value||void 0})})}})]});if("string"===r){const e=[...new Set(l.map(e=>{var l,t;return null===(l=e[a])||void 0===l||null===(t=l.toLowerCase())||void 0===t?void 0:t.trim()}))];return(0,m.jsx)(_.A,{multiple:!0,id:"".concat(a,"-filter"),options:e,disableCloseOnSelect:!0,getOptionLabel:e=>e,value:p[a]||[],onChange:(e,l)=>le(a,l),renderOption:(e,l,a)=>{let{selected:r}=a;return(0,m.jsxs)("li",(0,t.A)((0,t.A)({},e),{},{children:[(0,m.jsx)(y.A,{icon:k,checkedIcon:O,style:{marginRight:8},checked:r}),l]}))},isOptionEqualToValue:(e,l)=>e===l,renderInput:e=>(0,m.jsx)(x.A,(0,t.A)((0,t.A)({},e),{},{label:a,placeholder:"Select ".concat(null===a||void 0===a?void 0:a.replace(/_/g," "))}))})}},re=()=>{Q(!1),q(!1)};return(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(c.Ay,{title:"LOL - Sales Reports",headerFontSizePx:12,bodyFontSizePx:12,ButtonArea:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.A,{title:"Column Visiblity",children:(0,m.jsx)(n.A,{size:"small",onClick:()=>Q(!0),children:(0,m.jsx)(w.A,{})})}),(0,m.jsx)(d.A,{title:"Clear Filters",children:(0,m.jsx)(n.A,{size:"small",onClick:()=>A({}),children:(0,m.jsx)(C.A,{})})}),(0,m.jsx)(d.A,{title:"Filters",children:(0,m.jsx)(n.A,{onClick:()=>q(!0),size:"small",children:(0,m.jsx)(B.A,{})})}),(0,m.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:g,onChange:e=>{const l=e.target.value;S(l),I(""),G("")},children:[(0,m.jsx)("option",{value:"",children:"Group By"}),Z.map((e,l)=>{var a;return(0,m.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")},l)})]}),(0,m.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:T,onChange:e=>{I(e.target.value),G("")},disabled:!g,children:[(0,m.jsx)("option",{value:"",children:"Sub Group 1"}),Z.filter(e=>e.Field_Name!==g).map((e,l)=>{var a;return(0,m.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")},l)})]}),(0,m.jsxs)("select",{className:"cus-inpt p-2 w-auto m-1",value:V,onChange:e=>G(e.target.value),disabled:!g||!T,children:[(0,m.jsx)("option",{value:"",children:"Sub Group 2"}),Z.filter(e=>e.Field_Name!==g&&e.Field_Name!==T).map((e,l)=>{var a;return(0,m.jsx)("option",{value:null===e||void 0===e?void 0:e.Field_Name,children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")},l)})]})]}),MenuButtons:[{name:"Show Grouped Sales",icon:H?(0,m.jsx)(M.A,{color:"primary"}):(0,m.jsx)(L.A,{}),onclick:()=>W(e=>!e)}],ExcelPrintOption:!0,columns:g?U.filter(e=>ee.length>0&&Object.keys(ee[0]).includes(e.Field_Name)).map(e=>(0,t.A)((0,t.A)({},e),{},{ColumnHeader:e.Field_Name===g?g:e.ColumnHeader})):U,dataArray:ee,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,m.jsx)(R,{row:l,DB:o,Fromdate:u,Todate:v,groupBy:g,groupBy2:T,groupBy3:V,DisplayColumn:U,showGroupSalesDetails:H})},maxHeightOption:!0}),(0,m.jsxs)(h.A,{open:X,onClose:re,maxWidth:"sm",fullWidth:!0,children:[(0,m.jsxs)(j.A,{children:[(0,m.jsxs)("h5",{className:"d-flex justify-content-between px-2",children:[(0,m.jsx)("span",{children:"Filters"}),(0,m.jsxs)("span",{children:[(0,m.jsx)(d.A,{title:"Column Visiblity",children:(0,m.jsx)(n.A,{size:"small",onClick:()=>Q(!0),children:(0,m.jsx)(w.A,{})})}),(0,m.jsx)(d.A,{title:"Clear Filters",children:(0,m.jsx)(n.A,{size:"small",onClick:()=>A({}),children:(0,m.jsx)(C.A,{})})})]})]}),(0,m.jsxs)("div",{className:"border rounded-3 ",children:[U.map((e,l)=>{var a;return(0,m.jsxs)("div",{className:"py-3 px-3 hov-bg border-bottom",children:[(0,m.jsx)("label",{className:"mt-2 mb-1",children:null===e||void 0===e||null===(a=e.Field_Name)||void 0===a?void 0:a.replace(/_/g," ")}),te(e)]},l)}),(0,m.jsx)("br",{})]})]}),(0,m.jsx)(b.A,{children:(0,m.jsx)(F.A,{onClick:re,color:"error",children:"close"})})]}),(0,m.jsxs)(h.A,{open:z,onClose:()=>Q(!1),maxWidth:"lg",fullWidth:!0,children:[(0,m.jsx)(f.A,{children:"Column Settings"}),(0,m.jsx)(j.A,{children:(0,m.jsx)("div",{className:"row",children:$.map((e,l)=>(0,m.jsx)("div",{className:"col-lg-4 col-md-6 p-2",children:(0,m.jsxs)(i.A,{component:D.A,className:"p-2 d-flex justify-content-between align-items-center flex-wrap ".concat(l%2!==0?"bg-light":""),children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap",children:[(0,m.jsx)(N.A,{checked:Boolean(null===e||void 0===e?void 0:e.isDefault)||Boolean(null===e||void 0===e?void 0:e.isVisible),disabled:Boolean(null===e||void 0===e?void 0:e.isDefault),onChange:l=>J(a=>a.map(a=>a.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.A)((0,t.A)({},a),{},{isVisible:l.target.checked?1:0}):a))}),(0,m.jsx)("h6",{className:"fa-13 mb-0 fw-bold ",children:null===e||void 0===e?void 0:e.Field_Name})]}),(0,m.jsx)("input",{type:"number",value:(0,s.IQ)(null===e||void 0===e?void 0:e.OrderBy)?null===e||void 0===e?void 0:e.OrderBy:"",onChange:l=>J(a=>a.map(a=>a.Field_Name===(null===e||void 0===e?void 0:e.Field_Name)?(0,t.A)((0,t.A)({},a),{},{OrderBy:l.target.value}):a)),label:"Order Value",className:"mt-2 p-1 border-0 cus-inpt",style:{width:"80px"},placeholder:"Order"})]})},l))})}),(0,m.jsxs)(b.A,{children:[(0,m.jsx)(F.A,{onClick:()=>J(Y),variant:"outlined",children:"Reset"}),(0,m.jsx)(F.A,{onClick:()=>Q(!1),color:"error",children:"close"})]})]})]})},P=e=>{let{loadingOn:l,loadingOff:a}=e;const u=JSON.parse(localStorage.getItem("user")),[c,_]=(0,r.useState)(null),[y,x]=(0,r.useState)({salesInfo:[],salesItemInfo:[]}),[h,j]=(0,r.useState)(null),[b,F]=(0,r.useState)({Fromdate:(0,s.IS)(1),Todate:(0,s.ny)(),ReportType:"LedgerBased",filterDialog:!1,reload:!0});(0,r.useEffect)(()=>{_(null),j(null),x({salesInfo:[],salesItemInfo:[]}),(0,g.z)({address:"reports/salesReport/ledger?Fromdate=".concat(null===b||void 0===b?void 0:b.Fromdate,"&Todate=").concat(null===b||void 0===b?void 0:b.Todate),headers:{Db:null===u||void 0===u?void 0:u.Company_id}}).then(e=>{let{success:l,data:a,others:r}=e;if(l){const{dataTypeInfo:e}=r;_(a),x(l=>(0,t.A)((0,t.A)({},l),{},{salesInfo:Array.isArray(e)?e:[]}))}else _([])}).catch(console.error),(0,g.z)({address:"reports/salesReport/products?Fromdate=".concat(null===b||void 0===b?void 0:b.Fromdate,"&Todate=").concat(null===b||void 0===b?void 0:b.Todate),headers:{Db:null===u||void 0===u?void 0:u.Company_id}}).then(e=>{if(e.success){var l;const{dataTypeInfo:a}=null===e||void 0===e?void 0:e.others,r=Array.isArray(null===e||void 0===e||null===(l=e.others)||void 0===l?void 0:l.LOSAbstract)?e.others.LOSAbstract.map(l=>(0,t.A)((0,t.A)({},l),{},{StockTransaction:Array.isArray(e.data)?[...e.data].filter(e=>e.Stock_Group===l.Stock_Group):[]})):[];x(e=>(0,t.A)((0,t.A)({},e),{},{salesItemInfo:Array.isArray(a)?a:[]})),j(r)}else j([])}).catch(e=>console.error(e))},[b.reload]);const f=()=>{F(e=>(0,t.A)((0,t.A)({},e),{},{filterDialog:!1}))},D=(0,s.kY)(new Date(b.Fromdate),new Date(b.Todate));return(0,m.jsx)(r.Fragment,{children:(0,m.jsxs)(i.A,{className:"mt-3",children:[(0,m.jsxs)("div",{className:"px-3 py-2 d-flex justify-content-between align-items-center fw-bold text-dark",style:{backgroundColor:"#eae0cc"},children:[(0,m.jsx)("span",{children:null===u||void 0===u?void 0:u.Company_Name}),(0,m.jsx)("span",{children:(0,m.jsxs)("select",{value:b.ReportType,className:"cus-inpt ps-3 w-100 rounded-5 border-0",onChange:e=>F(l=>(0,t.A)((0,t.A)({},l),{},{ReportType:e.target.value})),children:[(0,m.jsx)("option",{value:"LedgerBased",children:"Ledger Based"}),(0,m.jsx)("option",{value:"ProductBased",children:"Product Based"}),(0,m.jsx)("option",{value:"ProductDayAverage",children:"Product/Day Based"})]})})]}),(0,m.jsxs)(o.A,{children:[(0,m.jsx)("div",{className:"mb-3",children:(0,m.jsxs)("form",{onSubmit:e=>{e.preventDefault(),F(e=>(0,t.A)((0,t.A)({},e),{},{reload:!e.reload}))},children:[(0,m.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5 me-1",value:b.Fromdate,onChange:e=>F(l=>(0,t.A)((0,t.A)({},l),{},{Fromdate:e.target.value}))}),(0,m.jsx)("input",{type:"date",className:"cus-inpt w-auto ps-3 border rounded-5",value:b.Todate,onChange:e=>F(l=>(0,t.A)((0,t.A)({},l),{},{Todate:e.target.value}))}),(0,m.jsx)(d.A,{title:"Reload Data",children:(0,m.jsx)(n.A,{size:"small",className:"ms-2",type:"submit",children:(0,m.jsx)(A.A,{})})})]})}),null===c&&"LedgerBased"===b.ReportType&&(0,m.jsx)("h6",{className:"blue-text text-center",children:"Fetching Ledger Based data..."}),null===h&&("ProductBased"===b.ReportType||"ProductDayAverage"===b.ReportType)&&(0,m.jsx)("h6",{className:"blue-text text-center",children:"Fetching Product Based data..."}),"LedgerBased"===b.ReportType&&Array.isArray(c)&&(0,m.jsx)(E,{filterDialog:b.filterDialog,closeDialog:f,dataArray:c,colTypes:y.salesInfo,DB:null===u||void 0===u?void 0:u.Company_id,Fromdate:null===b||void 0===b?void 0:b.Fromdate,Todate:null===b||void 0===b?void 0:b.Todate,loadingOn:l,loadingOff:a}),"ProductBased"===b.ReportType&&Array.isArray(h)&&(0,m.jsx)(v,{filterDialog:b.filterDialog,closeDialog:f,dataArray:h,fromDate:b.Fromdate,toDate:b.Todate}),"ProductDayAverage"===b.ReportType&&Array.isArray(h)&&(0,m.jsx)(p,{filterDialog:b.filterDialog,closeDialog:f,dataArray:h,days:D})]})]})})}}}]);
//# sourceMappingURL=1003.436649d2.chunk.js.map