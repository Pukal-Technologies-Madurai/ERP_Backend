"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5438],{33438:(e,l,t)=>{t.d(l,{A:()=>d});var a=t(59662),o=t(70579);const d=(0,a.A)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},58225:(e,l,t)=>{t.r(l),t.d(l,{default:()=>T});var a=t(89379),o=t(65043),d=t(77739),s=t(17392),i=t(11906),r=t(83462),c=t(26600),n=t(35316),u=t(29347),v=t(20656),h=t(63406),m=t(97707),p=t(13899),x=t(59383),b=t(79484),j=t(65074),y=t(48471),g=t(73216),A=t(70579);const C={Fromdate:(0,m.ny)(),Todate:(0,m.ny)()},T=e=>{let{loadingOn:l,loadingOff:t}=e;JSON.parse(localStorage.getItem("user"));const T=(0,g.Zp)(),N=(0,g.zy)(),_=N.state,F=new URLSearchParams((0,g.zy)().search),[f,S]=(0,o.useState)([]),[R,L]=(0,o.useState)([]),[w,B]=(0,o.useState)([]),[D,k]=(0,o.useState)({}),[M,V]=(0,o.useState)(!1),[z,E]=(0,o.useState)([]),[P,G]=(0,o.useState)([]),[I,O]=(0,o.useState)([]),[H,U]=(0,o.useState)(!1),[W,J]=(0,o.useState)(!1),[Y,Z]=(0,o.useState)({Fromdate:(0,m.ny)(),Todate:(0,m.ny)(),Retailer:{value:"",label:"ALL"},CollectionType:{value:"",label:"ALL"},CollectedBy:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:0}),[q,K]=(0,o.useState)({filters:!1,orderDetails:!1});(0,o.useEffect)(()=>{var e,a,o,d;l&&l(),(0,j.z)({address:"reports/collectionReport?Fromdate=".concat(null===Y||void 0===Y?void 0:Y.Fromdate,"&Todate=").concat(null===Y||void 0===Y?void 0:Y.Todate,"&retailer_id=").concat(null===Y||void 0===Y||null===(e=Y.Retailer)||void 0===e?void 0:e.value,"&collected_by=").concat(null===Y||void 0===Y||null===(a=Y.CollectedBy)||void 0===a?void 0:a.value,"&collection_type=").concat(null===Y||void 0===Y||null===(o=Y.CollectionType)||void 0===o?void 0:o.value,"&voucher_id=").concat(null===Y||void 0===Y||null===(d=Y.VoucherType)||void 0===d?void 0:d.value,"&Cancel_status=").concat(null===Y||void 0===Y?void 0:Y.Cancel_status)}).then(e=>{e.success&&S(null===e||void 0===e?void 0:e.data)}).catch(e=>console.error(e)).finally(()=>{t&&t()})},[M]),(0,o.useEffect)(()=>{var e,a,o,d;W&&(l&&l(),(0,j.z)({address:"reports/cummulativeReport?Fromdate=".concat(null===Y||void 0===Y?void 0:Y.Fromdate,"&Todate=").concat(null===Y||void 0===Y?void 0:Y.Todate,"&retailer_id=").concat(null===Y||void 0===Y||null===(e=Y.Retailer)||void 0===e?void 0:e.value,"&collected_by=").concat(null===Y||void 0===Y||null===(a=Y.CollectedBy)||void 0===a?void 0:a.value,"&collection_type=").concat(null===Y||void 0===Y||null===(o=Y.CollectionType)||void 0===o?void 0:o.value,"&voucher_id=").concat(null===Y||void 0===Y||null===(d=Y.VoucherType)||void 0===d?void 0:d.value,"&Cancel_status=").concat(null===Y||void 0===Y?void 0:Y.Cancel_status)}).then(e=>{e.success&&O(e.data)}).catch(e=>{console.error(e)}).finally(()=>{t&&t(),J(!1)}))},[W]),(0,o.useEffect)(()=>{(0,j.z)({address:"receipt/filterValues"}).then(e=>{e.success&&e.others&&(B(e.others.voucherType||[]),L(e.others.retailers||[]),E(e.others.collectionType||[]),G(e.others.collectedBy||[]))}).catch(e=>{console.error("Failed to fetch filter values",e)})},[]),(0,o.useEffect)(()=>{const e={Fromdate:F.get("Fromdate")&&(0,m.vd)(F.get("Fromdate"))?F.get("Fromdate"):C.Fromdate,Todate:F.get("Todate")&&(0,m.vd)(F.get("Todate"))?F.get("Todate"):C.Todate};Z(l=>(0,a.A)((0,a.A)({},l),{},{Fromdate:e.Fromdate,Todate:e.Todate}))},[N.search]),(0,o.useEffect)(()=>{const e=null!==_&&void 0!==_&&_.Fromdate&&(0,m.vd)(null===_||void 0===_?void 0:_.Fromdate)?(0,m.ny)(null===_||void 0===_?void 0:_.Fromdate):null,l=null!==_&&void 0!==_&&_.Todate&&(0,m.vd)(null===_||void 0===_?void 0:_.Todate)?(0,m.ny)(null===_||void 0===_?void 0:_.Todate):null;e&&l&&(Q({Fromdate:e,Todate:l}),Z(e=>(0,a.A)((0,a.A)({},e),{},{Fromdate:(0,m.ny)(_.Fromdate),Todate:_.Todate})),V(e=>!e))},[_]);const Q=e=>{const l=new URLSearchParams(e);T("?".concat(l.toString()),{replace:!0})},X=()=>{K((0,a.A)((0,a.A)({},q),{},{filters:!1,orderDetails:!1}))},$=(0,o.useMemo)(()=>f.reduce((e,l)=>{const t=(l.Receipts||[]).reduce((e,l)=>e+(l.collected_amount||0),0);return(0,m.Lr)(e,t)},0),[f]);return(0,A.jsxs)(A.Fragment,{children:[H?(0,A.jsx)(y.Ay,{title:"Collection Report",dataArray:f,EnableSerialNumber:!0,columns:[(0,y.Lj)("RetailerGet","string","Retailer"),(0,y.Lj)("collection_inv_no","string","collection_inv_no"),{ColumnHeader:"CollectionDate",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=l.collection_date;let a="Undefined";if(t){const e=new Date(t);isNaN(e)||(a="".concat(e.getDate().toString().padStart(2,"0"),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getFullYear()))}return(0,A.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 ".concat(t?"bg-success text-white":"bg-secondary text-white"),children:a})}},{ColumnHeader:"Receipts",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{let{row:l}=e;const t=(l.Receipts||[]).reduce((e,l)=>e+(l.collected_amount||0),0);return(0,A.jsx)("span",{className:"py-0 fw-bold px-2 rounded-4 fa-12 ".concat(t?"bg-success text-white":"bg-secondary text-white"),children:t||"Undefined"})}},(0,y.Lj)("CollectedByGet","string","Collected_By"),(0,y.Lj)("collection_type","string","Collection_Type")],ButtonArea:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.A,{title:"Filters",children:(0,A.jsx)(s.A,{size:"small",onClick:()=>K((0,a.A)((0,a.A)({},q),{},{filters:!0})),children:(0,A.jsx)(x.A,{})})}),Number($)>0&&(0,A.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",$]}),(0,A.jsx)(i.A,{onClick:()=>{U(!1),J(!1)},children:"Cummulative Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.Receipts||[];return(0,A.jsx)(A.Fragment,{children:0===t.length?(0,A.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map((e,l)=>(0,A.jsx)("table",{className:"table mb-3",children:(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Do_Inv_No"}),(0,A.jsx)("td",{className:"border p-2",children:e.Do_Inv_No}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Do_Date"}),(0,A.jsx)("td",{className:"border p-2",children:e.Do_Date}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Total Invoice Value"}),(0,A.jsx)("td",{className:"border p-2",children:e.Total_Invoice_value})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Collected Amount"}),(0,A.jsx)("td",{className:"border p-2",children:e.collected_amount}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Bill Amount"}),(0,A.jsx)("td",{className:"border p-2",children:e.bill_amount}),(0,A.jsx)("td",{className:"border p-2 bg-light",children:"Total Receipt Amount"}),(0,A.jsx)("td",{className:"border p-2",children:e.total_receipt_amount})]})]})},l))})}}):(0,A.jsx)(y.Ay,{title:"Cummulative Report",dataArray:I,EnableSerialNumber:!0,columns:[(0,y.Lj)("collection_type","string","collection_type"),(0,y.Lj)("total_collected","string","total_collected")],ButtonArea:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(d.A,{title:"Filters",children:(0,A.jsx)(s.A,{size:"small",onClick:()=>K((0,a.A)((0,a.A)({},q),{},{filters:!0})),children:(0,A.jsx)(x.A,{})})}),Number($)>0&&(0,A.jsxs)("h6",{className:"m-0 text-end text-muted px-3",children:["Total: ",$]}),(0,A.jsx)(i.A,{onClick:()=>{U(!0),J(!0)},children:"Collection Report"})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;const t=l.retailers||[];return(0,A.jsx)(A.Fragment,{children:0===t.length?(0,A.jsx)("div",{className:"p-2 text-muted",children:"No receipts available."}):t.map((e,l)=>(0,A.jsx)("table",{className:"table mb-3",children:(0,A.jsx)("tbody",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"collection_inv_no"}),(0,A.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.collection_inv_no}),(0,A.jsx)("td",{className:"border p-2 bg-light",style:{width:"150px"},children:"RetailerGet"}),(0,A.jsx)("td",{className:"border p-2",style:{width:"250px"},children:e.RetailerGet}),(0,A.jsx)("td",{className:"border p-2 bg-light",style:{width:"180px"},children:"CollectedByGet"}),(0,A.jsx)("td",{className:"border p-2",style:{width:"200px"},children:e.CollectedByGet})]})})},l))})}}),Object.keys(D).length>0&&(0,A.jsx)(p.A,{orderDetails:null===D||void 0===D?void 0:D.orderDetails,orderProducts:null===D||void 0===D?void 0:D.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>k({}),TitleText:"Sale Order"}),(0,A.jsxs)(r.A,{open:q.filters,onClose:X,fullWidth:!0,maxWidth:"sm",children:[(0,A.jsx)(c.A,{children:"Filters"}),(0,A.jsx)(n.A,{children:(0,A.jsx)("div",{className:"table-responsive pb-4",children:(0,A.jsx)("table",{className:"table",children:(0,A.jsxs)("tbody",{children:[(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,A.jsx)("td",{children:(0,A.jsx)("input",{type:"date",value:Y.Fromdate,onChange:e=>Z((0,a.A)((0,a.A)({},Y),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,A.jsx)("td",{children:(0,A.jsx)("input",{type:"date",value:Y.Todate,onChange:e=>Z((0,a.A)((0,a.A)({},Y),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===Y||void 0===Y?void 0:Y.Retailer,onChange:e=>Z((0,a.A)((0,a.A)({},Y),{},{Retailer:e})),options:[{value:"",label:"ALL"},...R.map(e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label}))],styles:h.MR,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected By"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===Y||void 0===Y?void 0:Y.CollectedBy,onChange:e=>Z(l=>(0,a.A)((0,a.A)({},Y),{},{CollectedBy:e})),options:[{value:"",label:"ALL"},...P.map(e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Collected Type"}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===Y||void 0===Y?void 0:Y.CollectionType,onChange:e=>Z(l=>(0,a.A)((0,a.A)({},Y),{},{CollectionType:e})),options:[{value:"",label:"ALL"},...z.map(e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,A.jsxs)("tr",{children:[(0,A.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,A.jsx)("td",{children:(0,A.jsx)(v.Ay,{value:null===Y||void 0===Y?void 0:Y.VoucherType,onChange:e=>Z((0,a.A)((0,a.A)({},Y),{},{VoucherType:e})),options:[{value:"",label:"ALL"},...w.filter(e=>({value:null===e||void 0===e?void 0:e.value,label:null===e||void 0===e?void 0:e.label}))],styles:h.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name"})})]})]})})})}),(0,A.jsxs)(u.A,{children:[(0,A.jsx)(i.A,{onClick:X,children:"close"}),(0,A.jsx)(i.A,{onClick:()=>{X();const e={Fromdate:null===Y||void 0===Y?void 0:Y.Fromdate,Todate:null===Y||void 0===Y?void 0:Y.Todate};Q(e),V(e=>!e),J(!0)},startIcon:(0,A.jsx)(b.A,{}),variant:"outlined",children:"Search"})]})]})]})}},59383:(e,l,t)=>{t.d(l,{A:()=>d});var a=t(59662),o=t(70579);const d=(0,a.A)((0,o.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61"}),"FilterAlt")},79484:(e,l,t)=>{t.d(l,{A:()=>d});var a=t(59662),o=t(70579);const d=(0,a.A)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=5438.6d6e8367.chunk.js.map