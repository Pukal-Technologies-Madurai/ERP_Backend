"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[1667],{63406:(e,a,s)=>{s.d(a,{zU:()=>r,ex:()=>c,MR:()=>d,Ap:()=>o,FX:()=>n});var l=s(89379);const t=s.p+"static/media/smt.aa4d4f940bbebff07a57.png",o={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},d={menu:(e,a)=>(0,l.A)((0,l.A)({},e),{},{zIndex:9999}),menuPortal:e=>(0,l.A)((0,l.A)({},e),{},{zIndex:9999}),groupHeading:e=>(0,l.A)((0,l.A)({},e),{},{backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold",fontSize:"14px",padding:"8px 12px",borderBottom:"1px solid #ddd",textTransform:"uppercase"}),option:(e,a)=>(0,l.A)((0,l.A)({},e),{},{backgroundColor:a.isSelected?"#2684FF":a.isFocused?"#E2ECF9":"white",color:a.isSelected?"white":"#333",padding:"10px 12px"})},r=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],c=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:t,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}],n=[{name:"PURCHASE_ORDER"},{name:"PURCHASE_INVOICE"},{name:"SALE_ORDER"},{name:"SALE_INVOICE"},{name:"JOURNAL"},{name:"STOCK_JOURNAL"},{name:"PAYMENT"},{name:"RECEIPT"},{name:"CONTRA"}]},79963:(e,a,s)=>{s.r(a),s.d(a,{default:()=>N});var l=s(89379),t=s(65043),o=s(83462),d=s(26600),r=s(35316),c=s(29347),n=s(11906),i=(s(92342),s(27285)),m=s(34625),h=s(3805),u=s(7807),p=s(83806),v=s(20656),x=s(63406),j=s(65074),b=s(70579);const N=()=>{var e,a,s,N,f,k,g;const S=localStorage.getItem("user"),_=JSON.parse(S),A={Emp_Id:"",Project_Id:0,Task_Id:0,Process_Id:0,from:(new Date).toISOString().split("T")[0],to:(new Date).toISOString().split("T")[0],EmpGet:"All Employee",ProjectGet:"All Project",TaskGet:"All Task",ProcessGet:"All Process"},[y,T]=(0,t.useState)([]),[D,P]=(0,t.useState)([]),[C,E]=(0,t.useState)([]),[I,M]=(0,t.useState)({}),[w,R]=(0,t.useState)({}),[O,W]=(0,t.useState)(""),[G,B]=(0,t.useState)(!1),[F,z]=(0,t.useState)(!1),[L,U]=(0,t.useState)(A),[V,H]=(0,t.useState)([]),[J,Z]=(0,t.useState)([]),[K,Q]=(0,t.useState)([]),[X,Y]=(0,t.useState)("task");(0,t.useEffect)(()=>{let e="taskManagement/task/work?Emp_Id=".concat(L.Emp_Id,"&Project_Id=").concat(L.Project_Id,"&from=").concat(L.from,"&to=").concat(L.to,"&Task_Id=").concat(L.Task_Id);"process"===X&&(e+="&Process_Id=".concat(L.Process_Id)),(0,j.z)({address:e}).then(e=>{if(e.success&&(T(e.data),"process"===X)){const a=q(e.data);P(a)}}).catch(e=>console.error(e))},[L,X]);const q=e=>{const a={};return e.forEach(e=>{const s=new Date(e.Work_Dt).toISOString().split("T")[0];if(a[s]||(a[s]={date:s,processes:[],totalMinutes:0,totalTasks:0,employees:new Set,employeeDetails:{},processCount:{}}),e.Process_Name&&(a[s].processCount[e.Process_Name]||(a[s].processCount[e.Process_Name]=0),a[s].processCount[e.Process_Name]++),a[s].processes.push(e),a[s].totalMinutes+=parseInt(e.Tot_Minutes)||0,a[s].totalTasks++,e.EmployeeName&&e.Emp_Id){a[s].employees.add(e.EmployeeName);const l=e.Emp_Id.toString();a[s].employeeDetails[l]||(a[s].employeeDetails[l]={id:l,name:e.EmployeeName,tasks:[],totalMinutes:0}),a[s].employeeDetails[l].tasks.push(e),a[s].employeeDetails[l].totalMinutes+=parseInt(e.Tot_Minutes)||0}}),Object.values(a).map(e=>(0,l.A)((0,l.A)({},e),{},{employeeCount:e.employees.size,topProcesses:Object.entries(e.processCount).sort((e,a)=>a[1]-e[1]).slice(0,3).map(e=>{let[a,s]=e;return"".concat(a," (").concat(s,")")}).join(", "),employeesList:Object.values(e.employeeDetails)}))};(0,t.useEffect)(()=>{(0,j.z)({address:"taskManagement/project/dropDown?Company_id=".concat(null===_||void 0===_?void 0:_.Company_id)}).then(e=>{e.success&&H(e.data)}).catch(e=>console.error(e)),(0,j.z)({address:"masters/users/employee/dropDown?BranchId=".concat(null===_||void 0===_?void 0:_.BranchId,"&Company_id=").concat(null===_||void 0===_?void 0:_.Company_id)}).then(e=>{var a;e.success&&Z(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.sort((e,a)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===a||void 0===a?void 0:a.Name)))}).catch(e=>console.error(e)),(0,j.z)({address:"taskManagement/task/assignEmployee/task/dropDown"}).then(e=>{var a;e.success&&Q(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.sort((e,a)=>String(null===e||void 0===e?void 0:e.Task_Name).localeCompare(null===a||void 0===a?void 0:a.Task_Name)))}).catch(e=>console.error(e)),(0,j.z)({address:"taskManagement/processMaster/dropDown"}).then(e=>{e.success&&E(e.data)}).catch(e=>console.error(e))},[null===_||void 0===_?void 0:_.BranchId]);const $=e=>{const[a,s]=e.split(":").map(Number);let l=a%12;l=l||12;const t=a<12?"AM":"PM",o=s<10?"0"+s:s;return"".concat(l<10?"0"+l:l,":").concat(o," ").concat(t)},ee=e=>{if("task"===X)return null===e||void 0===e?void 0:e.Task_Name;{const a=D.find(a=>a.date===new Date(e.Work_Dt).toISOString().split("T")[0]);return a?"".concat(a.totalTasks," tasks | ").concat(a.totalMinutes,"m | ").concat(a.employeeCount," emp"):(null===e||void 0===e?void 0:e.Process_Name)||"No Process"}},ae=e=>{if("task"===X)return"#3788d8";{const a=D.find(a=>a.date===new Date(e.Work_Dt).toISOString().split("T")[0]);return a?a.totalMinutes>480?"#28a745":a.totalMinutes>240?"#ffc107":"#dc3545":"#28a745"}},se=()=>w&&w.processes?O?w.processes.filter(e=>e.Emp_Id&&e.Emp_Id.toString()===O.toString()):w.processes:[];const le=se().reduce((e,a)=>e+(parseInt(a.Tot_Minutes)||0),0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"row mb-3",children:(0,b.jsx)("div",{className:"col-12 d-flex justify-content-center",children:(0,b.jsxs)("div",{className:"toggle-container bg-light rounded-pill p-1 d-flex",children:[(0,b.jsx)("button",{className:"btn rounded-pill px-4 ".concat("task"===X?"btn-primary":"btn-light"),onClick:()=>Y("task"),children:"Task View"}),(0,b.jsx)("button",{className:"btn rounded-pill px-4 ".concat("process"===X?"btn-primary":"btn-light"),onClick:()=>Y("process"),children:"Process View"})]})})}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-xxl-2 col-lg-3 col-md-4 col-sm-4 p-2",children:(0,b.jsx)(v.Ay,{value:{value:null===L||void 0===L?void 0:L.Emp_Id,label:null===L||void 0===L?void 0:L.EmpGet},onChange:e=>U((0,l.A)((0,l.A)({},L),{},{Emp_Id:e.value,EmpGet:e.label})),options:[{value:"",label:"All Employee"},...J.map(e=>({value:e.UserId,label:e.Name}))],styles:x.MR,isSearchable:!0,placeholder:"Employee Name"})}),(0,b.jsx)("div",{className:"col-xxl-2 col-lg-3 col-md-4 col-sm-4 p-2",children:(0,b.jsx)(v.Ay,{value:{value:null===L||void 0===L?void 0:L.Project_Id,label:null===L||void 0===L?void 0:L.ProjectGet},onChange:e=>U((0,l.A)((0,l.A)({},L),{},{Project_Id:e.value,ProjectGet:e.label})),options:[...V.map(e=>({value:e.Project_Id,label:0===Number(e.Project_Id)?"All Project":e.Project_Name}))],styles:x.MR,isSearchable:!0,placeholder:"Project Title"})}),"task"===X&&(0,b.jsx)("div",{className:"col-xxl-2 col-lg-3 col-md-4 col-sm-4 p-2",children:(0,b.jsx)(v.Ay,{value:{value:null===L||void 0===L?void 0:L.Task_Id,label:null===L||void 0===L?void 0:L.TaskGet},onChange:e=>U((0,l.A)((0,l.A)({},L),{},{Task_Id:e.value,TaskGet:e.label})),options:[{value:0,label:"All Task"},...K.map(e=>({value:e.Task_Id,label:e.Task_Name}))],styles:x.MR,isSearchable:!0,placeholder:"Select Task"})}),"process"===X&&(0,b.jsx)("div",{className:"col-xxl-2 col-lg-3 col-md-4 col-sm-4 p-2",children:(0,b.jsx)(v.Ay,{value:{value:null===L||void 0===L?void 0:L.Process_Id,label:null===L||void 0===L?void 0:L.ProcessGet},onChange:e=>U((0,l.A)((0,l.A)({},L),{},{Process_Id:e.value,ProcessGet:e.label})),options:[{value:0,label:"All Process"},...C.map(e=>({value:e.Id,label:e.Process_Name}))],styles:x.MR,isSearchable:!0,placeholder:"Select Process"})})]}),(0,b.jsxs)("div",{className:"px-3 py-2 calendar",children:[(0,b.jsx)("h4",{className:"mb-3 text-center text-primary",children:"task"===X?"Completed Tasks":"Process Timeline (Cumulative)"}),(0,b.jsx)(i.A,{plugins:[h.A,p.A,m.A,u.Ay],initialView:"dayGridMonth",initialDate:new Date,events:"task"===X?y.map(e=>({title:ee(e),start:new Date(null===e||void 0===e?void 0:e.Work_Dt).toISOString().split("T")[0]+"T"+(null===e||void 0===e?void 0:e.Start_Time),end:new Date(null===e||void 0===e?void 0:e.Work_Dt).toISOString().split("T")[0]+"T"+(null===e||void 0===e?void 0:e.End_Time),objectData:e,backgroundColor:ae(e),borderColor:ae(e)})):D.map(e=>({title:ee({Work_Dt:e.date}),start:e.date,allDay:!0,objectData:e,backgroundColor:ae({Work_Dt:e.date}),borderColor:ae({Work_Dt:e.date})})),headerToolbar:{left:"prev next",center:"title",right:"timeGridDay, timeGridWeek, dayGridMonth, listMonth"},slotDuration:"00:20:00",slotMinTime:"08:00:00",slotMaxTime:"22:00:00",showNonCurrentDates:!1,editable:!1,selectMirror:!0,eventClick:e=>{if("task"===X){const a=e.event.extendedProps.objectData;M(a),B(!0)}else{const a=e.event.extendedProps.objectData;R(a),W(""),z(!0)}},dateClick:e=>{if("process"===X){const a=e.dateStr,s=D.find(e=>e.date===a);s&&(R(s),W(""),z(!0))}},datesSet:e=>{U(a=>(0,l.A)((0,l.A)({},a),{},{from:e.startStr.split("T")[0],to:e.endStr.split("T")[0]}))},height:1200})]}),(0,b.jsxs)(o.A,{open:G,maxWidth:"sm",fullWidth:!0,onClose:()=>{B(!1),M({})},children:[(0,b.jsx)(d.A,{className:"fa-18",children:"Task Details"}),(0,b.jsx)(r.A,{className:"pb-0",children:(0,b.jsx)("div",{className:"table-responsive pb-0",children:(0,b.jsx)("table",{className:"table mb-0",children:(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"EmpName"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.EmployeeName})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Task"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.Task_Name})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"ProcessName"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.Process_Name})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Date"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:(null===I||void 0===I?void 0:I.Work_Dt)&&new Date(null===I||void 0===I?void 0:I.Work_Dt).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Start Time"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:(null===I||void 0===I?void 0:I.Start_Time)&&$(null===I||void 0===I?void 0:I.Start_Time)})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"End Time"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:(null===I||void 0===I?void 0:I.End_Time)&&$(null===I||void 0===I?void 0:I.End_Time)})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Duration"}),(0,b.jsxs)("td",{className:"border-1 fa-14",children:[null===I||void 0===I?void 0:I.Tot_Minutes," ( Minutes )"]})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Description"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.Work_Done})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Status"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.WorkStatus})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:"Project"}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===I||void 0===I?void 0:I.Project_Name})]}),(null===I||void 0===I||null===(e=I.Work_Param)||void 0===e?void 0:e.length)>0&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:2,className:"border-1 fa-14 text-center text-uppercase",children:"Parameter Values"})}),null===I||void 0===I||null===(a=I.Work_Param)||void 0===a?void 0:a.map((e,a)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border-1 fa-14",children:null===e||void 0===e?void 0:e.Paramet_Name}),(0,b.jsx)("td",{className:"border-1 fa-14",children:null===e||void 0===e?void 0:e.Current_Value})]},a))]})})})}),(0,b.jsx)(c.A,{children:(0,b.jsx)(n.A,{onClick:()=>{B(!1),M({})},children:"close"})})]}),(0,b.jsxs)(o.A,{open:F,maxWidth:"lg",fullWidth:!0,onClose:()=>{z(!1),R({}),W("")},children:[(0,b.jsxs)(d.A,{className:"fa-18",children:["Process Summary - ",(null===w||void 0===w?void 0:w.date)&&new Date(w.date).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})]}),(0,b.jsxs)(r.A,{className:"pb-0",children:[(0,b.jsxs)("div",{className:"row mb-3",children:[(0,b.jsxs)("div",{className:"col-md-6",children:[(0,b.jsx)("label",{className:"form-label fw-bold",children:"Select Employee:"}),(0,b.jsx)(v.Ay,{value:O?{value:O,label:(null===(s=w.employeeDetails)||void 0===s||null===(N=s[O])||void 0===N?void 0:N.name)||"Unknown Employee"}:{value:"",label:"All Employees"},onChange:e=>W(e.value),options:[{value:"",label:"All Employees"},...(null===(f=w.employeesList)||void 0===f?void 0:f.map(e=>{var a;return{value:e.id,label:"".concat(e.name," (").concat((null===(a=e.tasks)||void 0===a?void 0:a.length)||0," tasks, ").concat(e.totalMinutes||0," mins)")}}))||[]],styles:x.MR,isSearchable:!0,placeholder:"Select Employee"})]}),(0,b.jsx)("div",{className:"col-md-6 d-flex align-items-end",children:(0,b.jsx)("div",{className:"text-muted fa-14",children:O?"Showing tasks for ".concat((null===(k=w.employeeDetails)||void 0===k||null===(g=k[O])||void 0===g?void 0:g.name)||"Unknown"):"Showing all ".concat(w.totalTasks||0," tasks from ").concat(w.employeeCount||0," employees")})})]}),(0,b.jsxs)("div",{className:"row mb-3",children:[(0,b.jsx)("div",{className:"col-md-3",children:(0,b.jsx)("div",{className:"card bg-light",children:(0,b.jsxs)("div",{className:"card-body text-center p-2",children:[(0,b.jsx)("h6",{className:"card-title mb-1",children:"Total Tasks"}),(0,b.jsx)("p",{className:"card-text h4 text-primary mb-0",children:se().length})]})})}),(0,b.jsx)("div",{className:"col-md-3",children:(0,b.jsx)("div",{className:"card bg-light",children:(0,b.jsxs)("div",{className:"card-body text-center p-2",children:[(0,b.jsx)("h6",{className:"card-title mb-1",children:"Total Duration"}),(0,b.jsx)("p",{className:"card-text h4 text-success mb-0",children:function(e){const a=Math.floor(e/60),s=e%60;return a>0?"".concat(a,"h ").concat(s,"m"):"".concat(s,"m")}(le)})]})})}),(0,b.jsx)("div",{className:"col-md-3",children:(0,b.jsx)("div",{className:"card bg-light",children:(0,b.jsxs)("div",{className:"card-body text-center p-2",children:[(0,b.jsx)("h6",{className:"card-title mb-1",children:"Processes"}),(0,b.jsx)("p",{className:"card-text h4 text-info mb-0",children:[...new Set(se().map(e=>e.Process_Name))].length})]})})}),(0,b.jsx)("div",{className:"col-md-3",children:(0,b.jsx)("div",{className:"card bg-light",children:(0,b.jsxs)("div",{className:"card-body text-center p-2",children:[(0,b.jsx)("h6",{className:"card-title mb-1",children:"Projects"}),(0,b.jsx)("p",{className:"card-text h4 text-warning mb-0",children:[...new Set(se().map(e=>e.Project_Name))].length})]})})})]}),(0,b.jsx)("div",{className:"table-responsive pb-0",children:(0,b.jsxs)("table",{className:"table table-bordered mb-0",children:[(0,b.jsx)("thead",{className:"bg-light",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"fa-14",children:"#"}),(0,b.jsx)("th",{className:"fa-14",children:"Employee"}),(0,b.jsx)("th",{className:"fa-14",children:"Task"}),(0,b.jsx)("th",{className:"fa-14",children:"Process"}),(0,b.jsx)("th",{className:"fa-14",children:"Time"}),(0,b.jsx)("th",{className:"fa-14",children:"Duration"}),(0,b.jsx)("th",{className:"fa-14",children:"Description"}),(0,b.jsx)("th",{className:"fa-14",children:"Project"})]})}),(0,b.jsx)("tbody",{children:0===se().length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"8",className:"text-center fa-14 py-3",children:"No tasks found for the selected criteria"})}):se().map((e,a)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"fa-13",children:a+1}),(0,b.jsx)("td",{className:"fa-13",children:e.EmployeeName}),(0,b.jsx)("td",{className:"fa-13",children:e.Task_Name}),(0,b.jsx)("td",{className:"fa-13",children:e.Process_Name}),(0,b.jsxs)("td",{className:"fa-13",children:[e.Start_Time&&$(e.Start_Time)," - ",e.End_Time&&$(e.End_Time)]}),(0,b.jsxs)("td",{className:"fa-13",children:[e.Tot_Minutes," mins"]}),(0,b.jsx)("td",{className:"fa-13",children:e.Work_Done}),(0,b.jsx)("td",{className:"fa-13",children:e.Project_Name})]},a))})]})})]}),(0,b.jsx)(c.A,{children:(0,b.jsx)(n.A,{onClick:()=>{z(!1),R({}),W("")},children:"close"})})]})]})}}}]);
//# sourceMappingURL=1667.4c3050ac.chunk.js.map