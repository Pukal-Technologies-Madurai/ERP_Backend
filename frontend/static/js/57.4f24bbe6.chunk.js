"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[57],{4054(e,a,l){l.r(a),l.d(a,{default:()=>g});var t=l(89379),r=l(65043),s=l(65074),n=l(12110),d=l(11906),o=l(26494),i=l(17392),c=l(83462),m=l(26600),_=l(35316),u=l(29347),p=l(97707),h=l(7204),v=l(63406),x=l(33438),N=l(51387),A=l(79484),f=l(48471);const I={Trip_Id:"",Challan_No:"",Branch_Id:"",Trip_Date:(0,p.ny)(),Vehicle_No:"",StartTime:"",EndTime:"",Trip_No:"",Trip_ST_KM:"",Trip_EN_KM:"",Trip_Tot_Kms:"",Created_By:"",Updated_By:"",DO_Date:(0,p.ny)(),Delivery_Person_Id:"",BillType:"",VoucherType:""},j={Id:"",Trip_Id:"",Involved_Emp_Id:"",Cost_Center_Type_Id:"",Emp_Name:""};var C=l(91036),y=l(73216),b=(l(80287),l(70579));const g=e=>{let{loadingOn:a,loadingOff:l}=e;const g=(0,y.zy)().state,[T,S]=(0,r.useState)(null),E=JSON.parse(localStorage.getItem("user")),[D,L]=(0,r.useState)([]),[P,w]=(0,r.useState)({Retailer_Id:"",RetailerGet:"ALL",Created_by:"",CreatedByGet:"ALL",Sales_Person_Id:"",SalsePersonGet:"ALL",Cancel_status:0,Route_Id:"",RoutesGet:"ALL",Area_Id:"",AreaGet:"ALL",Fromdate:(0,p.ny)(),Todate:(0,p.ny)(),VoucherType:[],Broker:[],Transporters:[],Loadman:[],Item:[],Godown:"",search:!1,addItemDialog:!1,Retailer:[]}),[R,B]=(0,r.useState)([]),[M,O]=(0,r.useState)([]),[k,G]=(0,r.useState)([]),[V,F]=(0,r.useState)([]),[U,z]=(0,r.useState)(I),[K,H]=(0,r.useState)([]),[Q,W]=(0,r.useState)([]),[J,q]=(0,r.useState)([]),[Z,X]=(0,r.useState)([]),[Y,$]=(0,r.useState)([]),[ee,ae]=(0,r.useState)([]),[le,te]=(0,r.useState)([]),[re,se]=(0,r.useState)([]),[ne,de]=(0,r.useState)([]),[oe,ie]=(0,r.useState)(!1),[ce,me]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{const[e,a,l,t,r,n,d]=await Promise.all([(0,s.z)({address:"masters/branch/dropDown"}),(0,s.z)({address:"dataEntry/costCenter"}),(0,s.z)({address:"dataEntry/costCenter/category"}),(0,s.z)({address:"masters/voucher"}),(0,s.z)({address:"masters/products/dropDown"}),(0,s.z)({address:"masters/godown"}),(0,s.z)({address:"masters/retailers/dropDown"})]),o=(e.success?e.data:[]).sort((e,a)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===a||void 0===a?void 0:a.BranchName)),i=(a.success?a.data:[]).sort((e,a)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===a||void 0===a?void 0:a.Cost_Center_Name)),c=(l.success?l.data:[]).sort((e,a)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===a||void 0===a?void 0:a.Cost_Category)),m=i.filter(e=>"Broker"===e.UserTypeGet),_=i.filter(e=>"Transport"===e.UserTypeGet),u=i.filter(e=>"Load Man"===e.UserTypeGet),p=t.success?t.data:[],h=r.success?r.data:[],v=n.success?n.data:[],x=d.success?d.data:[];q(p),F(o),O(i),G(c),X(m),ae(_),se(v),te(h),de(x),$(u)}catch(e){console.error("Error fetching data:",e)}})()},[]);const _e=[{value:"",label:"ALL"},...J.filter(e=>"SALES"===e.Type).map(e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type}))];J.filter(e=>"SALES"===e.Type).map(e=>({value:null===e||void 0===e?void 0:e.Voucher_Type,label:null===e||void 0===e?void 0:e.Voucher_Type}));(0,r.useEffect)(()=>{(0,s.z)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===E||void 0===E?void 0:E.Company_id)}).then(e=>{e.success&&L(e.data)}).catch(e=>console.error(e))},[]),(0,r.useEffect)(()=>{const e=e=>{const a=new Date(e),l=a.getHours(),t=a.getMinutes();return"".concat(l<10?"0"+l:l,":").concat(t<10?"0"+t:t)},a=null===g||void 0===g?void 0:g.Product_Array,l=null===g||void 0===g?void 0:g.Employees_Involved;if((0,p.aF)(g)){if(ie(!0),z(a=>(0,t.A)((0,t.A)((0,t.A)({},a),Object.fromEntries(Object.entries(I).map(a=>{var l,t;let[r,s]=a;return"Trip_Date"===r?[r,g[r]?(0,p.ny)(g[r]):s]:"Branch_Id"===r?[r,null!==(l=g[r])&&void 0!==l?l:s]:"StartTime"===r||"EndTime"===r?[r,g[r]?e(g[r]):s]:[r,null!==(t=g[r])&&void 0!==t?t:s]}))),{},{Trip_Id:g.Trip_Id||"",Challan_No:g.Challan_No||"",Vehicle_No:g.Vehicle_No||"",Trip_No:g.Trip_No||"",TripStatus:g.TripStatus||"New",Trip_ST_KM:g.Trip_ST_KM||"0",Trip_EN_KM:g.Trip_EN_KM||"0",Trip_Tot_Kms:g.Trip_Tot_Kms||"0",TR_INV_ID:g.TR_INV_ID||"",BillType:g.BillType||"SALES",VoucherType:g.VoucherType||0,DO_Date:g.DO_Date||""})),Array.isArray(a)&&a.length>0&&W(a),Array.isArray(l)&&l.length>0){H(l.map(e=>Object.fromEntries(Object.entries(j).map(a=>{var l;let[t,r]=a;return[t,null!==(l=e[t])&&void 0!==l?l:r]}))));const e=l.find(e=>9===Number(e.Cost_Center_Type_Id));S(e?{UserId:e.Involved_Emp_Id,Name:e.Emp_Name}:null)}me(!0)}else ie(!1),me(!0)},[g]),(0,r.useEffect)(()=>{if(!ce)return;if(0===Q.length)return void(oe||(H([]),S(null)));const e=[];Q.forEach(a=>{a.All_Staff_Details&&Array.isArray(a.All_Staff_Details)&&a.All_Staff_Details.forEach(l=>{e.push({Emp_Id:l.Emp_Id,Staff_Name:l.Staff_Name,Cost_Category:l.Cost_Category,Cost_Category_Id:l.Cost_Category_Id,Emp_Type_Id:l.Emp_Type_Id,Do_Id:a.Do_Id})})});const a=Array.from(new Map(e.map(e=>[e.Emp_Id,e])).values()),l=a.map(e=>(0,t.A)({Involved_Emp_Id:e.Emp_Id,Emp_Name:e.Staff_Name,Cost_Center_Type_Id:e.Cost_Category_Id||e.Emp_Type_Id||0,Staff_Type:e.Cost_Category||"",Do_Id:e.Do_Id},Object.fromEntries(Object.entries(j).map(a=>{let[l,t]=a;return"Involved_Emp_Id"===l?[l,e.Emp_Id]:"Emp_Name"===l?[l,e.Staff_Name]:"Cost_Center_Type_Id"===l?[l,e.Cost_Category_Id||e.Emp_Type_Id||0]:"Staff_Type"===l?[l,e.Cost_Category||""]:[l,t]}))));if(oe){const e=new Map;K.forEach(a=>{e.set(Number(a.Involved_Emp_Id),a)});const t=new Map;l.forEach(e=>{t.set(Number(e.Involved_Emp_Id),e)});const r=[];K.forEach(e=>{r.push(e)}),l.forEach(e=>{K.some(a=>Number(a.Involved_Emp_Id)===Number(e.Involved_Emp_Id))||r.push(e)}),H(r);const s=a.find(e=>9===Number(e.Cost_Category_Id)||9===Number(e.Emp_Type_Id));s&&!T&&S({UserId:s.Emp_Id,Name:s.Staff_Name})}else{H(l);const e=a.find(e=>9===Number(e.Cost_Category_Id)||9===Number(e.Emp_Type_Id));S(e?{UserId:e.Emp_Id,Name:e.Staff_Name}:null)}},[Q,oe,ce]);const ue=e=>{let{value:a,onChange:l,options:r,placeholder:s,isSearchable:n=!0}=e;return(0,b.jsx)(h.Ay,{isMulti:!0,value:a,onChange:l,options:r,placeholder:s,styles:(0,t.A)((0,t.A)({},v.MR),{},{menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999})}),isSearchable:n,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})},pe=()=>{a&&a(),(0,s.z)({address:"delivery/deliveryOrderTrip",method:(0,p.IQ)(null===U||void 0===U?void 0:U.Trip_Id)?"PUT":"POST",bodyData:(0,t.A)((0,t.A)({},U),{},{StartTime:U.StartTime&&U.Trip_Date?(0,p.vW)(U.Trip_Date,U.StartTime):"",EndTime:U.EndTime&&U.Trip_Date?(0,p.vW)(U.Trip_Date,U.EndTime):"",Product_Array:Q,Delivery_Person_Id:null===T||void 0===T?void 0:T.UserId,EmployeesInvolved:K.filter(e=>(0,p.IQ)(e.Involved_Emp_Id)&&(0,p.IQ)(e.Cost_Center_Type_Id))})}).then(e=>{e.success?(W([]),H([]),z(I),B([]),S(null),C.oR.success(e.message)):C.oR.error(e.message)}).catch(e=>console.log(e)).finally(()=>{l&&l()})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(n.A,{children:[(0,b.jsxs)("div",{className:"d-flex flex-wrap align-items-center border-bottom p-2",children:[(0,b.jsx)("h5",{className:"flex-grow-1 m-0 ps-2",children:"Trip Sheet Creation"}),(0,b.jsx)(d.A,{variant:"outlined",onClick:pe,disabled:0===Q.length||!(0,p.vd)(U.Trip_Date),children:"Save"})]}),(0,b.jsxs)(o.A,{style:{minHeight:500},children:[(0,b.jsxs)("div",{className:"row ",children:[(0,b.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,b.jsxs)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:[(0,b.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,b.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,b.jsx)(d.A,{variant:"outlined",color:"secondary",className:"me-2",onClick:()=>{if(oe){const e=K.filter(e=>!e.Do_Id);H(e),T&&T.Do_Id&&S(null)}else H([]),S(null)},disabled:0===K.length,children:"Clear All"}),(0,b.jsx)(d.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>H([...K,(0,t.A)({},j)]),children:"Add Manually"})]}),(0,b.jsxs)("table",{className:"table table-bordered",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"fa-13",children:"Sno"}),(0,b.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,b.jsx)("th",{className:"fa-13",children:"Category"}),(0,b.jsx)("th",{className:"fa-13",children:"Action"})]})}),(0,b.jsx)("tbody",{children:K.map((e,a)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"fa-13 vctr text-center",children:a+1}),(0,b.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,b.jsx)(h.Ay,{value:{value:null===e||void 0===e?void 0:e.Involved_Emp_Id,label:null===e||void 0===e?void 0:e.Emp_Name},onChange:e=>{H(l=>l.map((l,r)=>{if((0,p.id)(r,a)){var s;const a=M.find(a=>(0,p.id)(a.Cost_Center_Id,e.value)),r=(0,t.A)((0,t.A)({},l),{},{Cost_Center_Type_Id:l.Cost_Center_Type_Id||a.User_Type||0,Involved_Emp_Id:e.value,Emp_Name:null!==(s=a.Cost_Center_Name)&&void 0!==s?s:""});return 9===Number(r.Cost_Center_Type_Id)?S({UserId:r.Involved_Emp_Id,Name:r.Emp_Name}):(null===T||void 0===T?void 0:T.UserId)===r.Involved_Emp_Id&&S(null),r}return l}))},options:M.filter(e=>-1===K.findIndex(a=>(0,p.id)(a.Involved_Emp_Id,e.Cost_Center_Id))).map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:v.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,b.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"110px"},children:(0,b.jsxs)("select",{value:null===e||void 0===e?void 0:e.Cost_Center_Type_Id,onChange:e=>((e,a)=>{H(l=>l.map((l,r)=>{if((0,p.id)(r,a)){const a=(0,t.A)((0,t.A)({},l),{},{Cost_Center_Type_Id:e.target.value});return 9===Number(a.Cost_Center_Type_Id)?S({UserId:a.Involved_Emp_Id,Name:a.Emp_Name}):(null===T||void 0===T?void 0:T.UserId)===a.Involved_Emp_Id&&S(null),a}return l}))})(e,a),className:"cus-inpt p-2",children:[(0,b.jsx)("option",{value:"",children:"Select"}),k.map((e,a)=>(0,b.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},a))]})}),(0,b.jsx)("td",{className:"fa-13 vctr text-center",children:(0,b.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>{H(l=>{const t=l.filter((e,l)=>l!==a);return(null===T||void 0===T?void 0:T.UserId)===e.Involved_Emp_Id&&S(null),t})},children:(0,b.jsx)(x.A,{})})})]},a))})]})]})}),(0,b.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,b.jsxs)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsxs)("label",{children:["Branch ",(0,b.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,b.jsxs)("select",{value:U.Branch_Id,onChange:e=>z((0,t.A)((0,t.A)({},U),{},{Branch_Id:e.target.value})),placeholder:"Select Branch",className:"cus-inpt mb-2 p-2",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"Select Branch"}),V.map((e,a)=>(0,b.jsx)("option",{value:e.BranchId,children:e.BranchName},a))]})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{children:"Trip_Date"}),(0,b.jsx)("input",{value:U.Trip_Date,type:"date",onChange:e=>z((0,t.A)((0,t.A)({},U),{},{Trip_Date:e.target.value})),className:"cus-inpt p-2 mb-2"})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{children:"Vehicle No"}),(0,b.jsx)("input",{value:U.Vehicle_No,onChange:e=>z((0,t.A)((0,t.A)({},U),{},{Vehicle_No:e.target.value})),className:"cus-inpt p-2 mb-2"})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-6 col-sm-12 p-2",children:[(0,b.jsxs)("label",{children:["Delivery Person ",(0,b.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,b.jsx)("input",{id:"delivery-person",name:"deliveryPerson",type:"text",value:T?T.Name:"",readOnly:!0,className:"form-control",placeholder:"Delivery Person"})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{children:"Trip No"}),(0,b.jsx)("input",{value:U.Trip_No,onChange:e=>z((0,t.A)((0,t.A)({},U),{},{Trip_No:e.target.value})),className:"cus-inpt p-2 mb-2"})]}),(0,b.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,b.jsx)("label",{children:"Trip Status"}),(0,b.jsxs)("select",{value:(null===U||void 0===U?void 0:U.TripStatus)||"",onChange:e=>z(a=>(0,t.A)((0,t.A)({},a),{},{TripStatus:e.target.value})),className:"cus-inpt p-2",children:[(0,b.jsx)("option",{value:"",children:"Select"}),(0,b.jsx)("option",{value:"New",children:"New"}),(0,b.jsx)("option",{value:"OnProcess",children:"OnProcess"}),(0,b.jsx)("option",{value:"Completed",children:"Completed"}),(0,b.jsx)("option",{value:"Canceled",children:"Canceled"})]})]})]}),(0,b.jsx)("div",{className:"table-responsive",children:(0,b.jsxs)("table",{className:"table table-bordered",children:[(0,b.jsxs)("thead",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{colSpan:2,className:"fa-13 text-center",children:"Time"}),(0,b.jsx)("th",{colSpan:2,className:"fa-13 text-center",children:"Distance"})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"fa-13 text-center",children:"Start "}),(0,b.jsx)("th",{className:"fa-13 text-center",children:"End"}),(0,b.jsx)("th",{className:"fa-13 text-center",children:"Start (Km)"}),(0,b.jsx)("th",{className:"fa-13 text-center",children:"End (Km)"})]})]}),(0,b.jsx)("tbody",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"fa-13",children:(0,b.jsx)("input",{type:"time",onChange:e=>z(a=>(0,t.A)((0,t.A)({},a),{},{StartTime:e.target.value})),value:null===U||void 0===U?void 0:U.StartTime,className:"cus-inpt p-2"})}),(0,b.jsx)("td",{className:"fa-13",children:(0,b.jsx)("input",{type:"time",onChange:e=>z(a=>(0,t.A)((0,t.A)({},a),{},{EndTime:e.target.value})),value:null===U||void 0===U?void 0:U.EndTime,className:"cus-inpt p-2"})}),(0,b.jsx)("td",{className:"fa-13",children:(0,b.jsx)("input",{type:"number",onChange:e=>z(a=>{var l,r;return(0,t.A)((0,t.A)({},a),{},{Trip_ST_KM:e.target.value,Trip_Tot_Kms:(0,p.DG)(null!==(l=a.Trip_EN_KM)&&void 0!==l?l:0,null!==(r=e.target.value)&&void 0!==r?r:0)})}),value:null===U||void 0===U?void 0:U.Trip_ST_KM,min:0,className:"cus-inpt p-2",placeholder:"Kilometers"})}),(0,b.jsx)("td",{className:"fa-13",children:(0,b.jsx)("input",{type:"number",onChange:e=>z(a=>{var l,r;return(0,t.A)((0,t.A)({},a),{},{Trip_EN_KM:e.target.value,Trip_Tot_Kms:(0,p.DG)(null!==(l=e.target.value)&&void 0!==l?l:0,null!==(r=a.Trip_ST_KM)&&void 0!==r?r:0)})}),value:null===U||void 0===U?void 0:U.Trip_EN_KM,min:(0,p.Lr)(null===U||void 0===U?void 0:U.Trip_ST_KM,1),className:"cus-inpt p-2",placeholder:"Kilometers"})})]})})]})})]})})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,b.jsxs)("h6",{className:"m-0 text-muted",children:["Total Bill Qty: ",null===Q||void 0===Q?void 0:Q.reduce((e,a)=>{var l;return e+((null===a||void 0===a||null===(l=a.Products_List)||void 0===l?void 0:l.reduce((e,a)=>e+(parseFloat(null===a||void 0===a?void 0:a.Bill_Qty)||0),0))||0)},0)]}),(0,b.jsxs)("h6",{className:"m-0 text-muted",children:["Selected Sales Orders: ",Q.length]}),(0,b.jsxs)("h6",{className:"m-0 text-muted",children:["Total Items: ",null===Q||void 0===Q?void 0:Q.reduce((e,a)=>{var l;return e+((null===(l=a.Products_List)||void 0===l?void 0:l.length)||0)},0)]})]}),(0,b.jsx)(f.Ay,{dataArray:null===Q||void 0===Q?void 0:Q.map(e=>null===e||void 0===e?void 0:e.Products_List).flat(),expandableComp:e=>{let{row:a}=e;return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("table",{className:"table",children:(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,b.jsx)("td",{className:"border p-2",children:a.Branch_Name}),(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,b.jsx)("td",{className:"border p-2",children:a.Sales_Person_Name}),(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,b.jsx)("td",{className:"border p-2",children:a.Round_off})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,b.jsxs)("td",{className:"border p-2",children:[(0,p.id)(a.GST_Inclusive,1)&&"Inclusive",(0,p.id)(a.GST_Inclusive,0)&&"Exclusive"]}),(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,b.jsxs)("td",{className:"border p-2",children:[(0,p.id)(a.IS_IGST,1)&&"IGST",(0,p.id)(a.IS_IGST,0)&&"GST"]}),(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,b.jsx)("td",{className:"border p-2",children:a.Sales_Person_Name})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,b.jsx)("td",{className:"border p-2",colSpan:5,children:a.Narration})]})]})})})},ButtonArea:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.A,{onClick:()=>w(e=>(0,t.A)((0,t.A)({},e),{},{addItemDialog:!0})),children:"Add"}),(0,b.jsx)(d.A,{onClick:()=>W([]),className:"me-2",children:"Clear"})]}),EnableSerialNumber:!0,disablePagination:!0,maxHeightOption:!0,columns:[(0,f.Lj)("Do_Inv_No","string","Do_Inv_No"),(0,f.Lj)("Retailer_Name","string","Retailer_Name"),(0,f.Lj)("Transporter_Name","string","Transporter"),(0,f.Lj)("Product_Name","string","Product_Name"),(0,f.Lj)("Taxable_Rate","number","Rate"),(0,f.Lj)("Bill_Qty","number","Bill_Qty"),(0,f.Lj)("Taxable_Amount","string","Before_Tax_Amount"),(0,f.Lj)("Amount","number","Total_Invoice_value"),{isVisible:1,ColumnHeader:"#",isCustomCell:!0,Cell:e=>{let{row:a}=e;return(0,b.jsx)(i.A,{variant:"contained",color:"error",size:"small",onClick:()=>{const e=null===Q||void 0===Q?void 0:Q.map(e=>(0,t.A)((0,t.A)({},e),{},{Products_List:e.Products_List.filter(e=>e[a.DO_St_Id?"DO_St_Id":"SO_St_Id"]!==a[a.DO_St_Id?"DO_St_Id":"SO_St_Id"])})).filter(e=>e.Products_List.length>0);W(e)},children:(0,b.jsx)(N.A,{className:"fa-20"})})}}]})]}),(0,b.jsx)("div",{className:"border-top p-2 text-end",children:(0,b.jsx)(d.A,{variant:"outlined",onClick:pe,disabled:0===Q.length||!(0,p.vd)(U.Trip_Date),children:"Save"})})]}),(0,b.jsx)(c.A,{open:P.addItemDialog,onClose:()=>w(e=>(0,t.A)((0,t.A)({},e),{},{addItemDialog:!1})),maxWidth:"lg",fullWidth:!0,fullScreen:!0,children:(0,b.jsxs)("form",{onSubmit:e=>{e.preventDefault();const{Fromdate:t,Todate:r,Sales_Person_Id:n,Broker:d,Transporters:o,Loadman:i,Godown:c,Item:m,Retailer:_,VoucherType:u}=P,p=Array.isArray(u)?u.join(","):u||"",h=Array.isArray(d)?d.join(","):d||"",v=Array.isArray(o)?o.join(","):o||"",x=Array.isArray(i)?i.join(","):i||"",N=Array.isArray(m)?m.join(","):m||"",A=Array.isArray(_)?_.join(","):_||"",f=(null===P||void 0===P?void 0:P.Branch)||"";t&&r&&(a&&a(),B([]),(0,s.z)({address:"delivery/deliveryDetailsList?Fromdate=".concat(t,"&Todate=").concat(r,"&Sales_Person_Id=").concat(n,"&VoucherType=").concat(p,"&Branch=").concat(f,"\n                &Broker=").concat(h,"&Transporter=").concat(v,"&Loadman=").concat(x,"&Godown=").concat(c,"&Item=").concat(N,"&Retailer=").concat(A)}).then(e=>{e.success&&B(e.data)}).catch(e=>console.log(e)).finally(()=>{l&&l()}))},children:[(0,b.jsxs)(m.A,{className:"d-flex align-items-center",children:[(0,b.jsx)("span",{className:"flex-grow-1",children:"Add Data"}),(0,b.jsx)(d.A,{variant:"outlined",type:"submit",className:"me-2",startIcon:(0,b.jsx)(A.A,{}),children:"Search"}),(0,b.jsx)(i.A,{size:"small",color:"error",onClick:()=>w(e=>(0,t.A)((0,t.A)({},e),{},{addItemDialog:!1})),children:(0,b.jsx)(x.A,{})})]}),(0,b.jsxs)(_.A,{children:[(0,b.jsx)("div",{className:"table-responsive",children:(0,b.jsx)("table",{className:"table table-bordered",children:(0,b.jsxs)("tbody",{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"From Date"}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"date",value:P.Fromdate,className:"cus-inpt p-2",required:!0,max:P.Todate,onChange:e=>w(a=>(0,t.A)((0,t.A)({},a),{},{Fromdate:e.target.value})),style:{width:"100%"}})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"To Date"}),(0,b.jsx)("td",{children:(0,b.jsx)("input",{type:"date",value:P.Todate,className:"cus-inpt p-2",min:P.Fromdate,required:!0,onChange:e=>w(a=>(0,t.A)((0,t.A)({},a),{},{Todate:e.target.value})),style:{width:"100%"}})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Sales Person"}),(0,b.jsx)("td",{children:(0,b.jsx)(h.Ay,{value:{value:null===P||void 0===P?void 0:P.Sales_Person_Id,label:(null===P||void 0===P?void 0:P.Sales_Person_Name)||"ALL"},onChange:e=>{w((0,t.A)((0,t.A)({},P),{},{Sales_Person_Id:e.value,Sales_Person_Name:e.label}))},options:[{value:"",label:"ALL"},...D.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],placeholder:"Select Sales Person",styles:{menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999})},isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Voucher Type"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.VoucherType||[]).map(e=>{var a;return{value:e,label:(null===(a=_e.find(a=>a.value===e))||void 0===a?void 0:a.label)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{VoucherType:e?e.map(e=>e.value):[]})),options:_e,placeholder:"Select Voucher Types"})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Branch"}),(0,b.jsx)("td",{children:(0,b.jsx)(h.Ay,{value:{value:null===P||void 0===P?void 0:P.Branch,label:(null===P||void 0===P?void 0:P.BranchName)||"ALL"},onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Branch:e.value,BranchName:e.label})),options:[{value:"",label:"ALL"},...V.map(e=>({value:e.BranchId,label:e.BranchName}))],placeholder:"Select Branch",styles:{menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999})},isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Broker"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.Broker||[]).map(e=>{var a;return{value:e,label:(null===(a=Z.find(a=>a.Cost_Center_Id===e))||void 0===a?void 0:a.Cost_Center_Name)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Broker:e?e.map(e=>e.value):[]})),options:Z.map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),placeholder:"Select Brokers"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Transporter"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.Transporters||[]).map(e=>{var a;return{value:e,label:(null===(a=ee.find(a=>a.Cost_Center_Id===e))||void 0===a?void 0:a.Cost_Center_Name)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Transporters:e?e.map(e=>e.value):[]})),options:ee.map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),placeholder:"Select Transporters"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Godown"}),(0,b.jsx)("td",{children:(0,b.jsx)(h.Ay,{value:{value:null===P||void 0===P?void 0:P.Godown,label:(null===P||void 0===P?void 0:P.GodownName)||"ALL"},onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Godown:e.value,GodownName:e.label})),options:[{value:"",label:"ALL"},...re.map(e=>({value:e.Godown_Id,label:e.Godown_Name}))],placeholder:"Select Godown",styles:{menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999})},isSearchable:!0,menuPortalTarget:document.body,menuPosition:"fixed",menuPlacement:"auto"})})]}),(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Retailers"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.Retailer||[]).map(e=>{var a;return{value:e,label:(null===(a=ne.find(a=>a.Retailer_Id===e))||void 0===a?void 0:a.Retailer_Name)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Retailer:e?e.map(e=>e.value):[]})),options:ne.map(e=>({value:e.Retailer_Id,label:e.Retailer_Name})),placeholder:"Select Retailers"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Products"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.Item||[]).map(e=>{var a;return{value:e,label:(null===(a=le.find(a=>a.Product_Id===e))||void 0===a?void 0:a.Product_Name)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Item:e?e.map(e=>e.value):[]})),options:le.map(e=>({value:e.Product_Id,label:e.Product_Name})),placeholder:"Select Products"})}),(0,b.jsx)("td",{style:{verticalAlign:"middle"},className:"fa-13 fw-bold",children:"Loadman"}),(0,b.jsx)("td",{children:(0,b.jsx)(ue,{value:(P.Loadman||[]).map(e=>{var a;return{value:e,label:(null===(a=Y.find(a=>a.Cost_Center_Id===e))||void 0===a?void 0:a.Cost_Center_Name)||e}}),onChange:e=>w((0,t.A)((0,t.A)({},P),{},{Loadman:e?e.map(e=>e.value):[]})),options:Y.map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),placeholder:"Select Loadman"})})]})]})})}),(0,b.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.A,{variant:"outlined",onClick:()=>{Q.length===R.length?W([]):W(R)},disabled:0===R.length,children:Q.length===R.length?"Unselect All Orders":"Select All Orders"}),(0,b.jsx)(d.A,{variant:"outlined",onClick:()=>{if(0===R.length)return;const e=[];R.forEach(a=>{a.All_Staff_Details&&Array.isArray(a.All_Staff_Details)&&a.All_Staff_Details.forEach(l=>{e.push({Emp_Id:l.Emp_Id,Staff_Name:l.Staff_Name,Cost_Category_Id:l.Cost_Category_Id,Emp_Type_Id:l.Emp_Type_Id,Cost_Category:l.Cost_Category,Do_Id:a.Do_Id})})});const a=Array.from(new Map(e.map(e=>[e.Emp_Id,e])).values()),l=a.map(e=>(0,t.A)({Involved_Emp_Id:e.Emp_Id,Emp_Name:e.Staff_Name,Cost_Center_Type_Id:e.Cost_Category_Id||e.Emp_Type_Id||0,Do_Id:e.Do_Id},Object.fromEntries(Object.entries(j).map(a=>{let[l,t]=a;return"Involved_Emp_Id"===l?[l,e.Emp_Id]:"Emp_Name"===l?[l,e.Staff_Name]:"Cost_Center_Type_Id"===l?[l,e.Cost_Category_Id||e.Emp_Type_Id||0]:"Staff_Type"===l?[l,e.Cost_Category]:[l,t]}))));if(oe){const e=new Map;K.forEach(a=>{e.set(Number(a.Involved_Emp_Id),a)});const a=[...K];l.forEach(e=>{K.some(a=>Number(a.Involved_Emp_Id)===Number(e.Involved_Emp_Id))||a.push(e)}),H(a)}else H(l);const r=a.find(e=>9===Number(e.Cost_Category_Id)||9===Number(e.Emp_Type_Id));r&&!T&&S({UserId:r.Emp_Id,Name:r.Staff_Name})},disabled:0===R.length,className:"ms-2",children:"Add All Staff from Results"})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-end gap-3",children:[(0,b.jsxs)("h6",{className:"m-0 text-muted",children:["Orders: ",Q.length,"/",R.length]}),(0,b.jsxs)("h6",{className:"m-0 text-muted",children:["Unique Staff: ",(()=>{const e=Q.flatMap(e=>{var a;return(null===(a=e.All_Staff_Details)||void 0===a?void 0:a.map(e=>e.Emp_Id))||[]});return new Set(e).size})()]})]})]}),(0,b.jsx)(f.Ay,{dataArray:R,disablePagination:!0,maxHeightOption:!0,columns:[{Field_Name:"checkbox",ColumnHeader:"",isVisible:1,pointer:!0,isCustomCell:!0,Cell:e=>{let{row:a}=e;return(0,b.jsx)("input",{type:"checkbox",checked:Q.some(e=>e.Do_Id===a.Do_Id),onChange:()=>(e=>{W(a=>{let l;return l=a.some(a=>a.Do_Id==e.Do_Id)?a.filter(a=>a.Do_Id!=e.Do_Id):[...a,e],l})})(a),onFocus:e=>{e.target.blur()},style:{cursor:"pointer",transform:"scale(1.5)",width:"14px",height:"20px"}})}},(0,f.Lj)("Do_Inv_No","string","Do_Inv_No"),(0,f.Lj)("Retailer_Name","string","Retailer_Name"),(0,f.Lj)("Branch_Name","string","Branch_Name"),(0,f.Lj)("AreaName","string","AreaName"),(0,f.Lj)("Transporter_Name","string","Transporter_Name"),(0,f.Lj)("Do_Date","date","Do_Date"),(0,f.Lj)("Total_Before_Tax","string","Total_Before_Tax"),(0,f.Lj)("Total_Tax","number","Total_Tax"),(0,f.Lj)("Total_Invoice_value","number","Total_Invoice_value")]})]}),(0,b.jsx)(u.A,{children:(0,b.jsx)(d.A,{type:"button",onClick:()=>w(e=>(0,t.A)((0,t.A)({},e),{},{addItemDialog:!1})),children:"close"})})]})})]})}},26494(e,a,l){l.d(a,{A:()=>v});var t=l(58168),r=l(98587),s=l(65043),n=l(58387),d=l(98610),o=l(34535),i=l(6431),c=l(92532),m=l(72372);function _(e){return(0,m.Ay)("MuiCardContent",e)}(0,c.A)("MuiCardContent",["root"]);var u=l(70579);const p=["className","component"],h=(0,o.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),v=s.forwardRef(function(e,a){const l=(0,i.b)({props:e,name:"MuiCardContent"}),{className:s,component:o="div"}=l,c=(0,r.A)(l,p),m=(0,t.A)({},l,{component:o}),v=(e=>{const{classes:a}=e;return(0,d.A)({root:["root"]},_,a)})(m);return(0,u.jsx)(h,(0,t.A)({as:o,className:(0,n.A)(v.root,s),ownerState:m,ref:a},c))})},33438(e,a,l){l.d(a,{A:()=>s});var t=l(59662),r=l(70579);const s=(0,t.A)((0,r.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},63406(e,a,l){l.d(a,{zU:()=>d,ex:()=>o,MR:()=>n,Ap:()=>s,FX:()=>i});var t=l(89379);const r=l.p+"static/media/smt.aa4d4f940bbebff07a57.png",s={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},n={menu:(e,a)=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999}),menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999}),groupHeading:e=>(0,t.A)((0,t.A)({},e),{},{backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold",fontSize:"14px",padding:"8px 12px",borderBottom:"1px solid #ddd",textTransform:"uppercase"}),option:(e,a)=>(0,t.A)((0,t.A)({},e),{},{backgroundColor:a.isSelected?"#2684FF":a.isFocused?"#E2ECF9":"white",color:a.isSelected?"white":"#333",padding:"10px 12px"})},d=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],o=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:r,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:r,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:r,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}],i=[{name:"PURCHASE_ORDER"},{name:"PURCHASE_INVOICE"},{name:"SALE_ORDER"},{name:"SALE_INVOICE"},{name:"JOURNAL"},{name:"STOCK_JOURNAL"},{name:"PAYMENT"},{name:"RECEIPT"},{name:"CONTRA"}]}}]);
//# sourceMappingURL=57.4f24bbe6.chunk.js.map