"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[3671],{33671(e,l,n){n.r(l),n.d(l,{default:()=>J});var o=n(89379),i=n(80045),a=n(65043),t=n(81e3),r=n(85865),d=n(17392),s=n(41020),u=n(30922),c=n(32143),v=n(2050),m=n(48734),p=n(12110),x=n(11906),h=n(26494),A=n(83462),j=n(26600),b=n(35316),C=n(29347),f=n(29013),g=n(24056),N=n(38463),_=n(33438),y=n(51387),T=n(83560),S=n(59383),D=n(76447),w=n(18124),F=n(3632),I=n(97707),R=n(45777),k=n(73216),L=n(79773),E=n(91036),B=n(65074),O=n(48471),z=n(70579);const H=["children","value","index"],V=e=>{const{children:l,value:n,index:a}=e,d=(0,i.A)(e,H);return(0,z.jsx)("div",(0,o.A)((0,o.A)({role:"tabpanel",hidden:n!==a,id:"tabpanel-".concat(a),"aria-labelledby":"tab-".concat(a)},d),{},{children:n===a&&(0,z.jsx)(t.A,{p:3,children:(0,z.jsx)(r.A,{children:l})})}))},J=()=>{var e,l,n,i,t,r,H,J,K,M;const W=JSON.parse(localStorage.getItem("user")),[q,G]=(0,a.useState)([]),[P,Z]=(0,a.useState)({search:"",openFilterDialog:!1,filterTablesAndColumns:{},deleteConfirmationDialog:!1,preFilterDialog:!1}),{contextObj:Q}=(0,a.useContext)(R.i),[U,X]=(0,a.useState)({}),Y=(0,k.Zp)(),[$,ee]=(0,a.useState)(!1),[le,ne]=(0,a.useState)(0);(0,a.useEffect)(()=>{(0,B.z)({address:"reports/template"}).then(e=>{null!==e&&void 0!==e&&e.success&&G(null===e||void 0===e?void 0:e.data)}).catch(e=>console.log(e))},[$]);const oe=(e,l)=>{X(n=>(0,o.A)((0,o.A)({},n),{},{[e]:l}))},ie=e=>{const{Column_Name:l,Column_Data_Type:n}=e;var i,a,t,r,d,s,u,c,v,m,p,x;return"number"===n?(0,z.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,z.jsx)("input",{placeholder:"Min",type:"number",className:"cus-inpt me-1",value:null!==(i=null===(a=U[l])||void 0===a?void 0:a.min)&&void 0!==i?i:"",onChange:e=>oe(l,(0,o.A)((0,o.A)({type:"range"},U[l]),{},{min:e.target.value?parseFloat(e.target.value):void 0}))}),(0,z.jsx)("input",{placeholder:"Max",type:"number",className:"cus-inpt ms-1",value:null!==(t=null===(r=U[l])||void 0===r?void 0:r.max)&&void 0!==t?t:"",onChange:e=>oe(l,(0,o.A)((0,o.A)({type:"range"},U[l]),{},{max:e.target.value?parseFloat(e.target.value):void 0}))})]}):"date"===n?(0,z.jsxs)("div",{className:"d-flex justify-content-between flex-wrap",children:[(0,z.jsx)("input",{placeholder:"Start Date",type:"date",className:"cus-inpt w-auto flex-grow-1 me-1 my-1",value:null!==(d=null===(s=U[l])||void 0===s||null===(u=s.value)||void 0===u?void 0:u.start)&&void 0!==d?d:"",onChange:e=>{var n;return oe(l,{type:"date",value:(0,o.A)((0,o.A)({},null===(n=U[l])||void 0===n?void 0:n.value),{},{start:e.target.value||void 0})})}}),(0,z.jsx)("input",{placeholder:"End Date",type:"date",className:"cus-inpt w-auto flex-grow-1 ms-1 my-1",value:null!==(c=null===(v=U[l])||void 0===v||null===(m=v.value)||void 0===m?void 0:m.end)&&void 0!==c?c:"",onChange:e=>{var n;return oe(l,{type:"date",value:(0,o.A)((0,o.A)({},null===(n=U[l])||void 0===n?void 0:n.value),{},{end:e.target.value||void 0})})}})]}):"string"===n?(0,z.jsx)("input",{type:"text",placeholder:"Search...",className:"cus-inpt",value:null!==(p=null===(x=U[l])||void 0===x?void 0:x.value)&&void 0!==p?p:"",onChange:e=>oe(l,{type:"textCompare",value:String(e.target.value).toLowerCase()||""})}):void 0},ae=e=>{var l;let{o:n}=e;const[i,t]=(0,a.useState)(null),r={Report_Type_Id:null===n||void 0===n?void 0:n.Report_Type_Id,reportName:null===n||void 0===n?void 0:n.Report_Name,ReportState:null===n||void 0===n?void 0:n.ReportState,tables:null===n||void 0===n||null===(l=n.tablesList)||void 0===l?void 0:l.map(e=>{var l;return{Table_Id:null===e||void 0===e?void 0:e.Table_Id,Table_Name:null===e||void 0===e?void 0:e.Table_Name,AliasName:null===e||void 0===e?void 0:e.AliasName,Table_Accronym:null===e||void 0===e?void 0:e.Table_Accronym,isChecked:!0,columns:null===e||void 0===e||null===(l=e.columnsList)||void 0===l?void 0:l.map(e=>({Column_Data_Type:null===e||void 0===e?void 0:e.Column_Data_Type,Column_Name:null===e||void 0===e?void 0:e.Column_Name,IS_Default:null===e||void 0===e?void 0:e.IS_Default,IS_Join_Key:null===e||void 0===e?void 0:e.IS_Join_Key,Order_By:null===e||void 0===e?void 0:e.Order_By,Table_Id:null===e||void 0===e?void 0:e.Table_Id,isVisible:!0}))}})},p=Boolean(i),x=p?null===n||void 0===n?void 0:n.Report_Name:void 0;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.A,{"aria-describedby":x,onClick:e=>{t(e.currentTarget)},children:(0,z.jsx)(w.A,{})}),(0,z.jsx)(s.Ay,{id:x,open:p,anchorEl:i,onClose:()=>{t(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:(0,z.jsxs)(u.A,{children:[(0,z.jsxs)(c.A,{onClick:()=>{Z(e=>(0,o.A)((0,o.A)({},e),{},{filterTablesAndColumns:r,openFilterDialog:!0})),ne(0),X({})},children:[(0,z.jsx)(v.A,{children:(0,z.jsx)(F.A,{fontSize:"small"})}),(0,z.jsx)(m.A,{children:"OPEN"})]}),(0,z.jsxs)(c.A,{onClick:null!==W&&void 0!==W&&W.Company_id?()=>{Z(e=>(0,o.A)((0,o.A)({},e),{},{filterTablesAndColumns:r,preFilterDialog:!0})),X({}),ne(0)}:()=>E.oR.warn("Select Company!"),children:[(0,z.jsx)(v.A,{children:(0,z.jsx)(S.A,{fontSize:"small"})}),(0,z.jsx)(m.A,{children:"FILTERS"})]}),(0,z.jsxs)(c.A,{onClick:()=>Y("create",{state:{ReportState:r}}),children:[(0,z.jsx)(v.A,{children:(0,z.jsx)(T.A,{fontSize:"small"})}),(0,z.jsx)(m.A,{children:"EDIT"})]}),(0,z.jsxs)(c.A,{onClick:()=>Z(e=>(0,o.A)((0,o.A)({},e),{},{deleteConfirmationDialog:!0,filterTablesAndColumns:r})),children:[(0,z.jsx)(v.A,{children:(0,z.jsx)(y.A,{fontSize:"small",color:"error"})}),(0,z.jsx)(m.A,{children:"DELETE"})]})]})})]})},te=e=>{var l;let{o:n}=e;return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"table-responsive",children:(0,z.jsxs)("table",{className:"table",children:[(0,z.jsx)("thead",{children:(0,z.jsx)("tr",{children:["SNo","Table","Column","Data-Type","Order"].map(e=>(0,z.jsx)("th",{className:"border fa-14 text-center",style:{backgroundColor:"#EDF0F7"},children:e},e))})}),(0,z.jsx)("tbody",{children:null===n||void 0===n||null===(l=n.tablesList)||void 0===l?void 0:l.map((e,l)=>{var n;return(0,z.jsx)(a.Fragment,{children:null===e||void 0===e||null===(n=e.columnsList)||void 0===n?void 0:n.map((n,o)=>{var i,a;return(0,z.jsxs)("tr",{children:[0===o&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("td",{className:"border fa-13 text-center vctr",rowSpan:null===e||void 0===e||null===(i=e.columnsList)||void 0===i?void 0:i.length,children:l+1}),(0,z.jsx)("td",{className:"border fa-13 text-center blue-text vctr",rowSpan:null===e||void 0===e||null===(a=e.columnsList)||void 0===a?void 0:a.length,children:null===e||void 0===e?void 0:e.AliasName})]}),(0,z.jsx)("td",{className:"\n                                                    border fa-13 vctr\n                                                    ".concat(Boolean(Number(null===n||void 0===n?void 0:n.IS_Default))?" blue-text ":"","\n                                                    ").concat(Boolean(Number(null===n||void 0===n?void 0:n.IS_Join_Key))?" fw-bold ":"","\n                                                    "),children:null===n||void 0===n?void 0:n.Column_Name}),(0,z.jsx)("td",{className:"border fa-13 vctr",children:null===n||void 0===n?void 0:n.Column_Data_Type}),(0,z.jsx)("td",{className:"border fa-13 vctr",children:null===n||void 0===n?void 0:n.Order_By})]},o)})},l)})})]})})})},re=()=>{Z(e=>(0,o.A)((0,o.A)({},e),{},{openFilterDialog:!1,filterTablesAndColumns:{}}))},de=()=>{Z(e=>(0,o.A)((0,o.A)({},e),{},{deleteConfirmationDialog:!1,filterTablesAndColumns:{}}))},se=()=>{Z(e=>(0,o.A)((0,o.A)({},e),{},{preFilterDialog:!1})),X({})};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(p.A,{children:[(0,z.jsxs)("div",{className:"p-2 border-bottom fa-16 fw-bold d-flex justify-content-between align-items-center",children:[(0,z.jsx)("span",{className:"text-primary text-uppercase ps-3",children:"Report Templates"}),(0,I.id)(null===Q||void 0===Q?void 0:Q.Add_Rights,1)&&(0,z.jsx)(x.A,{variant:"outlined",onClick:()=>Y("create"),children:"Add Report"})]}),(0,z.jsx)("div",{className:"d-flex justify-content-end p-3",children:(0,z.jsx)("input",{type:"search",className:"cus-inpt w-auto",placeholder:"Search Report Name",value:null!==(e=null===P||void 0===P?void 0:P.search)&&void 0!==e?e:"",onChange:e=>Z(l=>(0,o.A)((0,o.A)({},l),{},{search:String(e.target.value).toLowerCase()}))})}),(0,z.jsx)(h.A,{className:"p-0",children:(0,z.jsx)(O.Ay,{dataArray:null!==P&&void 0!==P&&P.search?[...q].filter(e=>String(null===e||void 0===e?void 0:e.Report_Name).toLowerCase().includes(P.search)):q,columns:[{Field_Name:"Report_Name",ColumnHeader:"Report Name",Fied_Data:"string",isVisible:1},{ColumnHeader:"Tables",isVisible:1,isCustomCell:!0,Cell:e=>{var l;let{row:n}=e;return null===n||void 0===n||null===(l=n.tablesList)||void 0===l?void 0:l.length}},{ColumnHeader:"Columns",isVisible:1,isCustomCell:!0,Cell:e=>{var l;let{row:n}=e;return null===n||void 0===n||null===(l=n.tablesList)||void 0===l?void 0:l.reduce((e,l)=>{var n;return e+Number(null===l||void 0===l||null===(n=l.columnsList)||void 0===n?void 0:n.length)},0)}},{Field_Name:"CreatedByGet",ColumnHeader:"Created By",Fied_Data:"string",isVisible:1},{ColumnHeader:"Columns",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return null!==l&&void 0!==l&&l.CreatedAt?(0,I.K0)(null===l||void 0===l?void 0:l.CreatedAt):" - "}},{ColumnHeader:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,z.jsx)(ae,{o:l})}}],EnableSerialNumber:!0,isExpendable:!0,expandableComp:e=>{let{row:l}=e;return(0,z.jsx)(te,{o:l})},tableMaxHeight:650})})]}),(0,z.jsxs)(A.A,{open:null===P||void 0===P?void 0:P.openFilterDialog,onClose:re,fullScreen:!0,children:[(0,z.jsxs)(j.A,{className:"d-flex justify-content-between align-items-center fa-16",children:[(0,z.jsxs)("span",{children:["Report - ",(0,z.jsx)("span",{className:"blue-text",children:null===P||void 0===P||null===(l=P.filterTablesAndColumns)||void 0===l?void 0:l.reportName})]}),(0,z.jsx)("span",{children:(0,z.jsx)(d.A,{onClick:re,color:"error",className:" shadow-lg",children:(0,z.jsx)(_.A,{})})})]}),(0,z.jsx)(b.A,{children:(null===P||void 0===P||null===(n=P.filterTablesAndColumns)||void 0===n?void 0:n.Report_Type_Id)&&(null===W||void 0===W?void 0:W.Company_id)&&(0,z.jsx)(L.A,{reportId:null===P||void 0===P||null===(i=P.filterTablesAndColumns)||void 0===i?void 0:i.Report_Type_Id,company:null===W||void 0===W?void 0:W.Company_id,queryFilters:U})}),(0,z.jsx)(C.A,{children:(0,z.jsx)(x.A,{onClick:re,startIcon:(0,z.jsx)(N.A,{}),children:"Back"})})]}),(0,z.jsxs)(A.A,{open:null===P||void 0===P?void 0:P.deleteConfirmationDialog,onClose:de,fullWidth:!0,maxWidth:"sm",children:[(0,z.jsx)(j.A,{children:"Confirmation"}),(0,z.jsxs)(b.A,{children:["Do you want to delete the Template ",(0,z.jsx)("span",{className:"blue-text",children:null===P||void 0===P||null===(t=P.filterTablesAndColumns)||void 0===t?void 0:t.reportName})," permanently"]}),(0,z.jsxs)(C.A,{children:[(0,z.jsx)(x.A,{onClick:de,children:"cancel"}),(0,z.jsx)(x.A,{onClick:()=>{var e;Z(e=>(0,o.A)((0,o.A)({},e),{},{deleteConfirmationDialog:!1})),(0,B.z)({address:"reports/template",method:"DELETE",bodyData:{Report_Type_Id:null===P||void 0===P||null===(e=P.filterTablesAndColumns)||void 0===e?void 0:e.Report_Type_Id}}).then(e=>{null!==e&&void 0!==e&&e.success?(E.oR.success(e.message),ee(e=>!e)):E.oR.error(e.message)}).catch(e=>console.log(e)).finally(()=>Z(e=>(0,o.A)((0,o.A)({},e),{},{filterTablesAndColumns:{}})))},startIcon:(0,z.jsx)(y.A,{}),variant:"outlined",color:"error",children:"Delete"})]})]}),(0,z.jsxs)(A.A,{open:null===P||void 0===P?void 0:P.preFilterDialog,onClose:se,fullWidth:!0,maxWidth:"md",children:[(0,z.jsxs)(j.A,{className:"d-flex justify-content-between",children:[(0,z.jsxs)("span",{children:["Filters For ",(0,z.jsx)("span",{className:"blue-text",children:null===P||void 0===P||null===(r=P.filterTablesAndColumns)||void 0===r?void 0:r.reportName})," - Report"]}),(0,z.jsx)("span",{children:(0,z.jsx)(d.A,{onClick:se,color:"error",className:"shadow-lg ",children:(0,z.jsx)(_.A,{})})})]}),(0,z.jsxs)(b.A,{children:[(0,z.jsx)(f.A,{value:le,onChange:(e,l)=>{ne(l)},children:null===P||void 0===P||null===(H=P.filterTablesAndColumns)||void 0===H||null===(J=H.tables)||void 0===J?void 0:J.map((e,l)=>(0,z.jsx)(g.A,{label:null===e||void 0===e?void 0:e.AliasName},l))}),null===P||void 0===P||null===(K=P.filterTablesAndColumns)||void 0===K||null===(M=K.tables)||void 0===M?void 0:M.map((e,l)=>{var n;return(0,z.jsx)(V,{value:le,index:l,children:(0,z.jsx)("div",{className:"row",children:null===e||void 0===e||null===(n=e.columns)||void 0===n?void 0:n.map((e,l)=>!Boolean(Number(null===e||void 0===e?void 0:e.IS_Default))&&!Boolean(Number(null===e||void 0===e?void 0:e.IS_Join_Key))&&(0,z.jsxs)("div",{className:"p-2 col-md-6 ",children:[(0,z.jsx)("label",{className:"mb-2 fw-bold text-muted",children:null===e||void 0===e?void 0:e.Column_Name}),ie(e)]},l))})},l)})]}),(0,z.jsxs)(C.A,{children:[(0,z.jsx)(x.A,{onClick:se,children:"cancel"}),(0,z.jsx)(x.A,{onClick:()=>Z(e=>(0,o.A)((0,o.A)({},e),{},{openFilterDialog:!0,preFilterDialog:!1})),startIcon:(0,z.jsx)(D.A,{}),variant:"contained",children:"Open report"})]})]})]})}},38463(e,l,n){n.d(l,{A:()=>a});var o=n(59662),i=n(70579);const a=(0,o.A)((0,i.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNewOutlined")}}]);
//# sourceMappingURL=3671.f5140871.chunk.js.map