"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[7611],{27611:(e,l,s)=>{s.r(l),s.d(l,{default:()=>D});var a=s(89379),t=s(65043),r=s(12110),d=s(11906),o=s(26494),n=s(17392),i=s(20656),c=s(63406),u=s(91036),v=s(97707),m=s(59662),_=s(70579);const h=(0,m.A)((0,_.jsx)("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft");var x=s(30079),p=s(70141),j=s(47968),I=s(83560),f=s(51387),C=s(37141),b=s(65074),N=s(48471),A=s(14844),T=s(73216);const S=(0,v.aN)().user,g={So_Id:"",So_Inv_No:"",So_Year:"",So_Branch_Inv_Id:"",So_Date:(0,v.ny)(),Retailer_Id:"",Retailer_Name:"",Sales_Person_Id:"",Branch_Id:"",VoucherType:"",GST_Inclusive:2,IS_IGST:0,Narration:"",isConverted:"",Cancel_status:"",CSGT_Total:0,SGST_Total:0,IGST_Total:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Created_by:null===S||void 0===S?void 0:S.UserId,Altered_by:null===S||void 0===S?void 0:S.UserId,Approved_By:"",Approve_Status:"",Created_on:"",Alterd_on:"",Trans_Type:"",Alter_Id:""},y={BrandID:"",Brand:"",GroupID:"",Group:"",SO_St_Id:"",So_Date:"",Sales_Order_Id:"",S_No:"",Pre_Id:"",Item_Id:"",Item_Rate:0,Bill_Qty:0,Amount:0,HSN_Code:"",Unit_Id:"",Unit_Name:"",Free_Qty:0,Total_Qty:0,Taxble:0,Taxable_Rate:0,Taxable_Amount:0,Tax_Rate:0,Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Final_Amo:0,Created_on:""},P={Id:"",So_Id:"",Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",EmpType:""};var R=s(83462),G=s(26600),w=s(35316),O=s(18584);const V=e=>{let{loadingOn:l,loadingOff:s,open:r,onClose:o,retailer:i,children:c,selectedItems:u,setSelectedItems:m,products:h=[],GST_Inclusive:x,IS_IGST:p}=e;const j=(0,v.id)(x,1),I=(0,v.id)(x,2),[f,C]=(0,t.useState)([]),[N,T]=(0,t.useState)({Fromdate:(0,v.ny)(),Todate:(0,v.ny)(),search:!1});(0,t.useEffect)(()=>{if((0,v.IQ)(i)&&r){const{Fromdate:e,Todate:a}=N;l&&l(),(0,b.z)({address:"sales/saleOrder/importPosOrders?Fromdate=".concat(e,"&Todate=").concat(a,"&Retailer_Id=").concat(i)}).then(e=>{e.success?C(e.data):C([])}).catch(e=>console.error(e)).finally(()=>{s&&s()})}},[N.search]);const S=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(s=>{const a=s.filter(l=>!(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));let t;if(l)t=a;else{const l=f.filter(l=>(0,v.id)(l.Pre_Id,e.Pre_Id)).map(e=>Object.fromEntries(Object.entries(y).map(l=>{var s,a,t,r,d;let[o,n]=l;const i=(e=>{var l;return null!==(l=null===h||void 0===h?void 0:h.find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}})(e.Item_Id),c=p?i.Igst_P:i.Gst_P,u=c>0,{Item_Rate:m,Bill_Qty:_,Tonnage:x,PackValue:f}=e,C=(0,v.JH)(m,(0,v.JH)(_,f)),b=I?"zerotax":j?"remove":"add",N=(0,A.v)(m,c,b),T=(0,A.v)(C,c,b),S=p?0:T.cgst_per,g=p?T.igst_per:0,y=p?0:T.cgst_amount,P=p?T.igst_amount:0;switch(o){case"Pre_Id":return[o,null!==(s=e.Pre_Id)&&void 0!==s?s:n];case"Item_Id":return[o,null!==(a=e.Item_Id)&&void 0!==a?a:n];case"Item_Rate":return[o,(0,v.Ro)(m)];case"Bill_Qty":case"Total_Qty":return[o,(0,v.Ro)(x)];case"Amount":return[o,C];case"Unit_Id":return[o,null!==(t=e.Unit_Id)&&void 0!==t?t:n];case"Unit_Name":return[o,null!==(r=e.Units)&&void 0!==r?r:n];case"HSN_Code":return[o,null!==(d=i.HSN_Code)&&void 0!==d?d:n];case"Taxable_Rate":return[o,N.base_amount];case"Taxble":return[o,u?1:0];case"Taxable_Amount":return[o,T.base_amount];case"Tax_Rate":return[o,c];case"Cgst":case"Sgst":return[o,null!==S&&void 0!==S?S:0];case"Cgst_Amo":case"Sgst_Amo":return[o,I?0:y];case"Igst":return[o,null!==g&&void 0!==g?g:0];case"Igst_Amo":return[o,I?0:P];case"Final_Amo":return[o,T.with_tax];default:return[o,n]}})));t=[...a,...l]}return t})},g=()=>{o&&o(),C([])};return(0,_.jsxs)(_.Fragment,{children:[c,(0,_.jsxs)(R.A,{open:r,onClose:g,fullScreen:!0,children:[(0,_.jsx)(G.A,{children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,_.jsx)("span",{className:"flex-grow-1",children:"Import from POS"}),(0,_.jsx)(n.A,{onClick:g,color:"success",children:(0,_.jsx)(O.A,{className:"fa-20"})})]})}),(0,_.jsxs)(w.A,{children:[(0,_.jsx)("form",{onSubmit:e=>{e.preventDefault(),T(e=>(0,a.A)((0,a.A)({},e),{},{search:!e.search}))},children:(0,_.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===N||void 0===N?void 0:N.Fromdate,onChange:e=>T(l=>(0,a.A)((0,a.A)({},l),{},{Fromdate:e.target.value})),required:!0})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,_.jsx)("input",{className:"cus-inpt p-2 w-auto ms-2",type:"date",min:N.Fromdate,value:null===N||void 0===N?void 0:N.Todate,onChange:e=>T(l=>(0,a.A)((0,a.A)({},l),{},{Todate:e.target.value})),required:!0})]}),(0,_.jsx)(d.A,{variant:"outlined",className:"ms-2",type:"submit",children:"search"})]})}),(0,_.jsx)("div",{className:"table-responsive mt-3",children:(0,_.jsxs)("table",{className:"table table-bordered fa-13",children:[(0,_.jsx)("thead",{children:(0,_.jsx)("tr",{children:["Sno","#","Item","Qty","Pack","Rate","Amount","Order ID","Date","Invoice Value"].map((e,l)=>(0,_.jsx)("th",{children:e},l))})}),(0,_.jsx)("tbody",{children:f.filter(e=>(0,v.id)(e.Custome_Id,i)).map((e,l)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:l+1}),(0,_.jsx)("td",{children:(()=>{const l=-1!==u.findIndex(l=>(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));return(0,_.jsx)("div",{children:(0,_.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:l,onChange:()=>{l?S(e,!0):S(e)}})})})()}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Tonnage}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Pre_Id}),(0,_.jsx)("td",{children:(0,v.yc)(null===e||void 0===e?void 0:e.Pre_Date)}),(0,_.jsx)("td",{children:null===e||void 0===e?void 0:e.Total_Invoice_value})]},l))})]})})]})]})]})};var B=s(56779);const E=e=>{let{StaffArray:l=[],setStaffArray:s,costCenter:t=[],costCategory:r=[]}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,_.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,_.jsx)(d.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>s(e=>[...e,(0,a.A)({},P)]),children:"Add"})]}),(0,_.jsxs)("table",{className:"table table-bordered",children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{className:"fa-13",children:"Sno"}),(0,_.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,_.jsx)("th",{className:"fa-13",children:"Category"}),(0,_.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,_.jsx)("tbody",{children:(0,v.$r)(l).map((e,d)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"fa-13 vctr text-center",children:d+1}),(0,_.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,_.jsx)(i.Ay,{value:{value:null===e||void 0===e?void 0:e.Involved_Emp_Id,label:null===e||void 0===e?void 0:e.EmpName},onChange:e=>s(l=>l.map((l,s)=>{if((0,v.id)(s,d)){const s=(0,v.$r)(t).find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Cost_Center_Id,e.value));return(0,a.A)((0,a.A)({},l),{},{Cost_Center_Type_Id:(0,v.IQ)(null===l||void 0===l?void 0:l.Cost_Center_Type_Id)?Number(null===l||void 0===l?void 0:l.Cost_Center_Type_Id):(0,v.IQ)(s.User_Type)?Number(s.User_Type):0,Involved_Emp_Id:Number(e.value),EmpName:e.label})}return l})),options:[...(0,v.$r)(t).filter(e=>!l.some(l=>(0,v.id)(l.Emp_Id,e.Cost_Center_Id)))].map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:c.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,_.jsxs)("select",{value:null===e||void 0===e?void 0:e.Cost_Center_Type_Id,onChange:e=>s(l=>l.map((l,s)=>(0,v.id)(s,d)?(0,a.A)((0,a.A)({},l),{},{Cost_Center_Type_Id:e.target.value}):l)),className:"cus-inpt p-2 border-0",children:[(0,_.jsx)("option",{value:"",children:"Select"}),(0,v.$r)(r).map((e,l)=>(0,_.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},l))]})}),(0,_.jsx)("td",{className:"fa-13 vctr p-0",children:(0,_.jsx)(n.A,{onClick:()=>{s(e=>e.filter((e,l)=>d!==l))},size:"small",children:(0,_.jsx)(f.A,{color:"error"})})})]},d))})]})]})};var z=s(14792);const k=(0,v.aN)().user,Q=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,v.id)(e.Product_Id,l)))&&void 0!==e?e:{}},D=e=>{var l,s;let{loadingOn:m,loadingOff:S}=e;const R=(0,T.Zp)(),G=(0,T.zy)().state,[w,O]=(0,t.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[D,F]=(0,t.useState)(g),[H,L]=(0,t.useState)([]),[U,M]=(0,t.useState)([]),[$,q]=(0,t.useState)(null),[J,W]=(0,t.useState)(!1),[Y,Z]=(0,t.useState)(!1),K=(0,v.id)(D.GST_Inclusive,1),X=(0,v.id)(D.GST_Inclusive,2),ee=(0,v.id)(D.IS_IGST,1),le=X?"zerotax":K?"remove":"add";(0,t.useEffect)(()=>{if((0,v.aF)(G)&&Array.isArray(null===G||void 0===G?void 0:G.Products_List)&&Array.isArray(null===G||void 0===G?void 0:G.Staff_Involved_List)){const{Products_List:e,Staff_Involved_List:l}=G;F(Object.fromEntries(Object.entries(g).map(e=>{var l;let[s,a]=e;return"So_Date"===s?[s,G[s]?(0,v.ny)(G[s]):a]:[s,null!==(l=G[s])&&void 0!==l?l:a]}))),L(e.map(e=>Object.fromEntries(Object.entries(y).map(l=>{var s;let[a,t]=l;return[a,null!==(s=e[a])&&void 0!==s?s:t]})))),M(l.map(e=>Object.fromEntries(Object.entries(P).map(l=>{var s;let[a,t]=l;return[a,null!==(s=e[a])&&void 0!==s?s:t]}))))}},[G]),(0,t.useEffect)(()=>{(async()=>{try{m&&m();const[e,l,s,t,r,d,o,n]=await Promise.all([(0,b.z)({address:"masters/branch/dropDown"}),(0,b.z)({address:"masters/products"}),(0,b.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===k||void 0===k?void 0:k.Company_id)}),(0,b.z)({address:"purchase/voucherType"}),(0,b.z)({address:"masters/uom"}),(0,b.z)({address:"dataEntry/costCenter"}),(0,b.z)({address:"dataEntry/costCenter/category"}),(0,b.z)({address:"masters/users/salesPerson/dropDown"})]),i=(e.success?e.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===l||void 0===l?void 0:l.BranchName)),c=(l.success?l.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===l||void 0===l?void 0:l.Product_Name)),u=(s.success?s.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===l||void 0===l?void 0:l.Retailer_Name)),_=(t.success?t.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===l||void 0===l?void 0:l.Voucher_Type)),h=(r.success?r.data:[]).sort((e,l)=>String(e.Units).localeCompare(l.Units)),x=(d.success?d.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===l||void 0===l?void 0:l.Cost_Center_Name)),p=(o.success?o.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===l||void 0===l?void 0:l.Cost_Category)),j=(n.success?n.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===l||void 0===l?void 0:l.Name));O(e=>(0,a.A)((0,a.A)({},e),{},{products:c,branch:i,retailers:u,voucherType:_,uom:h,staff:x,staffType:p,salesPerson:j,brand:(0,v.Mn)(c,"Brand",["Brand_Name"])}))}catch(e){console.error("Error fetching data:",e)}finally{S&&S()}})()},[null===k||void 0===k?void 0:k.Company_id]);const se=()=>{F(g),L([]),M([])},ae=(0,t.useMemo)(()=>H.reduce((e,l)=>{const s=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(X)return(0,v.Lr)(e,s);const a=Q(w.products,l.Item_Id),t=(0,v.id)(ee,1)?a.Igst_P:a.Gst_P;return K?(0,v.Lr)(e,(0,A.v)(s,t,"remove").with_tax):(0,v.Lr)(e,(0,A.v)(s,t,"add").with_tax)},0),[H,X,w.products,ee,K]),te=(0,t.useMemo)(()=>H.reduce((e,l)=>{const s=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(X)return{TotalValue:(0,v.Lr)(e.TotalValue,s),TotalTax:0};const a=Q(w.products,l.Item_Id),t=(0,v.id)(ee,1)?a.Igst_P:a.Gst_P,r=(0,A.v)(s,t,K?"remove":"add");return{TotalValue:(0,v.Lr)(e.TotalValue,r.without_tax),TotalTax:(0,v.Lr)(e.TotalTax,r.tax_amount)}},{TotalValue:0,TotalTax:0}),[H,X,w.products,ee,K]);return(0,t.useEffect)(()=>{L(e=>[...e].map(e=>Object.fromEntries(Object.entries(y).map(l=>{let[s,a]=l;const t=Q(w.products,null===e||void 0===e?void 0:e.Item_Id),r=ee?t.Igst_P:t.Gst_P,d=r>0,{Bill_Qty:o,Item_Rate:n,Amount:i}=e,c=(0,A.v)(n,r,le),u=(0,A.v)(i,r,le),v=ee?0:u.cgst_per,m=ee?u.igst_per:0,_=ee?0:u.cgst_amount,h=ee?u.igst_amount:0;switch(s){case"Taxable_Rate":return[s,c.base_amount];case"Total_Qty":return[s,o];case"Taxble":return[s,d?1:0];case"Taxable_Amount":return[s,u.base_amount];case"Tax_Rate":return[s,r];case"Cgst":case"Sgst":return[s,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[s,X?0:_];case"Igst":return[s,null!==m&&void 0!==m?m:0];case"Igst_Amo":return[s,X?0:h];case"Final_Amo":return[s,u.with_tax];default:return[s,e[s]||a]}}))))},[y,w.products,ee,le]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(B.A,{orderProducts:H,setOrderProducts:L,open:J,onClose:()=>{W(!1),q(null)},products:w.products,brands:w.brand,uom:w.uom,GST_Inclusive:D.GST_Inclusive,IS_IGST:ee,editValues:$,initialValue:y}),(0,_.jsxs)(r.A,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center flex-wrap p-2",children:[(0,_.jsx)("h5",{className:"flex-grow-1 ps-2",children:"Sale Order Creation"}),(0,_.jsx)(d.A,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(h,{}),onClick:()=>R("/erp/sales/saleOrder"),children:"Back"}),(0,_.jsx)(d.A,{variant:"outlined",sx:{ml:1},startIcon:(0,_.jsx)(x.A,{}),onClick:se,children:"Clear"})]}),(0,_.jsxs)(o.A,{children:[(0,_.jsxs)("div",{className:"row",children:[(0,_.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,_.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsx)(E,{StaffArray:U,setStaffArray:M,costCenter:w.staff,costCategory:w.staffType})})}),(0,_.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,_.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,_.jsxs)("div",{className:"row",children:[(0,_.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Retailer Name ",(0,_.jsx)(z.A,{})]}),(0,_.jsx)(i.Ay,{value:{value:null===D||void 0===D?void 0:D.Retailer_Id,label:null===D||void 0===D?void 0:D.Retailer_Name},onChange:e=>{F((0,a.A)((0,a.A)({},D),{},{Retailer_Id:e.value,Retailer_Name:e.label})),L([])},options:[{value:"",label:"select",isDisabled:!0},...w.retailers.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:c.MR,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200})]}),(0,_.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Voucher Type ",(0,_.jsx)(z.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{VoucherType:Number(e.target.value)})),value:D.VoucherType,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),null===(l=w.voucherType)||void 0===l?void 0:l.filter(e=>"SALES"===e.Type).map((e,l)=>(0,_.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Date ",(0,_.jsx)(z.A,{})]}),(0,_.jsx)("input",{type:"date",value:null!==D&&void 0!==D&&D.So_Date?(0,v.ny)(null===D||void 0===D?void 0:D.So_Date):"",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{So_Date:e.target.value})),className:"cus-inpt p-2"})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Invoice Type ",(0,_.jsx)(z.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{GST_Inclusive:Number(e.target.value)})),value:D.GST_Inclusive,children:[(0,_.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,_.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,_.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Tax Type ",(0,_.jsx)(z.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{IS_IGST:Number(e.target.value)})),value:D.IS_IGST,children:[(0,_.jsx)("option",{value:"0",children:"GST"}),(0,_.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Sales Person ",(0,_.jsx)(z.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{Sales_Person_Id:Number(e.target.value)})),value:D.Sales_Person_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select sales person"}),(0,_.jsx)("option",{value:null===k||void 0===k?void 0:k.UserId,children:null===k||void 0===k?void 0:k.Name}),null===(s=w.salesPerson)||void 0===s?void 0:s.map((e,l)=>(0,_.jsx)("option",{value:e.UserId,children:e.Name},l))]})]}),(0,_.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,_.jsxs)("label",{className:"fa-13",children:["Branch ",(0,_.jsx)(z.A,{})]}),(0,_.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>F((0,a.A)((0,a.A)({},D),{},{Branch_Id:Number(e.target.value)})),value:D.Branch_Id,children:[(0,_.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),w.branch.map((e,l)=>(0,_.jsx)("option",{value:e.BranchId,children:e.BranchName},l))]})]}),(0,_.jsxs)("div",{className:"col-12 p-2",children:[(0,_.jsx)("label",{className:"fa-13",children:"Narration"}),(0,_.jsx)("textarea",{className:"cus-inpt ",value:D.Narration,onChange:e=>F(l=>(0,a.A)((0,a.A)({},l),{},{Narration:e.target.value}))})]})]})})})]}),(0,_.jsx)(N.Ay,{title:"Products",ButtonArea:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(d.A,{onClick:()=>{q(null),W(!0)},sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(p.A,{}),disabled:!(0,v.IQ)(D.Retailer_Id)||H.length>0&&H.some(e=>(0,v.IQ)(e.Pre_Id)),children:"Add Product"}),(0,_.jsx)(V,{loadingOn:m,loadingOff:S,open:Y,onClose:()=>Z(!1),retailer:null===D||void 0===D?void 0:D.Retailer_Id,selectedItems:H,setSelectedItems:L,products:w.products,GST_Inclusive:D.GST_Inclusive,IS_IGST:ee,children:(0,_.jsx)(d.A,{onClick:()=>Z(!0),disabled:!(0,v.IQ)(D.Retailer_Id)||H.length>0&&H.some(e=>!(0,v.IQ)(e.Pre_Id)),sx:{ml:1},variant:"outlined",startIcon:(0,_.jsx)(j.A,{}),children:"Import pos"})})]}),dataArray:H,columns:[{isCustomCell:!0,Cell:e=>{let{row:l}=e;return Q(w.products,null===l||void 0===l?void 0:l.Item_Id).Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;return null===(l=Q(w.products,null===s||void 0===s?void 0:s.Item_Id).Product_Name)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;return(null===s||void 0===s?void 0:s.Bill_Qty)+" "+(null!==(l=null===s||void 0===s?void 0:s.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},(0,N.Lj)("Item_Rate","number","Rate","right"),(0,N.Lj)("Taxable_Amount","number","Taxable Amount","right"),{isCustomCell:!0,Cell:e=>{var l;let{row:s}=e;const a=null===(l=Q(w.products,null===s||void 0===s?void 0:s.Item_Id))||void 0===l?void 0:l.Gst_P,t=(0,v.Ro)(null===s||void 0===s?void 0:s.Amount),r=(0,A.v)(t,a,le);return(0,v.jG)(r.tax_amount)+" ("+r.tax_per+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var l,s;let{row:a}=e;const t=null===(l=Q(w.products,null===a||void 0===a?void 0:a.Item_Id))||void 0===l?void 0:l.Gst_P,r=null!==(s=a.Amount)&&void 0!==s?s:0,d=(0,A.v)(r,t,le).tax_amount;return(0,v.jG)((0,v.id)(D.GST_Inclusive,1)?r:(0,v.Lr)(r,d))},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(n.A,{onClick:()=>{q(l),W(!0)},size:"small",children:(0,_.jsx)(I.A,{})}),(0,_.jsx)(n.A,{size:"small",onClick:()=>{(0,v.IQ)(null===l||void 0===l?void 0:l.Pre_Id)?L(e=>e.filter(e=>!(0,v.id)(null===e||void 0===e?void 0:e.Pre_Id,null===l||void 0===l?void 0:l.Pre_Id))):L(e=>e.filter(e=>!(0,v.id)(e.Item_Id,l.Item_Id)))},color:"error",children:(0,_.jsx)(f.A,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),H.length>0&&(0,_.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,_.jsx)("table",{className:"table",children:(0,_.jsxs)("tbody",{children:[(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{className:"border p-2",rowSpan:(0,v.id)(D.IS_IGST,1)?4:5,children:["Total in words: ",(0,v.GF)(parseInt(ae))]}),(0,_.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(te.TotalValue)})]}),(0,v.id)(D.IS_IGST,1)?(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"IGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(te.TotalTax)})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"CGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(te.TotalTax/2)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"SGST"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(te.TotalTax/2)})]})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.e3)(Math.round(ae)-ae)})]}),(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{className:"border p-2",children:"Total"}),(0,_.jsx)("td",{className:"border p-2",children:(0,v.jG)(Math.round(ae))})]})]})})}),(0,_.jsx)("div",{className:"d-flex justify-content-end",children:(0,_.jsx)(d.A,{onClick:()=>{if((null===H||void 0===H?void 0:H.length)>0&&null!==D&&void 0!==D&&D.Retailer_Id)m(),(0,b.z)({address:"sales/saleOrder",method:(0,v.IQ)(null===D||void 0===D?void 0:D.So_Id)?"PUT":"POST",bodyData:(0,a.A)((0,a.A)({},D),{},{Product_Array:H.filter(e=>(0,v.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),Staff_Involved_List:U})}).then(e=>{e.success?(u.oR.success(null===e||void 0===e?void 0:e.message),se()):u.oR.error(null===e||void 0===e?void 0:e.message)}).catch(e=>console.error(e)).finally(()=>S());else{if(H.length<=0)return u.oR.error("Enter any one product quantity");if(null===D||void 0===D||!D.Retailer_Id)return u.oR.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,_.jsx)(C.A,{}),disabled:0===(null===H||void 0===H?void 0:H.length)||!(null!==D&&void 0!==D&&D.Retailer_Id),children:"Save"})})]})]})]})}},30079:(e,l,s)=>{s.d(l,{A:()=>r});var a=s(59662),t=s(70579);const r=(0,a.A)((0,t.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},37141:(e,l,s)=>{s.d(l,{A:()=>r});var a=s(59662),t=s(70579);const r=(0,a.A)((0,t.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},83560:(e,l,s)=>{s.d(l,{A:()=>r});var a=s(59662),t=s(70579);const r=(0,a.A)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")}}]);
//# sourceMappingURL=7611.c02483e3.chunk.js.map