"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[8424],{16043:(e,l,a)=>{a.r(l),a.d(l,{default:()=>R});var d=a(89379),s=a(65043),i=a(77739),r=a(17392),t=a(12110),o=a(11906),n=a(26494),c=a(83462),u=a(26600),v=a(35316),h=a(67784),_=a(29347),m=(a(20491),a(20656)),p=a(63406),x=a(97707),A=a(59383),j=a(3632),b=a(10204),y=a(65074),S=a(48471),C=a(41488),I=a(13899),N=a(67934),g=a(91299),T=a(91036),D=a(73216),f=a(70579);const R=e=>{let{loadingOn:l,loadingOff:a}=e;const R=(0,D.Zp)(),[P,L]=(0,s.useState)([]),F=JSON.parse(localStorage.getItem("user")),[V,w]=(0,s.useState)([]),[G,M]=(0,s.useState)([]),[O,k]=(0,s.useState)([]),[B,H]=(0,s.useState)([]),[z,U]=(0,s.useState)(!0),[W,K]=(0,s.useState)({}),[E,J]=(0,s.useState)({}),[Z,q]=(0,s.useState)(!1),[Q,X]=(0,s.useState)([]),[Y,$]=(0,s.useState)([]),[ee,le]=(0,s.useState)(!1),[ae,de]=(0,s.useState)(!0),[se,ie]=(0,s.useState)([]),[re,te]=(0,s.useState)({Trip_ST_KM:"",Branch_Id:"",Vehicle_No:"",Trip_No:"",Trip_Date:"",StartTime:"",Created_By:"",GST_Inclusive:1,IS_IGST:0,Delivery_Person_Id:"",Delivery_Location:"",Alter_Id:"",Delivery_Status:""}),oe=null===F||void 0===F?void 0:F.UserId,ne=null===F||void 0===F?void 0:F.BranchId,ce=null===F||void 0===F?void 0:F.UserTypeId,[ue,ve]=(0,s.useState)(!1),he=()=>ve(!1),[_e,me]=(0,s.useState)(null),[pe,xe]=(0,s.useState)([]),[Ae,je]=(0,s.useState)([]),[be,ye]=(0,s.useState)({Fromdate:(0,x.IS)(7),Todate:(0,x.ny)(),Retailer_Id:"",RetailerGet:"ALL",Created_by:"",CreatedByGet:"ALL",Sales_Person_Id:"",SalsePersonGet:"ALL",Cancel_status:0,Route_Id:"",RoutesGet:"ALL",Area_Id:"",AreaGet:"ALL"}),[Se,Ce]=(0,s.useState)({Do_Date:(0,x.ny)(),Vehicle_No:"",Trip_No:"",Trip_Date:(0,x.ny)(),StartTime:"",Created_By:"",Delivery_Person_Id:"",Delivery_Location:"",Delivery_Time:"",Payment_Ref_No:"",Payment_Mode:"",Payment_Status:"",Narration:"",Alter_Id:"",Delivery_Status:""}),Ie=e=>{const{name:l,value:a}=e.target;Ce(e=>(0,d.A)((0,d.A)({},e),{},{[l]:a}))},[Ne,ge]=(0,s.useState)({filters:!1,orderDetails:!1});(0,s.useEffect)(()=>{(0,y.z)({address:"sales/saleDelivery?Fromdate=".concat(null===be||void 0===be?void 0:be.Fromdate,"&Todate=").concat(null===be||void 0===be?void 0:be.Todate,"&Retailer_Id=").concat(null===be||void 0===be?void 0:be.Retailer_Id,"&Sales_Person_Id=").concat(null===be||void 0===be?void 0:be.Sales_Person_Id,"&Created_by=").concat(null===be||void 0===be?void 0:be.Created_by,"&Cancel_status=").concat(null===be||void 0===be?void 0:be.Cancel_status,"&Route_Id=").concat(null===be||void 0===be?void 0:be.Route_Id,"&Area_Id=").concat(null===be||void 0===be?void 0:be.Area_Id)}).then(e=>{e.success&&w(null===e||void 0===e?void 0:e.data)}).catch(e=>console.error(e))},[be.Fromdate,null===be||void 0===be?void 0:be.Todate,null===be||void 0===be?void 0:be.Retailer_Id,null===be||void 0===be?void 0:be.Sales_Person_Id,null===be||void 0===be?void 0:be.Created_by,null===be||void 0===be?void 0:be.Cancel_status,null===be||void 0===be?void 0:be.Route_Id,null===be||void 0===be?void 0:be.Area_Id,Z]);(0,s.useEffect)(()=>{(0,y.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&M(e.data)}).catch(e=>console.error(e)),(0,y.z)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&k(e.data)}).catch(e=>console.error(e)),(0,y.z)({address:"masters/user/dropDown?Company_id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&H(e.data)}).catch(e=>console.error(e)),(0,y.z)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&xe(e.data)}).catch(e=>console.error(e)),(0,y.z)({address:"masters/routes/dropdown?Company_id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&X(e.data)}).catch(e=>console.error(e)),(0,y.z)({address:"masters/areas/dropdown?Company_id=".concat(null===F||void 0===F?void 0:F.Company_id)}).then(e=>{e.success&&$(e.data)}).catch(e=>console.error(e))},[]);const Te=[{Field_Name:"checkbox",ColumnHeader:"",isVisible:1,pointer:!0,isCustomCell:!0,Cell:e=>{let{row:l}=e;const a=P.some(e=>e.So_Id===l.So_Id);return(0,f.jsx)("input",{type:"checkbox",checked:a,onChange:()=>(e=>{const l=P.some(l=>l.So_Id===e.So_Id);L(l?P.filter(l=>l.So_Id!==e.So_Id):[...P,e])})(l),style:{cursor:"pointer",transform:"scale(1.5)",width:"14px",height:"20px"}})}},{Field_Name:"So_Id",ColumnHeader:"Order ID",Fied_Data:"string",isVisible:1},{Field_Name:"Retailer_Name",ColumnHeader:"Customer",Fied_Data:"string",isVisible:1},{Field_Name:"So_Date",ColumnHeader:"Sale Order Date",Fied_Data:"date",isVisible:1,align:"center"},{Field_Name:"Total_Before_Tax",ColumnHeader:"Before Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Tax",ColumnHeader:"Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Invoice_value",ColumnHeader:"Invoice Value",Fied_Data:"number",isVisible:1,align:"center"},{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,a;let{row:d}=e;const s=b.T.find(e=>e.id===Number(null===d||void 0===d?void 0:d.isConverted));return(0,f.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(a=null===s||void 0===s?void 0:s.label)&&void 0!==a?a:"Undefined"})}},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(i.A,{title:"View Order",children:(0,f.jsx)(r.A,{onClick:()=>{J({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},color:"primary",size:"small",children:(0,f.jsx)(j.A,{className:"fa-16"})})}),(0,f.jsx)(i.A,{title:"Sales Delivery",children:(0,f.jsx)(r.A,{onClick:()=>{De(),K((0,d.A)({},l))},size:"small",children:(0,f.jsx)(N.A,{className:"fa-16"})})})]})}}],De=()=>{U(!z),K({})},fe=()=>{ge((0,d.A)((0,d.A)({},Ne),{},{filters:!1,orderDetails:!1})),K({})};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(t.A,{children:[(0,f.jsxs)("div",{className:"p-3 py-2 d-flex align-items-center justify-content-between",children:[(0,f.jsx)("h6",{className:"fa-18 m-0 p-0",children:z?"Sale Orders":(0,x.aF)(W)}),(0,f.jsxs)("div",{children:[(0,f.jsx)(i.A,{title:"Filters",children:(0,f.jsx)(r.A,{size:"small",onClick:()=>ge((0,d.A)((0,d.A)({},Ne),{},{filters:!0})),children:(0,f.jsx)(A.A,{})})}),P.length>0&&z&&(0,f.jsx)(o.A,{variant:"outlined",onClick:()=>{R("/erp/sales/Tripsheet/Tripsheetcreation",{state:[...P]})},children:"Convert to Trip"})]})]}),(0,f.jsx)(n.A,{className:"p-0",children:z?(0,f.jsx)(S.Ay,{dataArray:V,columns:Te,isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("table",{className:"table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,f.jsx)("td",{className:"border p-2",children:l.Branch_Name}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,f.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,f.jsx)("td",{className:"border p-2",children:l.Round_off})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,f.jsxs)("td",{className:"border p-2",children:[(0,x.id)(l.GST_Inclusive,1)&&"Inclusive",(0,x.id)(l.GST_Inclusive,0)&&"Exclusive"]}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,f.jsxs)("td",{className:"border p-2",children:[(0,x.id)(l.IS_IGST,1)&&"IGST",(0,x.id)(l.IS_IGST,0)&&"GST"]}),(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,f.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,f.jsx)("td",{className:"border p-2",colSpan:5,children:l.Narration})]})]})})})}}):ee?(0,f.jsx)(g.A,{editValues:W,loadingOn:l,loadingOff:a,reload:()=>{q(e=>!e),U(e=>!e)},switchScreen:()=>U(!0),onToggle:()=>{U(e=>!e),le(e=>!e)}}):(0,f.jsx)(C.A,{editValues:W,loadingOn:l,loadingOff:a,reload:()=>{q(e=>!e),U(e=>!e)},switchScreen:()=>U(!0),editOn:!0})})]}),Object.keys(E).length>0&&(0,f.jsx)(I.A,{orderDetails:null===E||void 0===E?void 0:E.orderDetails,orderProducts:null===E||void 0===E?void 0:E.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>J({}),TitleText:"Sale Order"}),(0,f.jsxs)(c.A,{open:ue,onClose:he,fullWidth:!0,maxWidth:"sm",children:[(0,f.jsx)(u.A,{children:"Delivery Details"}),(0,f.jsx)(v.A,{children:(0,f.jsxs)("form",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Delivery Date"}),(0,f.jsx)(h.A,{fullWidth:!0,type:"date",name:"Do_Date",value:Se.Do_Date,onChange:Ie,InputLabelProps:{shrink:!0}}),(0,f.jsx)("label",{htmlFor:"delivery-person",children:"Delivery Person"}),(0,f.jsx)(m.Ay,{id:"delivery-person",name:"deliveryPerson",value:_e?{value:_e.UserId,label:_e.Name}:null,onChange:e=>{me(e?{UserId:e.value,Name:e.label}:null)},options:[{value:"",label:"Select",isDisabled:!0},...(pe||[]).map(e=>({value:e.UserId,label:e.Name}))],styles:p.MR,isSearchable:!0,placeholder:"Sales Person Name"}),(0,f.jsx)(h.A,{fullWidth:!0,margin:"normal",label:"Vehicle Number",name:"Vehicle_No",value:Se.Vehicle_No,onChange:Ie}),(0,f.jsx)(h.A,{fullWidth:!0,margin:"normal",label:"Start KM",name:"Trip_ST_KM",value:Se.Trip_ST_KM,onChange:Ie}),(0,f.jsx)(h.A,{fullWidth:!0,margin:"normal",label:"Trip Date",type:"date",name:"Trip_Date",value:Se.Trip_Date,onChange:Ie}),(0,f.jsx)(h.A,{fullWidth:!0,margin:"normal",label:"Start Time",name:"StartTime",value:Se.StartTime,onChange:Ie})]})}),(0,f.jsxs)(_.A,{children:[(0,f.jsx)(o.A,{onClick:he,children:"Cancel"}),(0,f.jsx)(o.A,{onClick:async()=>{const e={Trip_ST_KM:Se.Trip_ST_KM||"",Branch_Id:Se.Branch_Id||"",Vehicle_No:Se.Vehicle_No||"",Trip_No:Se.Trip_No||"",StartTime:Se.StartTime||"",Delivery_Person_Id:(null===_e||void 0===_e?void 0:_e.UserId)||"",Delivery_Location:Se.Delivery_Location||"",Alter_Id:Se.Alter_Id||"",Delivery_Status:Se.Delivery_Status||"",Cost_Center_Type_Id:ce},l=(null===te||void 0===te||te.Trip_ST_KM,(0,d.A)((0,d.A)({},Se),{},{DeliveryList:Ae,Product_Array:se,EmployeesInvolved:e,deliveryPerson:null===_e||void 0===_e?void 0:_e.UserId,Do_Date:null===Se||void 0===Se?void 0:Se.Do_Date,Trip_Date:null===Se||void 0===Se?void 0:Se.Trip_Date,Vehicle_No:null===Se||void 0===Se?void 0:Se.Vehicle_No,Created_By:Number(oe),Branch_Id:ne,Involved_Emp_Id:null===_e||void 0===_e?void 0:_e.UserId,Trip_ST_KM:null===Se||void 0===Se?void 0:Se.Trip_ST_KM,Vehicle_No:null===Se||void 0===Se?void 0:Se.Vehicle_No}));try{const e=await(0,y.z)({address:"delivery/deliveryOrderTrip",method:"POST",bodyData:l});return e.success?(T.oR.success(e.message),he(),!0):(T.oR.error("Failed to add Trip Data"),he(),!1)}catch(a){return console.error("Error during API call:",a),he(),!1}},children:"Submit"})]})]}),(0,f.jsxs)(c.A,{open:Ne.filters,onClose:fe,fullWidth:!0,maxWidth:"sm",children:[(0,f.jsx)(u.A,{children:"Filters"}),(0,f.jsx)(v.A,{children:(0,f.jsx)("div",{className:"table-responsive pb-4",children:(0,f.jsx)("table",{className:"table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,f.jsx)("td",{children:(0,f.jsx)(m.Ay,{value:{value:null===be||void 0===be?void 0:be.Retailer_Id,label:null===be||void 0===be?void 0:be.RetailerGet},onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Retailer_Id:e.value,RetailerGet:e.label})),options:[{value:"",label:"ALL"},...G.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:p.MR,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Salse Person"}),(0,f.jsx)("td",{children:(0,f.jsx)(m.Ay,{value:{value:null===be||void 0===be?void 0:be.Sales_Person_Id,label:null===be||void 0===be?void 0:be.SalsePersonGet},onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Sales_Person_Id:e.value,SalsePersonGet:e.label})),options:[{value:"",label:"ALL"},...O.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:p.MR,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,f.jsx)("td",{children:(0,f.jsx)(m.Ay,{value:{value:null===be||void 0===be?void 0:be.Created_by,label:null===be||void 0===be?void 0:be.CreatedByGet},onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Created_by:e.value,CreatedByGet:e.label})),options:[{value:"",label:"ALL"},...B.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))],styles:p.MR,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,f.jsx)("td",{children:(0,f.jsx)("input",{type:"date",value:be.Fromdate,onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,f.jsx)("td",{children:(0,f.jsx)("input",{type:"date",value:be.Todate,onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,f.jsx)("td",{children:(0,f.jsxs)("select",{type:"date",value:be.Cancel_status,onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Cancel_status:Number(e.target.value)})),className:"cus-inpt",children:[(0,f.jsx)("option",{value:1,children:"Show"}),(0,f.jsx)("option",{value:0,children:"Hide"})]})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Routes"}),(0,f.jsx)("td",{children:(0,f.jsx)(m.Ay,{value:{value:null===be||void 0===be?void 0:be.Route_Id,label:null===be||void 0===be?void 0:be.RoutesGet},onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Route_Id:e.value,RoutesGet:e.label})),options:[{value:"",label:"ALL"},...Q.map(e=>({value:null===e||void 0===e?void 0:e.Route_Id,label:null===e||void 0===e?void 0:e.Route_Name}))],styles:p.MR,isSearchable:!0,placeholder:"Route Name"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{style:{verticalAlign:"middle"},children:"Area"}),(0,f.jsx)("td",{children:(0,f.jsx)(m.Ay,{value:{value:null===be||void 0===be?void 0:be.Area_Id,label:null===be||void 0===be?void 0:be.AreaGet},onChange:e=>ye((0,d.A)((0,d.A)({},be),{},{Area_Id:e.value,AreaGet:e.label})),options:[{value:"",label:"ALL"},...Y.map(e=>({value:null===e||void 0===e?void 0:e.Area_Id,label:null===e||void 0===e?void 0:e.Area_Name}))],styles:p.MR,isSearchable:!0,placeholder:"Area Name"})})]})]})})})}),(0,f.jsx)(_.A,{children:(0,f.jsx)(o.A,{onClick:fe,children:"close"})})]})]})}},67934:(e,l,a)=>{var d=a(24994);l.A=void 0;var s=d(a(40039)),i=a(70579);l.A=(0,s.default)((0,i.jsx)("path",{d:"M20 11c-.18 0-.36.03-.53.05L17.41 9H20V6l-3.72 1.86L13.41 5H9v2h3.59l2 2H11l-4 2-2-2H0v2h4c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4l2 2h3l3.49-6.1 1.01 1.01c-.91.73-1.5 1.84-1.5 3.09 0 2.21 1.79 4 4 4s4-1.79 4-4-1.79-4-4-4M4 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m16 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"}),"TwoWheeler")}}]);
//# sourceMappingURL=8424.1025aa7d.chunk.js.map