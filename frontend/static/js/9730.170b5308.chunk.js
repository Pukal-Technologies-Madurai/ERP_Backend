"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[9730],{1860:(e,a,s)=>{s.r(a),s.d(a,{default:()=>ne});var t=s(65043),r=s(17392),n=s(83462),l=s(26600),d=s(35316),o=s(29347),c=s(76447),i=s(75155),m=s(83560),h=s(79484),p=s(91036),u=s(45777),x=s(65074),_=s(28503),y=s(13448),j=s(58786),g=s(89379),A=s(11906),T=s(81e3),v=s(24056),S=s(85865),b=s(90889),k=s(86605),f=s(40710),I=s(79650),N=s(71806),E=s(84882),C=s(28076),D=s(39652),R=s(43845),P=s(73086),w=s(25477),O=(s(92342),s(20491),s(12249)),F=s(5793),B=s(12412),M=s(51962),z=s(67784),L=s(97707),U=s(14792),W=s(70579);const G=(0,W.jsx)(O.A,{fontSize:"small"}),H=(0,W.jsx)(F.A,{fontSize:"small"}),q=e=>{let{row:a,children:s,openAction:r,reload:c,onCloseFun:i,loadingOn:m,loadingOff:h,onTaskAdded:u}=e;const _=localStorage.getItem("user"),y=JSON.parse(_),j={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:"",Entry_By:null===y||void 0===y?void 0:y.UserId,Company_id:null===y||void 0===y?void 0:y.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[A,T]=(0,t.useState)(!1),[v,S]=(0,t.useState)(!1),[b,k]=(0,t.useState)([]),[f,I]=(0,t.useState)([]),[N,E]=(0,t.useState)([]),[C,D]=(0,t.useState)(j),[R,P]=(0,t.useState)(!1),[w,O]=(0,t.useState)(j);(0,t.useEffect)(()=>{(async()=>{try{const e=await(0,x.z)({address:"taskManagement/tasks/dropdown"});e.success&&k(e.data);const a=await(0,x.z)({address:"masters/taskType/dropDown"});a.success&&I(a.data);const s=await(0,x.z)({address:"taskManagement/parameters"});s.success&&E(s.data)}catch(e){console.error(e)}})()},[]),(0,t.useEffect)(()=>{T(r)},[r]),(0,t.useEffect)(()=>{(0,L.aF)(a)?(console.log(a),D(e=>(0,g.A)((0,g.A)((0,g.A)({},e),a),{},{Task_Group_Id:a.Task_Group_Id||""})),S(!0)):(D(j),S(!1))},[a]);const F=()=>{T(!1),i&&i()},q=()=>{P(!1),O(j)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("span",{onClick:()=>T(!0),style:{cursor:"pointer"},children:s}),(0,W.jsxs)(n.A,{open:A,children:[(0,W.jsx)(l.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:v?"Edit Task":"Add Task"}),(0,W.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=C.Task_Parameters.map(e=>(0,g.A)((0,g.A)({},e),{},{Param_Id:e.Paramet_Id}))||[],a=(0,g.A)((0,g.A)({},C),{},{Task_Parameters:e});m&&m();try{const e=await(0,x.z)({address:"taskManagement/tasks",method:v?"PUT":"POST",bodyData:a});e.success?(p.oR.success(e.message),D(j),F(),c&&c(),u&&u()):p.oR.error(e.message)}catch(s){console.error(s),p.oR.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,W.jsx)(d.A,{children:(0,W.jsxs)("div",{className:"row",children:[(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsxs)("label",{children:["Task Name ",(0,W.jsx)(U.A,{})]}),(0,W.jsx)("input",{maxLength:150,onChange:e=>D((0,g.A)((0,g.A)({},C),{},{Task_Name:e.target.value})),required:!0,value:C.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsxs)("label",{children:["Task Group ",(0,W.jsx)(U.A,{})]}),(0,W.jsxs)("select",{value:C.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>D((0,g.A)((0,g.A)({},C),{},{Task_Group_Id:e.target.value})),children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),f.map((e,a)=>(0,W.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a))]})]}),(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsx)("label",{children:"Base Task"}),(0,W.jsxs)("select",{value:C.Under_Task_Id,className:"cus-inpt",onChange:e=>D((0,g.A)((0,g.A)({},C),{},{Under_Task_Id:e.target.value})),children:[(0,W.jsx)("option",{value:0,children:"Primary"}),b.map((e,a)=>(0,W.jsx)("option",{value:e.Task_Id,children:e.Task_Name},a))]})]}),(0,W.jsxs)("div",{className:"col-12",children:[(0,W.jsxs)("label",{children:["Task Description ",(0,W.jsx)(U.A,{})]}),(0,W.jsx)("textarea",{className:"cus-inpt",value:C.Task_Desc,rows:"3",onChange:e=>D((0,g.A)((0,g.A)({},C),{},{Task_Desc:e.target.value}))})]}),(0,W.jsx)("div",{className:"col-md-12 p-2",children:(0,W.jsx)(B.A,{multiple:!0,id:"checkboxes-tags-demo",options:N,disableCloseOnSelect:!0,getOptionLabel:e=>"".concat(e.Paramet_Name," - ").concat(e.Paramet_Data_Type),value:C.Task_Parameters||[],onChange:(e,a)=>D((0,g.A)((0,g.A)({},C),{},{Task_Parameters:a})),renderOption:(e,a,s)=>{let{selected:t}=s;return(0,W.jsxs)("li",(0,g.A)((0,g.A)({},e),{},{children:[(0,W.jsx)(M.A,{icon:G,checkedIcon:H,style:{marginRight:8},checked:t}),"".concat(a.Paramet_Name," - ").concat(a.Paramet_Data_Type)]}))},className:"pt-2",isOptionEqualToValue:(e,a)=>Number(e.Paramet_Id)===Number(a.Paramet_Id),renderInput:e=>(0,W.jsx)(z.A,(0,g.A)((0,g.A)({},e),{},{label:"Task Parameters",placeholder:"Choose Task Parameters"}))})}),C.Task_Parameters.map((e,a)=>(0,W.jsxs)("div",{className:"col-md-4 p-2",children:[(0,W.jsx)("label",{className:"mb-2",children:e.Paramet_Name}),(0,W.jsx)("input",{type:e.Paramet_Data_Type||"text",className:"cus-inpt",onChange:e=>{const s=[...C.Task_Parameters];s[a]=(0,g.A)((0,g.A)({},s[a]),{},{Default_Value:e.target.value}),D((0,g.A)((0,g.A)({},C),{},{Task_Parameters:s}))},value:e.Default_Value,placeholder:"Default Value"})]},a))]})}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:F,children:"Cancel"}),(0,W.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]}),(0,W.jsxs)(n.A,{open:R,onClose:q,children:[(0,W.jsx)(l.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Edit Task"}),(0,W.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=w.Task_Parameters.map(e=>(0,g.A)((0,g.A)({},e),{},{Param_Id:e.Paramet_Id}))||[],a=(0,g.A)((0,g.A)({},w),{},{Task_Parameters:e});m&&m();try{const e=await(0,x.z)({address:"taskManagement/tasks",method:"PUT",bodyData:a});e.success?(p.oR.success(e.message),q(),c&&c(),u&&u()):p.oR.error(e.message)}catch(s){console.error(s),p.oR.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,W.jsxs)(d.A,{children:[(0,W.jsx)(z.A,{label:"Task Name",value:w.Task_Name,onChange:e=>O((0,g.A)((0,g.A)({},w),{},{Task_Name:e.target.value})),fullWidth:!0}),(0,W.jsxs)(z.A,{label:"Task Group",select:!0,value:w.Task_Group_Id,onChange:e=>O((0,g.A)((0,g.A)({},w),{},{Task_Group_Id:e.target.value})),fullWidth:!0,children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),f.map((e,a)=>(0,W.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a))]})]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:q,children:"Cancel"}),(0,W.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Save"})]})]})]})]})};var J=s(21337),V=s(20656),Y=s(63406);const K=e=>{let{open:a,onClose:s,projectId:r,taskId:c,reload:i,onReload:m,editData:h}=e;const u=localStorage.getItem("user"),_=JSON.parse(u),[y,j]=(0,t.useState)([]),[T,v]=(0,t.useState)(!1),[S,b]=(0,t.useState)([]),k={AN_No:"",Project_Id:r,Sch_Id:c,Assigned_Emp_Id:null===_||void 0===_?void 0:_.UserId,Emp_Id:"",Task_Assign_dt:(new Date).toISOString().split("T")[0],Sch_Period:"",Sch_Time:"",EN_Time:"",Est_Start_Dt:"",Est_End_Dt:"",Ord_By:1,Timer_Based:!1,Sch_Type:"",Invovled_Stat:!0,EmpGet:"- Select -",Is_Repitative:!1,RepeatDays:{Mon:!1,Tue:!1,Wed:!1,Thu:!1,Fri:!1,Sat:!1,Sun:!1}},[f,I]=(0,t.useState)(k);(0,t.useEffect)(()=>{a&&N()},[r,a,i]);const N=async()=>{v(!0);try{const e=await(0,x.z)({address:"masters/Employeedetails/getusersproject?Project_Id=".concat(r)}),a=await(0,x.z)({address:"taskManagement/project/schedule/newscheduleType"});e.success&&j(e.data||[]),a.success}catch(e){p.oR.error("Failed to fetch data.")}finally{v(!1)}};(0,t.useEffect)(()=>{a&&(async()=>{v(!0);try{if(h){var e,a;const s=await(0,x.z)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(r,"&Sch_Id=").concat(c.Sch_Id,"&Task_Id=").concat(c.Task_Id)}),t=null===(e=s.data[0])||void 0===e?void 0:e.Sch_Type_Id,n=null===(a=s.data[0])||void 0===a?void 0:a.Sch_Name;b(t&&n?{value:t,label:n}:{value:"",label:""})}else{var s,t;const e=await(0,x.z)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(r,"&Sch_Id=").concat(c.TaskSchId,"&Task_Id=").concat(c.Task_Id)}),a=null===(s=e.data[0])||void 0===s?void 0:s.Sch_Type_Id,n=null===(t=e.data[0])||void 0===t?void 0:t.Sch_Name;b(a&&n?{value:a,label:n}:{value:"",label:""})}}catch(n){p.oR.error("Failed to fetch data.")}finally{v(!1)}})()},[a,h,i,r]),(0,t.useEffect)(()=>{h&&I(e=>(0,g.A)((0,g.A)({},e),{},{AN_No:h.AN_No,Emp_Id:h.Emp_Id,Sch_Time:h.Sch_Time,EN_Time:h.EN_Time,Est_Start_Dt:h.Est_Start_Dt.split("T")[0],Est_End_Dt:h.Est_End_Dt.split("T")[0],Ord_By:h.Ord_By,Timer_Based:h.Timer_Based,Invovled_Stat:h.Invovled_Stat,Sch_Type_Id:h.Sch_Type,Sch_Type:h.Sch_Type_Name,EmpGet:h.EmployeeName,Is_Repitative:h.Is_Repitative,RepeatDays:{Mon:!!h.IS_Rep_Monday,Tue:!!h.IS_Rep_Tuesday,Wed:!!h.IS_Rep_Wednesday,Thu:!!h.IS_Rep_Thursday,Fri:!!h.Is_Rep_Friday,Sat:!!h.Is_Rep_Saturday,Sun:!!h.Is_Rep_Sunday}}))},[h]);return(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)(n.A,{open:a,maxWidth:"sm",children:[(0,W.jsx)(l.A,{children:h?"Edit Task":"Employee Assign"}),(0,W.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=(()=>{const[e,a]=f.Sch_Time.split(":").map(Number),[s,t]=f.EN_Time.split(":").map(Number),r=new Date(0,0,0,e,a),n=new Date(0,0,0,s,t);if(n>r){let e=Math.abs(n-r);const a=Math.floor(e/36e5),s=Math.floor(e/6e4);return"".concat(String(a).padStart(2,"0"),":").concat(String(s).padStart(2,"0"))}return""})();if(f.Est_End_Dt<f.Est_Start_Dt)p.oR.error("End date must be greater than start date.");else try{const e=h?"masters/employeedetails/updateTask":"masters/employeedetails/assignTask",t={IS_Rep_Monday:f.RepeatDays.Mon?1:null,IS_Rep_Tuesday:f.RepeatDays.Tue?1:null,IS_Rep_Wednesday:f.RepeatDays.Wed?1:null,IS_Rep_Thursday:f.RepeatDays.Thu?1:null,Is_Rep_Friday:f.RepeatDays.Fri?1:null,Is_Rep_Saturday:f.RepeatDays.Sat?1:null,Is_Rep_Sunday:f.RepeatDays.Sun?1:null};(await(0,x.z)({address:e,method:h?"PUT":"POST",bodyData:(0,g.A)((0,g.A)({},f),{},{Project_Id:r,Sch_Id:h?c.Sch_Id:c.TaskSchId,Task_Levl_Id:c.Task_Levl_Id,Task_Id:Number(c.Task_Id),Assigned_Emp_Id:f.Assigned_Emp_Id,Emp_Id:f.Emp_Id,Sch_Period:a,Sch_Time:f.Sch_Time,EN_Time:f.EN_Time,Est_Start_Dt:f.Est_Start_Dt,Est_End_Dt:f.Est_End_Dt,Ord_By:f.Ord_By,Sch_Type:S.value,Timer_Based:f.Timer_Based?1:0,Invovled_Stat:f.Invovled_Stat?1:0,Is_Repitative:f.Is_Repitative?1:0,RepeatDays:f.Is_Repitative?f.RepeatDays:""},t)})).success?(p.oR.success("Task ".concat(h?"updated":"assigned"," successfully!")),I({}),m&&m(),s()):p.oR.error("Please fill the values correctly")}catch(t){p.oR.error("Error during task assignment/update: "+t.message)}},children:[(0,W.jsxs)(d.A,{className:"table-responsive",children:[T&&(0,W.jsx)("div",{children:"Loading..."}),(0,W.jsx)("table",{className:"table",style:{tableLayout:"fixed"},children:(0,W.jsxs)("tbody",{children:[(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Employee"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)(V.Ay,{value:{value:f.Emp_Id,label:f.EmpGet},onChange:e=>I((0,g.A)((0,g.A)({},f),{},{Emp_Id:e.value,EmpGet:e.label})),options:[{value:"",label:"- Select -"},...y.map(e=>({value:e.UserId,label:e.Name}))],styles:Y.MR,required:!0,isSearchable:!0,placeholder:"Select User"})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Sch_Type"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)(V.Ay,{value:S?{value:S.value,label:"".concat(S.label)}:null,styles:{padding:"0.5em"},isDisabled:!0,placeholder:"Select Sch_Type"})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Start Time"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"time",className:"cus-inpt",value:f.Sch_Time,required:!0,onChange:e=>I((0,g.A)((0,g.A)({},f),{},{Sch_Time:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"End Time"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"time",className:"cus-inpt",value:f.EN_Time,required:!0,min:f.Sch_Time,onChange:e=>I((0,g.A)((0,g.A)({},f),{},{EN_Time:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. Start Date"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_Start_Dt,required:!0,onChange:e=>I((0,g.A)((0,g.A)({},f),{},{Est_Start_Dt:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsxs)("tr",{children:[(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. End Date"}),(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,W.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_End_Dt,required:!0,min:f.Est_Start_Dt,onChange:e=>I((0,g.A)((0,g.A)({},f),{},{Est_End_Dt:e.target.value})),style:{padding:"0.5em"}})})]}),(0,W.jsx)("tr",{children:(0,W.jsxs)("td",{className:"border-bottom-0 fa-15 text-start",style:{paddingRight:"1em"},children:[(0,W.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,W.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",id:"timerbased",checked:Boolean(Number(null===f||void 0===f?void 0:f.Timer_Based)),onChange:e=>I((0,g.A)((0,g.A)({},f),{},{Timer_Based:e.target.checked})),style:{marginRight:"0.5em"}}),(0,W.jsx)("label",{className:"form-check-label p-1 ps-2",htmlFor:"timerbased",children:"Timer Based Task?"})]}),h&&(0,W.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,W.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",checked:Boolean(Number(null===f||void 0===f?void 0:f.Invovled_Stat)),onChange:()=>I((0,g.A)((0,g.A)({},f),{},{Invovled_Stat:!f.Invovled_Stat})),style:{marginRight:"0.5em"}}),(0,W.jsx)("label",{className:"form-check-label p-1 ps-2",children:"Involved Status"})]})]})}),(0,W.jsx)("tr",{children:(0,W.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingRight:"1em"},children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"1em"},children:[(0,W.jsx)("input",{type:"checkbox",checked:1===f.Is_Repitative,onChange:e=>{I(a=>(0,g.A)((0,g.A)({},a),{},{Is_Repitative:e.target.checked?1:0}))},style:{marginRight:"1em"}}),(0,W.jsx)("label",{style:{marginBottom:"0"},children:"Is Repetitive?"})]}),1===f.Is_Repitative&&(0,W.jsx)("div",{style:{display:"inline-flex",gap:"0.5em"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(e=>(0,W.jsxs)("label",{style:{display:"flex",alignItems:"center",marginRight:"1em",width:"30px"},children:[(0,W.jsx)("input",{type:"checkbox",checked:f.RepeatDays[e],onChange:()=>I((0,g.A)((0,g.A)({},f),{},{RepeatDays:(0,g.A)((0,g.A)({},f.RepeatDays),{},{[e]:!f.RepeatDays[e]})})),style:{marginRight:"0.5em"}}),e]},e))})]})})})]})})]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)(A.A,{onClick:()=>{s(),I(k)},variant:"outlined",children:"Close"}),(0,W.jsx)(A.A,{type:"submit",variant:"contained",children:"Save Changes"})]})]})]})})};var Z=s(81637),Q=s(73460),X=s(51214),$=s(53911);const ee=function(e){let{open:a,onClose:s,taskDetails:o,closeDialogTask:c}=e;const[i,h]=(0,t.useState)(null),[p,x]=(0,t.useState)(!1),[_,y]=(0,t.useState)(!0),{contextObj:j}=(0,t.useContext)(u.i);(0,t.useEffect)(()=>{a&&(h(null),y(!0),setTimeout(()=>{y(!1)},500))},[a]);const g=e=>{if(!e)return"N/A";const a=new Date(e);if(isNaN(a.getTime()))return"Invalid Date";const s=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),r=a.getFullYear();return"".concat(s,"-").concat(t,"-").concat(r)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(n.A,{open:a,maxWidth:"lg",children:[(0,W.jsx)(l.A,{children:(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsx)("span",{children:"Details"}),(0,W.jsx)(A.A,{variant:"contained",color:"primary",onClick:s,children:"Close"})]})}),(0,W.jsx)(d.A,{children:_?(0,W.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",width:"500px"},children:(0,W.jsx)(Z.A,{})}):(0,W.jsx)(I.A,{children:(0,W.jsxs)(N.A,{children:[(0,W.jsx)(E.A,{children:(0,W.jsxs)(C.A,{children:[(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Employee"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Assigned By"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Start-End Date"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Start-End Time"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Total Hours"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Timer Based"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Involved Status"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Order By"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:"Action"})]})}),(0,W.jsx)(Q.A,{children:0===o.length?(0,W.jsx)(C.A,{children:(0,W.jsx)(D.A,{colSpan:9,className:"fa-14 text-center",style:{textAlign:"center"},children:"No data found"})}):o.map((e,a)=>(0,W.jsxs)(C.A,{children:[(0,W.jsx)(D.A,{className:"fa-13 text-center",children:e.EmployeeName||"N/A"}),(0,W.jsx)(D.A,{className:"fa-13 text-center",children:e.AssignedUser||"N/A"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:(0,W.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,W.jsx)(X.A,{className:"fa-18 me-2"}),g(e.Est_Start_Dt)," - ",g(e.Est_End_Dt)]})}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:(0,W.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,W.jsx)($.A,{className:"fa-18 me-2"}),e.Sch_Time||"N/A"," - ",e.EN_Time||"N/A"]})}),(0,W.jsx)(D.A,{className:"fa-13 text-center",children:e.Sch_Period||"N/A"}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:(0,W.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Timer_Based)?"bg-success":"bg-warning"),children:Number(e.Timer_Based)?"Yes":"No"})}),(0,W.jsx)(D.A,{className:"fa-14 text-center",children:(0,W.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Invovled_Stat)?"bg-success":"bg-danger"),children:Number(e.Invovled_Stat)?"IN":"OUT"})}),(0,W.jsx)(D.A,{className:"fa-13 text-center",children:e.Ord_By||"N/A"}),1===Number(null===j||void 0===j?void 0:j.Edit_Rights)&&(0,W.jsx)(D.A,{className:"fa-13 text-center",children:(0,W.jsxs)(r.A,{size:"small",onClick:()=>(h(e),void x(!0)),children:[(0,W.jsx)(m.A,{className:"fa-18"}),"Edit"]})})]},a))})]})})})]}),p&&(0,W.jsx)(K,{open:p,projectId:null===i||void 0===i?void 0:i.Project_Id,taskId:i,editData:i,onClose:()=>{x(!1),s()}})]})};var ae=s(22016),se=s(15710),te=s(86506);const re=function(e){let{dialogOpen:a,setDialogOpen:s,projectid:c,reload:i,onReload:h,selectedProject:_}=e;const[y,j]=(0,t.useState)(!1),[O,F]=(0,t.useState)(!1),[B,M]=(0,t.useState)(!1),[z,L]=(0,t.useState)(null),[U,G]=(0,t.useState)([]),[H,V]=(0,t.useState)([]),[Y,Z]=(0,t.useState)(!1),[Q,X]=(0,t.useState)({Sch_Type_Id:"",Sch_Type:""}),[$,re]=(0,t.useState)([]),[ne,le]=(0,t.useState)(!1),de=JSON.parse(localStorage.getItem("user")),oe=null===de||void 0===de?void 0:de.UserId,ce=null===de||void 0===de?void 0:de.Company_id,[ie,me]=(0,t.useState)(!1),[he,pe]=(0,t.useState)(null),[ue,xe]=(0,t.useState)(null),{contextObj:_e}=(0,t.useContext)(u.i),[ye,je]=(0,t.useState)(!1),[ge,Ae]=(0,t.useState)(!1),[Te,ve]=(0,t.useState)("1"),[Se,be]=(0,t.useState)([]),ke=(e,a)=>{ve(a)},fe=(0,t.useCallback)(async()=>{try{const e=await(0,x.z)({address:"taskManagement/tasks/dropdown?Company_id=".concat(ce)});e.success?G(e.data):p.oR.error(e.message)}catch(e){console.error(e)}},[ce]),Ie=(0,t.useCallback)(async()=>{try{const e=await(0,x.z)({address:"taskManagement/project/schedule/ListingDetails?Project_Id=".concat(c)});e.success?re(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}},[c]);(0,t.useEffect)(()=>{fe(),Ie(),(async()=>{(0,x.z)({address:"taskManagement/project/schedule/newscheduleType"}).then(e=>{e.success?(console.log("data.data",e.data),be(e.data)):p.oR.error(e.message)})})()},[i,c,h]);const Ne=U.map(e=>({value:e.Task_Id,label:e.Task_Name})),Ee=e=>{const a=Se.find(a=>a.Sch_Type_Id===parseInt(e.target.value));a&&X((0,g.A)((0,g.A)({},Q),{},{Sch_Type_Id:a.Sch_Type_Id,Sch_Type:a.Sch_Type}))};return(0,W.jsxs)(W.Fragment,{children:[ge&&(0,W.jsxs)(n.A,{open:ge,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},onClose:()=>Ae(!1),children:[(0,W.jsx)(l.A,{children:ye?"Edit Task":"Assign Task"}),(0,W.jsx)(d.A,{children:(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,W.jsxs)("select",{value:Q.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map((e,a)=>(0,W.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a))]})]})})}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)(A.A,{onClick:()=>Ae(!1),children:"Cancel"}),(0,W.jsx)(A.A,{variant:"contained",color:"primary",onClick:()=>(async e=>{const a={Sch_Project_Id:e.Sch_Project_Id,Sch_Id:e.TaskSchId,schtypeid:Q.Sch_Type_Id,Task_Id:e.Task_Id};try{const e=await(0,x.z)({address:"taskManagement/project/schedule/updateScheduleTaskUpdate",method:"PUT",bodyData:a});e.success?(p.oR.success(e.message),Ae(!1),je(!1),h()):(e.status,p.oR.warn(e.message||"Task already exists for this project."))}catch(s){p.oR.error(s)}})(Q),children:"Save"})]})]}),(0,W.jsxs)(n.A,{open:a,fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,W.jsx)(l.A,{children:(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,W.jsx)("span",{children:null===_||void 0===_?void 0:_.Project_Name}),(0,W.jsx)(A.A,{variant:"contained",color:"primary",onClick:()=>F(!0),children:"Assign Task"})]})}),(0,W.jsx)(T.A,{sx:{width:"100%",typography:"body1"},children:$.map((e,a)=>{const s=JSON.parse(e.SchTypes);return(0,W.jsxs)(ae.Ay,{value:Te,children:[(0,W.jsx)(T.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,W.jsx)(se.A,{onChange:ke,"aria-label":"Schedule Types",children:Array.isArray(s)&&s.length>0?s.map((e,a)=>(0,W.jsx)(v.A,{label:e.SchType||"No SchType",value:(e.SchTypeId||a).toString(),id:"tab-".concat(e.SchTypeId||a),"aria-controls":"tabpanel-".concat(e.SchTypeId||a)},"".concat(e.SchTypeId||"index","-").concat(a))):(0,W.jsxs)(S.A,{variant:"body2",color:"textSecondary",sx:{padding:2},children:["No Details Available for ",s]})})}),Array.isArray(s)&&s.map((e,a)=>(0,W.jsxs)(te.A,{value:(e.SchTypeId||a).toString(),id:"tabpanel-".concat(e.SchTypeId||a),"aria-labelledby":"tab-".concat(e.SchTypeId||a),children:[(0,W.jsx)(T.A,{sx:{marginBottom:2,padding:2,backgroundColor:"#f9f9f9",borderRadius:"8px"},children:Array.isArray(e.TaskCountsInSchType)&&e.TaskCountsInSchType.length>0?e.TaskCountsInSchType.map((a,s)=>(0,W.jsxs)(S.A,{variant:"body1",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,W.jsxs)(T.A,{children:["Schedule Type: ",(0,W.jsx)("strong",{children:e.SchType})]}),(0,W.jsxs)(T.A,{textAlign:"right",children:["Total Tasks: ",(0,W.jsx)("strong",{children:a.TotalTasks})," / Completed Tasks: ",(0,W.jsx)("strong",{children:a.CompletedTasks})]})]},s)):(0,W.jsx)(S.A,{variant:"body2",color:"textSecondary",children:"No tasks counted for this schedule type."})}),Array.isArray(e.TaskTypeGroups)&&e.TaskTypeGroups.length>0?e.TaskTypeGroups.map(a=>(0,W.jsxs)(b.A,{expanded:he===a.Task_Type_Id,onChange:()=>{return e=a.Task_Type_Id,void pe(a=>a===e?null:e);var e},sx:{backgroundColor:"#f0f4ff",boxShadow:"black"},children:[(0,W.jsxs)(k.A,{expandIcon:(0,W.jsx)(J.A,{}),children:[(0,W.jsx)(S.A,{fontWeight:"bold",children:a.Task_Type||"Default Task Type"}),(0,W.jsx)(T.A,{sx:{textAlign:"right",flexGrow:1},children:(0,W.jsxs)(S.A,{variant:"h6",children:[(0,W.jsx)(S.A,{fontWeight:"bold",children:"Completed Task / Total Task"}),Array.isArray(a.TaskMetrics)&&a.TaskMetrics.length>0?a.TaskMetrics.map((e,a)=>(0,W.jsxs)(S.A,{sx:{textAlign:"right",flexGrow:1},children:[e.CompletedTasks," / ",null===e||void 0===e?void 0:e.TotalTasks]},a)):(0,W.jsx)(S.A,{variant:"body2",color:"textSecondary",children:"No task metrics available for this task type."})]})})]}),(0,W.jsx)(f.A,{children:Array.isArray(a.Tasks)&&a.Tasks.length>0?a.Tasks.map(a=>(0,W.jsxs)(b.A,{expanded:ue===a.Task_Id,onChange:()=>{return e=a.Task_Id,void xe(a=>a===e?null:e);var e},sx:{marginBottom:2},children:[(0,W.jsx)(k.A,{expandIcon:(0,W.jsx)(J.A,{}),children:(0,W.jsx)(T.A,{sx:{textAlign:"left",flexGrow:1},children:(0,W.jsx)(S.A,{fontWeight:"bold",children:(null===a||void 0===a?void 0:a.Task_Name)||"DEFAULT TASK"})})}),(0,W.jsx)(f.A,{children:(0,W.jsx)(I.A,{style:{maxHeight:"50vh"},children:(0,W.jsxs)(N.A,{stickyHeader:!0,children:[(0,W.jsx)(E.A,{style:{backgroundColor:"#2C3E50"},children:(0,W.jsxs)(C.A,{style:{backgroundColor:"#2C3E50"},children:[(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task"}),(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task Type"}),(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employees"}),(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employee Assign"}),(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Actions"}),(0,W.jsx)(D.A,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Details"})]})}),(0,W.jsxs)(C.A,{sx:{backgroundColor:"#BBE6F6"},children:[(0,W.jsx)(D.A,{children:a.Task_Name}),(0,W.jsxs)(D.A,{children:[e.SchType,(0,W.jsx)(r.A,{onClick:()=>{return e=a,je(!0),X(e),void Ae(!0);var e},children:(0,W.jsx)(m.A,{})})]}),(0,W.jsx)(D.A,{children:Array.isArray(a.AssignedEmployees)&&a.AssignedEmployees.length>0?a.AssignedEmployees.map((e,a)=>(0,W.jsx)(R.A,{label:e.Name,variant:"outlined",size:"small",sx:{margin:"2px",color:"green"}},a)):(0,W.jsx)("span",{children:"No Employees Assigned"})}),(0,W.jsx)(D.A,{children:(0,W.jsx)(r.A,{onClick:()=>(async e=>{L(e),M(!0)})(a),children:(0,W.jsx)(P.A,{})})}),1===Number(null===_e||void 0===_e?void 0:_e.Edit_Rights)&&(0,W.jsx)(D.A,{children:(0,W.jsx)(r.A,{onClick:()=>(L(a),void me(!0)),children:(0,W.jsx)(m.A,{})})}),(0,W.jsx)(D.A,{children:(0,W.jsx)(r.A,{onClick:()=>(async e=>{if(Z(!0),e.Task_Id&&c)try{const a=await(0,x.z)({address:"masters/employeedetails/assignedTaskDetails?Task_Id=".concat(e.Task_Id,"&ProjectId=").concat(c,"&LevelId=").concat(e.Task_Levl_Id)});a.success?V(a.data):console.error(a.message)}catch(a){console.error("Error fetching task details:",a)}else p.oR.error("Task ID and Project ID are required")})(a),children:(0,W.jsx)(w.A,{})})})]},a.Task_Id)]})})})]},a.Task_Id)):(0,W.jsx)(S.A,{variant:"body2",color:"textSecondary",children:"No tasks available for this task type."})})]},a.Task_Type_Id)):(0,W.jsx)(S.A,{variant:"body2",color:"textSecondary",children:"No task type groups found for this schedule type."})]},"".concat(e.SchTypeId||"index","-").concat(a)))]},a)})}),(0,W.jsx)(o.A,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,W.jsx)(A.A,{variant:"contained",color:"primary",onClick:async()=>{s(!1),X({})},children:"Close"})})]}),(0,W.jsxs)(n.A,{open:O,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,W.jsx)(l.A,{children:"Assign Task"}),(0,W.jsxs)(d.A,{children:[(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,W.jsxs)("select",{id:"task-select",value:Q.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{X(a=>(0,g.A)((0,g.A)({},a),{},{Task_Id:e.value,TasksGet:e.label}));try{const a=await(0,x.z)({address:"taskManagement/tasks/tasklistsid?Task_Id=".concat(e.value)});if(a.success){const e=a.data;X(a=>(0,g.A)((0,g.A)({},a),{},{Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Sch_Type_Id:e.Sch_Type_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()}))}else p.oR.error("Failed to fetch task details")}catch(a){p.oR.error(a)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- select -"}),Ne.map((e,a)=>(0,W.jsx)("option",{value:e.value,children:e.label},a))]}),(0,W.jsx)(r.A,{onClick:()=>j(!0),children:(0,W.jsx)(A.A,{variant:"contained",color:"primary",children:"Create New"})})]})}),(0,W.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,W.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,W.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,W.jsxs)("select",{value:Q.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,W.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),Se.map((e,a)=>(0,W.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a))]})]})})]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)(A.A,{onClick:()=>F(!1),children:"Cancel"}),(0,W.jsx)(A.A,{variant:"contained",color:"primary",onClick:async()=>{if(!Q.Task_Id||!Q.Sch_Type_Id)return void p.oR.error("Please select a task and schedule type before saving.");const e={entryBy:oe,Project_Id:c,Sch_Type_Id:Q.Sch_Type_Id,Sch_Est_Start_Date:Q.Task_Est_Start_Date,Sch_Est_End_Date:Q.Task_Est_End_Date,tasks:[Q]};try{const a=await(0,x.z)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e});a.success?(p.oR.success(a.message),F(!1),X({}),Ie(),h()):(a.status,p.oR.warn(a.message||"Task already exists for this project."))}catch(a){p.oR.error(a)}},children:"Save"})]})]}),(0,W.jsx)(K,{open:B,onClose:()=>M(!1),task:z,projectId:c,entryBy:oe,taskId:z,reload:i,onReload:h}),(0,W.jsxs)(n.A,{open:ne,onClose:()=>le(!1),children:[(0,W.jsx)(l.A,{children:"Delete Task"}),(0,W.jsx)(o.A,{children:(0,W.jsx)(A.A,{onClick:()=>le(!1),color:"primary",children:"Cancel"})})]}),(0,W.jsx)(q,{openAction:y,onCloseFun:()=>j(!1),onTaskAdded:fe,Reload:i}),(0,W.jsx)(q,{row:z,openAction:ie,onCloseFun:()=>me(!1),reload:Ie,Reload:i}),(0,W.jsx)(ee,{open:Y,onClose:()=>Z(!1),taskDetails:H})]})},ne=()=>{const[e,a]=(0,t.useState)(!1),[s,g]=(0,t.useState)([]),[A,T]=(0,t.useState)([]),{contextObj:v}=(0,t.useContext)(u.i),[S,b]=(0,t.useState)(!1),[k,f]=(0,t.useState)(null),[I,N]=(0,t.useState)(!1),[E,C]=(0,t.useState)(0),[D,R]=(0,t.useState)(!1),[P,w]=(0,t.useState)(null),[O,F]=(0,t.useState)(!1),[B,M]=(0,t.useState)(!1),[z,L]=(0,t.useState)(""),[U,G]=(0,t.useState)(!1),H=JSON.parse(localStorage.getItem("user"));(0,t.useEffect)(()=>{J(),V()},[null===H||void 0===H?void 0:H.Company_id,e]);const q=()=>{a(e=>!e),G(e=>!e)},J=async()=>{try{const e=await(0,x.z)({address:"taskManagement/project/newProjectAbstract?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});g(e.success?e.data:[])}catch(e){console.error(e),g([])}},V=async()=>{try{const e=await(0,x.z)({address:"taskManagement/project?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});T(e.success?e.data:[])}catch(e){console.error(e),T([])}},Y=()=>{P&&(0,x.z)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===P||void 0===P?void 0:P.Project_Id}}).then(s=>{s.success?(a(!e),p.oR.success(s.message)):p.oR.error(s.message)}).catch(e=>console.error("Fetch Error:",e)),R(!1)},K=[{name:"Project",selector:e=>e.Project_Name,sortable:!0,width:"250px"},{name:"Head",selector:e=>{var a;return null===(a=A.find(a=>a.Project_Id===e.Project_Id))||void 0===a?void 0:a.Project_Head_Name},sortable:!0},{name:"Status",selector:e=>{var a;return null===(a=A.find(a=>a.Project_Id===e.Project_Id))||void 0===a?void 0:a.Status},sortable:!0},{name:"End Date",selector:e=>e.Est_End_Dt?new Date(e.Est_End_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"Progress",selector:e=>{return"".concat((a=e.TodayTaskcounts,s=e.CompletedTasks,0===Number(a)?0:(Number(s)/Number(a)*100).toFixed(0)),"%");var a,s},sortable:!0},{name:"Task Details",cell:e=>(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(r.A,{onClick:()=>X(e),children:(0,W.jsx)(c.A,{})}),e.CompletedTasks," / ",e.TodayTaskcounts]})},{name:"Task Count",selector:e=>null===e||void 0===e?void 0:e.TodayTaskcounts,sortable:!0,sortable:!0},{name:"Assigned",selector:e=>e.TasksAssignedToEmployee},{name:"Employees",cell:e=>(0,W.jsxs)(W.Fragment,{children:[1===Number(null===v||void 0===v?void 0:v.Add_Rights)&&(0,W.jsx)(r.A,{onClick:()=>ee(e.Project_Id),children:(0,W.jsx)(i.A,{})}),e.EmployeesInvolved]})},{name:"Actions",cell:e=>(0,W.jsx)(W.Fragment,{children:1===Number(null===v||void 0===v?void 0:v.Edit_Rights)&&(0,W.jsx)(r.A,{onClick:()=>Q(e),children:(0,W.jsx)(m.A,{})})})}],Z=s.filter(e=>{var a,s;const t=(null===(a=A.find(a=>a.Project_Id===e.Project_Id))||void 0===a?void 0:a.Project_Head_Name)||"",r=(null===(s=A.find(a=>a.Project_Id===e.Project_Id))||void 0===s?void 0:s.Status)||"";return e.Project_Name.toLowerCase().includes(z.toLowerCase())||t.toLowerCase().includes(z.toLowerCase())||r.toLowerCase().includes(z.toLowerCase())}),Q=e=>{f(e),N(!0),b(!0)},X=e=>{f(e),C(e.Project_Id),M(!0)},$=()=>{b(!1),M(!1),f(null),w(null),R(!1)},ee=e=>{C(e),F(!0)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"fw-bold d-flex align-items-center justify-content-between mt-0 ",children:[(0,W.jsx)("span",{style:{marginLeft:"20px"},children:"Projects"}),(0,W.jsxs)("div",{className:"mb-1",style:{display:"flex",alignItems:"center"},children:[(0,W.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,W.jsx)(h.A,{style:{position:"absolute",left:15,color:"#aaa"}}),(0,W.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>L(e.target.value),style:{paddingLeft:35,marginRight:10,margin:10,borderRadius:4,border:"1px solid black"}})]}),1===Number(null===v||void 0===v?void 0:v.Add_Rights)&&(0,W.jsx)("button",{onClick:()=>{f(null),N(!1),b(!0)},className:"btn btn-primary fa-13 shadow",children:"Create Project"})]})]}),(0,W.jsxs)("div",{className:"card-body p-0 table-container",children:[(0,W.jsx)(j.Ay,{columns:K,data:Z,pagination:!0,highlightOnHover:!0,fixedHeader:!0,paginationPerPage:15,responsive:!0,persistTableHead:!0,customStyles:{headCells:{style:{fontSize:"16px",fontWeight:"bold",padding:"10px",backgroundColor:"#2c3e50",color:"#ecf0f1",position:"sticky",top:0,zIndex:2}},cells:{style:{padding:"8px",fontSize:"14px",backgroundColor:"#f9f9f9",color:"#2c3e50"}},rows:{style:{borderBottom:"1px solid #ddd"}}},style:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"}}),(0,W.jsxs)(n.A,{open:D,onClose:$,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,W.jsx)(l.A,{className:"bg-danger text-white mb-2 px-3 py-2",style:{fontSize:"18px"},children:"Confirm Deletion"}),(0,W.jsxs)(d.A,{className:"p-4",style:{fontSize:"16px"},children:["Are you sure you want to delete the project",(0,W.jsx)("span",{className:"text-primary",children:" "+(null===P||void 0===P?void 0:P.Project_Name)+" "}),"?"]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)("button",{onClick:()=>R(!1),className:"btn btn-secondary fa-13 shadow",style:{background:"#95a5a6",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Cancel"}),(0,W.jsx)("button",{onClick:Y,className:"btn btn-danger fa-13 shadow",style:{background:"#e74c3c",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Delete"})]})]})]}),(0,W.jsx)(re,{onClose:$,dialogOpen:B,setDialogOpen:M,isEdit:!1,parseData:H,projectid:E,onReload:q,selectedProject:k,reload:e}),(0,W.jsx)(_.A,{open:S,onClose:$,inputValue:k,isEdit:I,setReload:q,projectData:E}),(0,W.jsx)(y.A,{open:O,onClose:()=>F(!1),projectId:E,onReload:q}),(0,W.jsxs)(n.A,{open:D,onClose:$,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,W.jsx)(l.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,W.jsxs)(d.A,{className:"p-4",children:["Do you want to delete the project",(0,W.jsx)("span",{className:"text-primary",children:" "+(null===P||void 0===P?void 0:P.Project_Name)+" "}),"?"]}),(0,W.jsxs)(o.A,{children:[(0,W.jsx)("button",{onClick:()=>R(!1),className:"btn btn-secondary fa-13 shadow",children:"Cancel"}),(0,W.jsx)("button",{onClick:Y,className:"btn btn-danger fa-13 shadow",children:"Delete"})]})]})]})}},13448:(e,a,s)=>{s.d(a,{A:()=>b});var t=s(89379),r=s(65043),n=s(83462),l=s(29347),d=s(11906),o=s(35316),c=s(79650),i=s(71806),m=s(84882),h=s(28076),p=s(39652),u=s(73460),x=s(26600),_=s(12412),y=s(67784),j=s(65074),g=s(91036),A=s(81e3),T=s(45777),v=s(54750),S=s(70579);const b=e=>{let{open:a,onClose:s,projectId:b,onReload:k}=e;const f={Name:"",Designation_Name:"",BranchName:""},[I,N]=(0,r.useState)(f),[E,C]=(0,r.useState)(!0),[D,R]=(0,r.useState)(!1),[P,w]=(0,r.useState)([]),[O,F]=(0,r.useState)([]),B=localStorage.getItem("user"),M=JSON.parse(B),{contextObj:z}=(0,r.useContext)(T.i);(0,r.useEffect)(()=>{a&&b&&(L(),U(),W())},[a,b]);const L=async()=>{C(!0);try{const e=await(0,j.z)({address:"masters/Employeedetails?Project_Id=".concat(b)});e.success&&N(e.data)}catch(e){console.error(e),g.oR.error("Failed to fetch employee details")}finally{C(!1)}},U=async()=>{C(!0);try{const e=await(0,j.z)({address:"masters/Employeedetails/dropDown?Company_id=".concat(M.Company_id)});e.success&&w(e.data)}catch(e){console.error(e),g.oR.error("Failed to fetch employees for dropdown")}finally{C(!1)}},W=async()=>{C(!0);try{const e=await(0,j.z)({address:"masters/Employeedetails?Project_Id=".concat(b)});e.success&&F(e.data)}catch(e){console.error(e),g.oR.error("Failed to fetch assigned employees")}finally{C(!1)}},G=()=>{s(),N(f)};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(n.A,{open:a,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsxs)(A.A,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,marginInlineStart:2,children:[(0,S.jsx)("span",{children:"Employee Details"}),(0,S.jsx)(l.A,{children:(0,S.jsx)(d.A,{variant:"contained",color:"primary",onClick:()=>{R(!0)},sx:{mr:1},children:"Add"})})]}),(0,S.jsx)(o.A,{children:E?(0,S.jsx)("p",{children:"Loading..."}):(0,S.jsx)(c.A,{children:(0,S.jsxs)(i.A,{children:[(0,S.jsx)(m.A,{children:(0,S.jsxs)(h.A,{children:[(0,S.jsx)(p.A,{children:"Employee Name"}),(0,S.jsx)(p.A,{children:"Position"}),(0,S.jsx)(p.A,{children:"Department"})]})}),(0,S.jsx)(u.A,{children:Array.isArray(I)&&I.length>0?I.map(e=>(0,S.jsxs)(h.A,{children:[(0,S.jsx)(p.A,{children:e.Name||"N/A"}),(0,S.jsx)(p.A,{children:e.Designation_Name||"-"}),(0,S.jsx)(p.A,{children:e.BranchName||"-"})]},e.EmployeeId||e.UserId)):(0,S.jsx)(h.A,{children:(0,S.jsx)(p.A,{colSpan:3,children:"No data available"})})})]})})}),(0,S.jsx)(l.A,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,S.jsx)(d.A,{variant:"contained",color:"primary",onClick:G,children:"Close"})})]}),(0,S.jsxs)(n.A,{open:D,maxWidth:"sm",fullWidth:!0,children:[(0,S.jsx)(x.A,{children:"Add Employee"}),(0,S.jsx)(o.A,{children:(0,S.jsx)(_.A,{multiple:!0,options:P,getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,a)=>e.UserId===a.UserId,onChange:(e,a)=>{const s=a.filter((e,a,s)=>a===s.findIndex(a=>a.UserId===e.UserId));F(s)},PopperComponent:e=>(0,S.jsx)(v.A,(0,t.A)((0,t.A)({},e),{},{placement:"top"})),value:O,onClose:onclose,renderInput:e=>(0,S.jsx)(y.A,(0,t.A)((0,t.A)({},e),{},{placeholder:"Employees"}))})}),(0,S.jsxs)(l.A,{children:[(0,S.jsx)(d.A,{onClick:()=>{R(!1),G(),N(f)},children:"Cancel"}),(0,S.jsx)(d.A,{onClick:async()=>{if(1===Number(null===z||void 0===z?void 0:z.Add_Rights))try{(await(0,j.z)({address:"masters/Employeedetails/employeeAdd",method:"POST",bodyData:{Project_Id:b,UserIds:O.map(e=>e.UserId)}})).success?(g.oR.success("Employees added successfully"),R(!1),await L(),await W(),k()):g.oR.error("Failed to add employees")}catch(e){console.error(e),g.oR.error("Error adding employees")}},variant:"contained",color:"primary",children:"Add"})]})]})]})}},14792:(e,a,s)=>{s.d(a,{A:()=>r});var t=s(70579);const r=()=>(0,t.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},28503:(e,a,s)=>{s.d(a,{A:()=>u});var t=s(89379),r=s(65043),n=s(83462),l=s(26600),d=s(35316),o=s(29347),c=s(65074),i=s(91036),m=(s(92342),s(14792)),h=s(97707),p=s(70579);const u=e=>{let{open:a,onClose:s,inputValue:u,isEdit:x,setReload:_}=e;const y=localStorage.getItem("user"),j=JSON.parse(y),[g,A]=(0,r.useState)([]),[T,v]=(0,r.useState)([]),[S,b]=(0,r.useState)({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,h.ny)(),Est_End_Dt:(0,h.ny)(),Project_Status:"",Entry_By:null===j||void 0===j?void 0:j.UserId,Company_id:null===j||void 0===j?void 0:j.Company_id});(0,r.useEffect)(()=>{(0,c.z)({address:"masters/users/employee/dropDown?Company_id=".concat(null===j||void 0===j?void 0:j.Company_id)}).then(e=>{A(e.success?e.data:[])}).catch(e=>console.error("Fetch Error:",e))},[null===j||void 0===j?void 0:j.Company_id]),(0,r.useEffect)(()=>{(0,c.z)({address:"taskManagement/statusList"}).then(e=>{e.success&&v(e.data)}).catch(e=>console.error("Fetch Error:",e))},[]),(0,r.useEffect)(()=>{a&&(x&&u?b((0,t.A)((0,t.A)({},u),{},{Project_Head:null===u||void 0===u?void 0:u.Project_Head_Id,Est_Start_Dt:u.Est_Start_Dt?(0,h.ny)(u.Est_Start_Dt):"",Est_End_Dt:u.Est_End_Dt?(0,h.ny)(u.Est_End_Dt):"",Project_Status:(null===u||void 0===u?void 0:u.Project_Status)||"",Project_Desc:(null===u||void 0===u?void 0:u.Project_Desc)||"-"})):x||b({Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,h.ny)(),Est_End_Dt:(0,h.ny)(),Project_Status:"",Entry_By:null===j||void 0===j?void 0:j.UserId,Company_id:null===j||void 0===j?void 0:j.Company_id}))},[u,a,x]);const k=e=>{b((0,t.A)((0,t.A)({},S),{},{[e.target.name]:e.target.value}))},f=()=>{const e=["Project_Name","Project_Head","Est_Start_Dt","Est_End_Dt","Project_Status"];for(const a of e)if(!S[a])return i.oR.error("".concat(a.replace(/_/g," ")," is required")),!1;return!0},I=[{label:"Project Name",elem:"input",type:"text",required:!0,name:"Project_Name",value:S.Project_Name||""},{label:"Project Head",elem:"select",options:g.map(e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})),required:!0,name:"Project_Head",value:S.Project_Head||""},{label:"Estimated Start Date",elem:"input",type:"date",required:!0,name:"Est_Start_Dt",value:S.Est_Start_Dt||""},{label:"Estimated End Date",elem:"input",type:"date",required:!0,name:"Est_End_Dt",value:S.Est_End_Dt||""},{label:"Project Status",elem:"select",options:T.map(e=>({value:e.Status_Id,label:e.Status})),required:!0,name:"Project_Status",value:S.Project_Status||""},{label:"Description",elem:"textarea",name:"Project_Desc",value:S.Project_Desc||" "}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(n.A,{open:a,onClose:s,children:[(0,p.jsx)(l.A,{className:"bg-primary text-white mb-2 px-3 py-2",children:x?"Edit Project":"Create Project"}),(0,p.jsx)(d.A,{children:(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x?f()&&(0,c.z)({address:"taskManagement/project",method:"PUT",bodyData:S}).then(e=>{e.success?(s(),_(e=>!e),i.oR.success(e.message)):i.oR.error(e.message)}).catch(e=>console.error("Fetch Error:",e)):(()=>{if(!f())return;const e=(0,t.A)((0,t.A)({},S),{},{Company_id:j.Company_id});(0,c.z)({address:"taskManagement/project",method:"POST",bodyData:e}).then(e=>{e.success?(s(),_(e=>!e),i.oR.success(e.message)):i.oR.error(e.message)}).catch(e=>{console.error("Fetch Error:",e),i.oR.error("An error occurred while creating the project.")})})()},children:[(0,p.jsx)("div",{className:"row",children:I.map((e,a)=>(0,p.jsxs)("div",{className:"col-lg-4 mb-3",children:[(0,p.jsxs)("label",{children:[e.label," ",e.required&&(0,p.jsx)(m.A,{})]}),"textarea"===e.elem?(0,p.jsx)("textarea",{name:e.name,className:"cus-inpt",value:e.value,onChange:k}):"select"===e.elem?(0,p.jsxs)("select",{name:e.name,className:"cus-inpt",value:e.value,onChange:k,children:[(0,p.jsx)("option",{value:"",children:"Select"}),e.options&&e.options.map((e,a)=>(0,p.jsx)("option",{value:e.value,children:e.label},a))]}):(0,p.jsx)("input",{type:e.type,name:e.name,className:"cus-inpt",value:e.value,onChange:k})]},a))}),(0,p.jsxs)(o.A,{children:[(0,p.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:s,children:"Cancel"}),(0,p.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:x?"Update":"Submit"})]})]})})]})})}},63406:(e,a,s)=>{s.d(a,{zU:()=>d,ex:()=>o,MR:()=>l,Ap:()=>n,FX:()=>c});var t=s(89379);const r=s.p+"static/media/smt.aa4d4f940bbebff07a57.png",n={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},l={menu:(e,a)=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999}),menuPortal:e=>(0,t.A)((0,t.A)({},e),{},{zIndex:9999}),groupHeading:e=>(0,t.A)((0,t.A)({},e),{},{backgroundColor:"#f5f5f5",color:"#333",fontWeight:"bold",fontSize:"14px",padding:"8px 12px",borderBottom:"1px solid #ddd",textTransform:"uppercase"}),option:(e,a)=>(0,t.A)((0,t.A)({},e),{},{backgroundColor:a.isSelected?"#2684FF":a.isFocused?"#E2ECF9":"white",color:a.isSelected?"white":"#333",padding:"10px 12px"})},d=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],o=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:r,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:r,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:r,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}],c=[{name:"PURCHASE_ORDER"},{name:"PURCHASE_INVOICE"},{name:"SALE_ORDER"},{name:"SALE_INVOICE"},{name:"JOURNAL"},{name:"STOCK_JOURNAL"},{name:"PAYMENT"},{name:"RECEIPT"},{name:"CONTRA"}]}}]);
//# sourceMappingURL=9730.170b5308.chunk.js.map