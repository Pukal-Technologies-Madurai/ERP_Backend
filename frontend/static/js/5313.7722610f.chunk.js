"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[5313],{24651:(e,s,l)=>{l.d(s,{A:()=>i});var a=l(89379),t=l(65043),o=l(97707),r=l(14844),n=l(70579);const d=function(){var e;let s=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,o.id)(e.Product_Id,s)))&&void 0!==e?e:{}},i=e=>{let{invoiceProducts:s=[],invoiceExpences:l=[],isNotTaxableBill:i,isInclusive:c,IS_IGST:u,products:m=[],invoiceInfo:v={},setInvoiceInfo:p}=e;const h=(0,t.useMemo)(()=>(0,o.$r)(l).reduce((e,s)=>(0,o.Lr)(e,null===s||void 0===s?void 0:s.Expence_Value),0),[l]),x=(0,t.useMemo)(()=>{const e=s.reduce((e,s)=>{const l=(0,o.e3)(null===s||void 0===s?void 0:s.Amount);if(i)return(0,o.Lr)(e,l);const a=d(m,s.Item_Id),t=u?a.Igst_P:a.Gst_P;return c?(0,o.Lr)(e,(0,r.v)(l,t,"remove").with_tax):(0,o.Lr)(e,(0,r.v)(l,t,"add").with_tax)},0);return(0,o.Lr)(e,h)},[s,i,m,u,c,h]),_=(0,t.useMemo)(()=>{if(!s||0===s.length)return{};let e=0,l=0;s.forEach(s=>{const a=(0,o.e3)((null===s||void 0===s?void 0:s.Amount)||0);if(i)return void(e=(0,o.Lr)(e,a));const t=d(m,s.Item_Id),n=(0,o.id)(u,1)?t.Igst_P:t.Gst_P,v=(0,r.v)(a,n,c?"remove":"add");e=(0,o.Lr)(e,parseFloat(v.without_tax)),l=(0,o.Lr)(l,parseFloat(v.tax_amount))});const a=(0,o.Lr)(e,l),t=(0,o.Lr)(a,h),n=Math.round(t),v=(0,o.e3)(n-t),p=(0,o.id)(u,1)?0:(0,o.e3)(l/2),x=(0,o.id)(u,1)?0:(0,o.e3)(l/2),_=(0,o.id)(u,1)?(0,o.e3)(l):0;return{totalTaxable:(0,o.e3)(e),totalTax:(0,o.e3)(l),cgst:p,sgst:x,igst:_,roundOff:v,invoiceTotal:n}},[s,m,u,i,c,h]);return(0,t.useMemo)(()=>{void 0!==_.roundOff&&_.roundOff!==v.Round_off&&p(e=>(0,a.A)((0,a.A)({},e),{},{Round_off:_.roundOff}))},[_.roundOff]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("table",{className:"table",children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{className:"border p-2",rowSpan:u?5:6,children:["Total in words: ",(0,o.GF)(parseInt(x))]}),(0,n.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,n.jsx)("td",{className:"border p-2",children:_.totalTaxable})]}),u?(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"IGST"}),(0,n.jsx)("td",{className:"border p-2",children:_.igst})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"CGST"}),(0,n.jsx)("td",{className:"border p-2",children:_.cgst})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"SGST"}),(0,n.jsx)("td",{className:"border p-2",children:_.sgst})]})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Total Expences"}),(0,n.jsx)("td",{className:"border p-2",children:(0,o.e3)(h)})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,n.jsx)("td",{className:"border p-0",children:(0,n.jsx)("input",{value:v.Round_off||_.roundOff||0,className:"cus-inpt p-2 m-0 border-0",onInput:o.rV,onChange:e=>p(s=>(0,a.A)((0,a.A)({},s),{},{Round_off:parseFloat(e.target.value)||0}))})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Total"}),(0,n.jsx)("td",{className:"border p-2",children:(0,o.jG)(Math.round(x))})]})]})})})}},35786:(e,s,l)=>{l.d(s,{A:()=>p});var a=l(89379),t=l(12110),o=l(11906),r=l(17392),n=(l(48471),l(97707)),d=l(97280),i=(l(65043),l(63406)),c=l(51387),u=l(20656),m=l(14844),v=l(70579);const p=e=>{let{invoiceExpences:s=[],setInvoiceExpences:l,expenceMaster:p=[],IS_IGST:h,taxType:x}=e;return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(t.A,{children:[(0,v.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-wrap px-3 py-2",children:[(0,v.jsx)("h5",{className:"m-0",children:"Expenses"}),(0,v.jsx)(o.A,{variant:"outlined",type:"button",onClick:()=>{l(e=>[...e,(0,a.A)((0,a.A)({},d.ju),{},{Sno:e.length})])},children:"Add"})]}),(0,v.jsx)("div",{className:"table-responsive",children:(0,v.jsxs)("table",{className:"table table-bordered m-0",children:[(0,v.jsx)("thead",{className:"table-light",children:(0,v.jsx)("tr",{children:["S.No","Expense","Expense Value","Action"].map((e,s)=>(0,v.jsx)("th",{className:"fa-13 bg-light",children:e},s))})}),(0,v.jsxs)("tbody",{style:{fontSize:"13px"},children:[s.map((e,t)=>{var o;const d=(null===(o=p.find(s=>(0,n.id)(s.Id,null===e||void 0===e?void 0:e.Expense_Id)))||void 0===o?void 0:o.Expence_Name)||"";return(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:t+1}),(0,v.jsx)("td",{className:"p-0 vctr",style:{minWidth:"180px"},children:(0,v.jsx)(u.Ay,{value:{value:null===e||void 0===e?void 0:e.Expense_Id,label:d},onChange:e=>((e,s)=>{const t=p.find(e=>(0,n.id)(e.Id,s.value))||{};l(s=>s.map((s,l)=>l!==e?s:(0,a.A)((0,a.A)({},s),{},{Expense_Id:t.Id,Expence_Value:0})))})(t,e),options:p.filter(l=>!!(0,n.id)(l.Id,null===e||void 0===e?void 0:e.Expense_Id)||!s.some((e,s)=>s!==t&&(0,n.id)(e.Expense_Id,l.Id))).map(e=>({value:e.Id,label:e.Expence_Name})),styles:i.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Expense"})}),(0,v.jsx)("td",{className:"p-0 vctr",children:(0,v.jsx)("input",{onInput:n.rV,className:"cus-inpt p-2 border-0",value:e.Expence_Value||"",disabled:!(0,n.IQ)(e.Expense_Id),onChange:e=>{((e,s,t)=>{l(l=>l.map((l,o)=>{if(o!==e)return l;const r=(0,a.A)((0,a.A)({},l),{},{[s]:t});if("Expence_Value"===s){const e=l.Cgst?(0,n.Ro)(l.Cgst):0,s=l.Sgst?(0,n.Ro)(l.Sgst):0,a=l.Igst?(0,n.Ro)(l.Igst):0,o=(0,n.Ro)(t),d=h?a:(0,n.Lr)(e,s),i=(0,m.v)(o,d,x);r.Cgst_Amo=e>0&&!h?i.cgst_amount:0,r.Sgst_Amo=s>0&&!h?i.sgst_amount:0,r.Igst_Amo=a>0&&h?i.igst_amount:0}if("Igst"===s){const e=h?(0,n.Ro)(t):0,s=h?0:(0,n.SX)((0,n.Ro)(t),2),a=h?0:(0,n.SX)((0,n.Ro)(t),2),o=(0,n.Ro)(l.Expence_Value),d=h?e:(0,n.Lr)(s,a),i=(0,m.v)(o,d,x);r.Cgst=s,r.Sgst=a,r.Cgst_Amo=s>0?i.cgst_amount:0,r.Sgst_Amo=a>0?i.sgst_amount:0,r.Igst_Amo=e>0?i.igst_amount:0}return r}))})(t,"Expence_Value",e.target.value)}})}),(0,v.jsx)("td",{className:"p-0 vctr  text-center ",children:(0,v.jsx)(r.A,{onClick:()=>(e=>{l(s=>s.filter((s,l)=>l!==e))})(t),size:"small",children:(0,v.jsx)(c.A,{color:"error",fontSize:"small"})})})]},t)}),0===s.length&&(0,v.jsx)("tr",{children:(0,v.jsx)("td",{className:"text-center",colSpan:6,children:"No rows"})})]})]})})]})})}},38641:(e,s,l)=>{l.d(s,{A:()=>i});var a=l(89379),t=(l(65043),l(20656)),o=l(63406),r=l(97707),n=l(14792),d=l(70579);const i=e=>{var s;let{invoiceInfo:l={},setInvoiceInfo:i,retailers:c=[],voucherType:u=[],branches:m=[],onChangeRetailer:v,stockItemLedgerName:p=[]}=e;const h="cus-inpt p-2";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Party Name"}),(0,d.jsx)(t.Ay,{value:{value:null===l||void 0===l?void 0:l.Retailer_Id,label:null===l||void 0===l?void 0:l.Retailer_Name},onChange:e=>{i(s=>(0,a.A)((0,a.A)({},s),{},{Retailer_Id:e.value,Retailer_Name:e.label})),v&&v()},options:[{value:"",label:"Search",isDisabled:!0},...(0,r.$r)(c).map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:o.MR,isSearchable:!0,placeholder:"Select Vendor",maxMenuHeight:300})]}),(0,d.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Voucher Type"}),(0,d.jsx)(t.Ay,{value:{value:l.Voucher_Type,label:null===(s=(0,r.$r)(u).find(e=>(0,r.id)(e.Vocher_Type_Id,l.Voucher_Type)))||void 0===s?void 0:s.Voucher_Type},onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Voucher_Type:e.value})),options:[{value:"",label:"Search",isDisabled:!0},...(0,r.$r)(u).filter(e=>"SALES"===(null===e||void 0===e?void 0:e.Type)).map(e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type}))],styles:o.MR,isSearchable:!0,required:!0,placeholder:"Select Voucher Type",maxMenuHeight:300,isDisabled:!!(0,r.IQ)(null===l||void 0===l?void 0:l.Do_Id)})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["Entry Date ",(0,d.jsx)(n.A,{})]}),(0,d.jsx)("input",{value:null===l||void 0===l?void 0:l.Do_Date,type:"date",required:!0,className:h,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Do_Date:e.target.value}))})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["Branch ",(0,d.jsx)(n.A,{})]}),(0,d.jsxs)("select",{className:h,value:null===l||void 0===l?void 0:l.Branch_Id,required:!0,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Branch_Id:e.target.value})),children:[(0,d.jsx)("option",{value:"",children:"select"}),m.map((e,s)=>(0,d.jsx)("option",{value:null===e||void 0===e?void 0:e.BranchId,children:null===e||void 0===e?void 0:e.BranchName},s))]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["GST Type ",(0,d.jsx)(n.A,{})]}),(0,d.jsxs)("select",{className:h,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{GST_Inclusive:Number(e.target.value)})),value:l.GST_Inclusive,required:!0,children:[(0,d.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,d.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,d.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Tax Type"}),(0,d.jsxs)("select",{className:h,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{IS_IGST:Number(e.target.value)})),value:l.IS_IGST,children:[(0,d.jsx)("option",{value:"0",children:"GST"}),(0,d.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Stock Item Ledger Name"}),(0,d.jsx)(t.Ay,{value:{value:l.Stock_Item_Ledger_Name,label:l.Stock_Item_Ledger_Name},onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Stock_Item_Ledger_Name:e.value})),options:[{value:"",label:"Search",isDisabled:!0},...p.map(e=>({value:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name,label:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name}))],styles:o.MR,menuPortalTarget:document.body,required:!0,isSearchable:!0,placeholder:"Select",maxMenuHeight:300})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Status"}),(0,d.jsxs)("select",{value:null===l||void 0===l?void 0:l.Cancel_status,className:h,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Cancel_status:e.target.value})),children:[(0,d.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,d.jsx)("option",{value:"1",children:"New"}),(0,d.jsx)("option",{value:"2",children:"Progess"}),(0,d.jsx)("option",{value:"3",children:"Completed"}),(0,d.jsx)("option",{value:"0",children:"Canceled"})]})]})]}),(0,d.jsx)("label",{className:"fa-13",children:"Narration"}),(0,d.jsx)("textarea",{className:"cus-inpt fa-14",rows:2,value:l.Narration,onChange:e=>i(s=>(0,a.A)((0,a.A)({},s),{},{Narration:e.target.value}))})]})}},44676:(e,s,l)=>{l.d(s,{A:()=>o});var a=l(59662),t=l(70579);const o=(0,a.A)([(0,t.jsx)("path",{d:"M19.5 3.5 18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2v14H3v3c0 1.66 1.34 3 3 3h12c1.66 0 3-1.34 3-3V2zM19 19c0 .55-.45 1-1 1s-1-.45-1-1v-3H8V5h11z"},"0"),(0,t.jsx)("path",{d:"M9 7h6v2H9zm7 0h2v2h-2zm-7 3h6v2H9zm7 0h2v2h-2z"},"1")],"ReceiptLong")},65313:(e,s,l)=>{l.r(s),l.d(s,{default:()=>w});var a=l(89379),t=l(65043),o=l(12110),r=l(11906),n=l(26494),d=l(17392),i=l(63406),c=l(91036),u=l(97707),m=l(70141),v=l(44676),p=l(83560),h=l(51387),x=l(65074),_=l(48471),g=l(14844),I=l(73216),j=l(97280),f=l(20656),b=l(70579);const A=e=>{let{StaffArray:s=[],setStaffArray:l,costCenter:t=[],costCategory:o=[]}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,b.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,b.jsx)(r.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>l(e=>[...e,(0,a.A)({},j.Ud)]),children:"Add"})]}),(0,b.jsxs)("table",{className:"table table-bordered",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"fa-13",children:"Sno"}),(0,b.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,b.jsx)("th",{className:"fa-13",children:"Category"}),(0,b.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,b.jsx)("tbody",{children:(0,u.$r)(s).map((e,r)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"fa-13 vctr text-center",children:r+1}),(0,b.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,b.jsx)(f.Ay,{value:{value:null===e||void 0===e?void 0:e.Emp_Id,label:null===e||void 0===e?void 0:e.Emp_Name},onChange:e=>l(s=>s.map((s,l)=>{if((0,u.id)(l,r)){const l=(0,u.$r)(t).find(s=>(0,u.id)(null===s||void 0===s?void 0:s.Cost_Center_Id,e.value));return(0,a.A)((0,a.A)({},s),{},{Emp_Type_Id:(0,u.IQ)(null===s||void 0===s?void 0:s.Emp_Type_Id)?Number(null===s||void 0===s?void 0:s.Emp_Type_Id):(0,u.IQ)(l.User_Type)?Number(l.User_Type):0,Emp_Id:Number(e.value),Emp_Name:e.label})}return s})),options:[...(0,u.$r)(t).filter(e=>!s.some(s=>(0,u.id)(s.Emp_Id,e.Cost_Center_Id)))].map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:i.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,b.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,b.jsxs)("select",{value:null===e||void 0===e?void 0:e.Emp_Type_Id,onChange:e=>l(s=>s.map((s,l)=>(0,u.id)(l,r)?(0,a.A)((0,a.A)({},s),{},{Emp_Type_Id:e.target.value}):s)),className:"cus-inpt p-2 border-0",children:[(0,b.jsx)("option",{value:"",children:"Select"}),(0,u.$r)(o).map((e,s)=>(0,b.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},s))]})}),(0,b.jsx)("td",{className:"fa-13 vctr p-0",children:(0,b.jsx)(d.A,{onClick:()=>{l(e=>e.filter((e,s)=>r!==s))},size:"small",children:(0,b.jsx)(h.A,{color:"error"})})})]},r))})]})]})};var N=l(38641),S=l(24651),y=l(56779),C=l(34104),T=l(35786);const E=(0,u.aN)().user,w=e=>{let{loadingOn:s,loadingOff:l}=e;const i=(0,I.Zp)(),f=(0,I.zy)().state,[w,L]=(0,t.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],brand:[],godown:[],expence:[],stockInGodown:[],stockItemLedgerName:[]}),[R,G]=(0,t.useState)({addProductDialog:!1,importFromSaleOrder:!1}),[k,P]=(0,t.useState)(j.Q4),[V,z]=(0,t.useState)([]),[O,M]=(0,t.useState)([]),[D,F]=(0,t.useState)([]),[Q,B]=(0,t.useState)(null),H=(0,u.id)(k.GST_Inclusive,1),$=(0,u.id)(k.GST_Inclusive,2),U=(0,u.id)(k.IS_IGST,1),q=$?"zerotax":H?"remove":"add",W=3-V.length;(0,t.useEffect)(()=>{(async()=>{try{s&&s();const[e,l,t,o,r,n,d,i,c,m,v]=await Promise.all([(0,x.z)({address:"masters/branch/dropDown"}),(0,x.z)({address:"masters/products"}),(0,x.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===E||void 0===E?void 0:E.Company_id)}),(0,x.z)({address:"purchase/voucherType"}),(0,x.z)({address:"masters/uom"}),(0,x.z)({address:"dataEntry/costCenter"}),(0,x.z)({address:"dataEntry/costCenter/category"}),(0,x.z)({address:"dataEntry/godownLocationMaster"}),(0,x.z)({address:"masters/defaultAccountMaster"}),(0,x.z)({address:"sales/stockInGodown"}),(0,x.z)({address:"purchase/stockItemLedgerName?type=SALES"})]),p=(e.success?e.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===s||void 0===s?void 0:s.BranchName)),h=(l.success?l.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===s||void 0===s?void 0:s.Product_Name)),_=(t.success?t.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===s||void 0===s?void 0:s.Retailer_Name)),g=(o.success?o.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===s||void 0===s?void 0:s.Voucher_Type)),I=(r.success?r.data:[]).sort((e,s)=>String(e.Units).localeCompare(s.Units)),j=(n.success?n.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===s||void 0===s?void 0:s.Cost_Center_Name)),f=(d.success?d.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===s||void 0===s?void 0:s.Cost_Category)),b=(i.success?i.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Godown_Name).localeCompare(null===s||void 0===s?void 0:s.Godown_Name)),A=(c.success?(0,u.$r)(c.data):[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Account_Name).localeCompare(null===s||void 0===s?void 0:s.Account_Name)),N=(m.success?m.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.stock_item_name).localeCompare(null===s||void 0===s?void 0:s.stock_item_name)),S=(v.success?v.data:[]).sort((e,s)=>String(null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name).localeCompare(null===s||void 0===s?void 0:s.Stock_Item_Ledger_Name));L(e=>(0,a.A)((0,a.A)({},e),{},{products:h,branch:p,retailers:_,voucherType:g,uom:I,staff:j,staffType:f,godown:b,brand:(0,u.Mn)(h,"Brand",["Brand_Name"]),expence:A.filter(e=>!(0,u.xL)(e.Type,"DEFAULT")).map(e=>({Id:e.Acc_Id,Expence_Name:e.Account_Name})),stockInGodown:N,stockItemLedgerName:S}))}catch(e){console.error("Error fetching data:",e)}finally{l&&l()}})()},[null===E||void 0===E?void 0:E.Company_id]);(0,t.useEffect)(()=>{z(e=>[...e].map(e=>Object.fromEntries(Object.entries(e).map(s=>{let[l,a]=s;const t=function(){var e;let s=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,u.id)(e.Product_Id,s)))&&void 0!==e?e:{}}(w.products,null===e||void 0===e?void 0:e.Item_Id),o=U?t.Igst_P:t.Gst_P,r=o>0,{Bill_Qty:n,Item_Rate:d,Amount:i}=e,c=(0,g.v)(d,o,q),m=(0,g.v)(i,o,q),v=U?0:m.cgst_per,p=U?m.igst_per:0,h=U?0:m.cgst_amount,x=U?m.igst_amount:0;switch(l){case"Taxable_Rate":return[l,c.base_amount];case"Total_Qty":return[l,n];case"Taxble":return[l,r?1:0];case"Taxable_Amount":return[l,m.base_amount];case"Tax_Rate":return[l,o];case"Cgst":case"Sgst":return[l,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[l,$?0:h];case"Igst":return[l,null!==p&&void 0!==p?p:0];case"Igst_Amo":return[l,$?0:x];case"Final_Amo":return[l,m.with_tax];default:return[l,e[l]||a]}}))))},[w.products,U,q]),(0,t.useEffect)(()=>{M(e=>[...e].map(e=>{const s=U?(0,u.Ro)(null===e||void 0===e?void 0:e.Igst):0,l=U?0:(0,u.Ro)(null===e||void 0===e?void 0:e.Cgst),t=U?0:(0,u.Ro)(null===e||void 0===e?void 0:e.Sgst),o=(0,u.Ro)(null===e||void 0===e?void 0:e.Expence_Value),r=U?s:(0,u.Lr)(l,t),n=(0,g.v)(o,r,q);return(0,a.A)((0,a.A)({},e),{},{Cgst:l,Sgst:t,Igst:s,Expence_Value:o,Cgst_Amo:l>0?n.cgst_amount:0,Sgst_Amo:t>0?n.sgst_amount:0,Igst_Amo:s>0?n.igst_amount:0})}))},[w.expence,U,q]),(0,t.useEffect)(()=>{if((0,u.aF)(f)&&Array.isArray(null===f||void 0===f?void 0:f.Products_List)){const{Products_List:e,Expence_Array:s,Staffs_Array:l}=f;P(Object.fromEntries(Object.entries(j.Q4).map(e=>{var s;let[l,a]=e;return"Do_Date"===l?[l,f[l]?(0,u.ny)(f[l]):a]:[l,null!==(s=f[l])&&void 0!==s?s:a]}))),z(e.map(e=>Object.fromEntries(Object.entries(j.a4).map(s=>{var l;let[a,t]=s;return[a,null!==(l=e[a])&&void 0!==l?l:t]})))),M((0,u.$r)(s).map(e=>Object.fromEntries(Object.entries(j.ju).map(s=>{var l;let[a,t]=s;return[a,null!==(l=e[a])&&void 0!==l?l:t]})))),F((0,u.$r)(l).map(e=>Object.fromEntries(Object.entries(j.Ud).map(s=>{var l;let[a,t]=s;return[a,null!==(l=e[a])&&void 0!==l?l:t]}))))}},[f]);const X=()=>{s&&s(),(0,x.z)({address:"sales/salesInvoice",method:(0,u.IQ)(null===k||void 0===k?void 0:k.Do_Id)?"PUT":"POST",bodyData:(0,a.A)((0,a.A)({},k),{},{Product_Array:V,Staffs_Array:D,Expence_Array:O})}).then(e=>{e.success?(P(j.Q4),z([]),M([]),F([]),c.oR.success(e.message),i("/erp/sales/invoice")):c.oR.warn(e.message)}).catch(e=>console.error(e)).finally(()=>{l&&l()})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(y.A,{orderProducts:V,setOrderProducts:z,open:R.addProductDialog,onClose:()=>{G(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!1})),B(null)},products:w.products,brands:w.brand,uom:w.uom,godowns:w.godown,GST_Inclusive:k.GST_Inclusive,IS_IGST:U,editValues:Q,initialValue:(0,a.A)((0,a.A)({},j.a4),{},{Pre_Id:k.So_No}),stockInGodown:w.stockInGodown}),(0,b.jsxs)(o.A,{children:[(0,b.jsxs)("div",{className:"d-flex flex-wrap align-items-center border-bottom py-2 px-3",children:[(0,b.jsx)("span",{className:"flex-grow-1 fa-16 fw-bold",children:"Sales Invoice"}),(0,b.jsxs)("span",{children:[(0,b.jsx)(r.A,{type:"button",onClick:()=>{window.history.length>1?i(-1):i("/erp/sales/invoice")},children:"Cancel"}),(0,b.jsx)(r.A,{onClick:()=>X(),variant:"contained",children:"submit"})]})]}),(0,b.jsxs)(n.A,{children:[(0,b.jsxs)("div",{className:"row p-0",children:[(0,b.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,b.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,b.jsx)(A,{StaffArray:D,setStaffArray:F,costCenter:w.staff,costCategory:w.staffType})})}),(0,b.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,b.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,b.jsx)(N.A,{invoiceInfo:k,setInvoiceInfo:P,retailers:w.retailers,branches:w.branch,voucherType:w.voucherType,stockItemLedgerName:w.stockItemLedgerName,onChangeRetailer:()=>{z([]),M([])}})})})]}),(0,b.jsx)(_.Ay,{title:"Items",headerFontSizePx:13,bodyFontSizePx:13,EnableSerialNumber:!0,disablePagination:!0,ButtonArea:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.A,{onClick:()=>{B(null),G(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!0}))},sx:{ml:1},variant:"outlined",type:"button",startIcon:(0,b.jsx)(m.A,{}),disabled:!(0,u.IQ)(k.Retailer_Id)||V.length>0&&(0,u.IQ)(k.So_No),children:"Add Product"}),(0,b.jsx)(C.A,{loadingOn:s,loadingOff:l,open:R.importFromSaleOrder,onClose:()=>G(e=>(0,a.A)((0,a.A)({},e),{},{importFromSaleOrder:!1})),retailer:null===k||void 0===k?void 0:k.Retailer_Id,selectedItems:V,setSelectedItems:z,staffArray:D,setStaffArray:F,products:w.products,GST_Inclusive:k.GST_Inclusive,IS_IGST:U,invoiceInfo:k,setInvoiceInfo:P,godowns:w.godown,stockInGodown:w.stockInGodown,children:(0,b.jsx)(r.A,{onClick:()=>G(e=>(0,a.A)((0,a.A)({},e),{},{importFromSaleOrder:!0})),disabled:!(0,u.IQ)(k.Retailer_Id)||V.length>0&&!(0,u.IQ)(k.So_No),sx:{ml:1},type:"button",variant:"outlined",startIcon:(0,b.jsx)(v.A,{}),children:"Choose Sale Order"})})]}),dataArray:[...V,...Array.from({length:W>0?W:0}).map(e=>j.a4)],columns:[(0,_.Lj)("Item_Name","string"),(0,_.Lj)("HSN_Code","string"),(0,_.Lj)("Bill_Qty","number"),(0,_.Lj)("Act_Qty","number"),(0,_.Lj)("Item_Rate","number"),{isVisible:1,ColumnHeader:"Tax",isCustomCell:!0,Cell:e=>{let{row:s}=e;const{Cgst:l=0,Sgst:a=0,Igst:t=0,Cgst_Amo:o=0,Sgst_Amo:r=0,Igst_Amo:n=0}=s,d=U?t:(0,u.Lr)(l,a),i=U?n:(0,u.Lr)(o,r);return(0,u.IQ)(null===s||void 0===s?void 0:s.Item_Id)?"".concat(i," - (").concat(d," %)"):""}},{isVisible:1,ColumnHeader:"Godown",isCustomCell:!0,Cell:e=>{var s,l;let{row:a}=e;return null!==(s=null===(l=w.godown.find(e=>(0,u.id)(e.Godown_Id,null===a||void 0===a?void 0:a.GoDown_Id)))||void 0===l?void 0:l.Godown_Name)&&void 0!==s?s:""}},(0,_.Lj)("Amount","number"),{isCustomCell:!0,Cell:e=>{let{row:s}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.A,{onClick:()=>{B(s),G(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!0}))},size:"small",type:"button",disabled:!(0,u.IQ)(null===s||void 0===s?void 0:s.Item_Id),children:(0,b.jsx)(p.A,{})}),(0,b.jsx)(d.A,{size:"small",type:"button",onClick:()=>z(e=>e.filter(e=>!(0,u.id)(e.Item_Id,s.Item_Id))),color:"error",disabled:!(0,u.IQ)(null===s||void 0===s?void 0:s.Item_Id),children:(0,b.jsx)(h.A,{})})]})},ColumnHeader:"Action",isVisible:1}]}),(0,b.jsx)("br",{}),(0,b.jsx)(T.A,{invoiceExpences:O,setInvoiceExpences:M,expenceMaster:w.expence,IS_IGST:U,taxType:q}),(0,b.jsx)("br",{}),(0,b.jsx)(S.A,{invoiceProducts:V,invoiceExpences:O,isNotTaxableBill:$,isInclusive:H,IS_IGST:U,products:w.products,invoiceInfo:k,setInvoiceInfo:P})]})]})]})}},83560:(e,s,l)=>{l.d(s,{A:()=>o});var a=l(59662),t=l(70579);const o=(0,a.A)((0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")}}]);
//# sourceMappingURL=5313.7722610f.chunk.js.map