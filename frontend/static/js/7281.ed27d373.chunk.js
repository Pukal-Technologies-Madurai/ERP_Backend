"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[7281],{18584:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),d=t(70579);const s=(0,a.A)((0,d.jsx)("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"}),"Done")},30079:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),d=t(70579);const s=(0,a.A)((0,d.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear")},34104:(e,l,t)=>{t.d(l,{A:()=>x,K:()=>h});var a=t(89379),d=t(65043),s=t(22520),o=t(83462),n=t(26600),r=t(17392),i=t(35316),c=t(11906),u=t(65074),v=t(18584),m=t(97280),_=t(14844),I=(t(63406),t(70579));const h=(e,l,t)=>{var a;const d=null===(a=(0,s.$r)(t).find(t=>(0,s.id)(null===t||void 0===t?void 0:t.Product_Id,e)&&(0,s.id)(null===t||void 0===t?void 0:t.Godown_Id,l)))||void 0===a?void 0:a.Act_Bal_Qty;return(0,s.Ro)(d)},x=e=>{let{loadingOn:l,loadingOff:t,open:x,onClose:p,retailer:j,children:A,selectedItems:b=[],setSelectedItems:g,staffArray:N=[],setStaffArray:y,products:f=[],GST_Inclusive:S,IS_IGST:T,invoiceInfo:C={},setInvoiceInfo:G,godowns:w=[],stockInGodown:P=[]}=e;const R=(0,s.id)(S,1),D=(0,s.id)(S,2),[B,O]=(0,d.useState)([]),[Q,E]=(0,d.useState)({Fromdate:(0,s.ny)(),Todate:(0,s.ny)(),search:!1,Godown:{value:"",label:"Select Godown For Stock Details"}});(0,d.useEffect)(()=>{if((0,s.IQ)(j)&&x){const{Fromdate:e,Todate:a}=Q;l&&l(),(0,u.z)({address:"sales/saleOrder?Fromdate=".concat(e,"&Todate=").concat(a,"&Retailer_Id=").concat(j)}).then(e=>{e.success?O(e.data):O([])}).catch(e=>console.error(e)).finally(()=>{t&&t()})}},[Q.search]);const U=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(arguments.length>2?arguments[2]:void 0)return G(e=>(0,a.A)((0,a.A)({},e),{},{So_No:""})),void g([]);G(l=>(0,a.A)((0,a.A)({},l),{},{So_No:Number(null===e||void 0===e?void 0:e.So_Id)})),g(t=>{const a=[...t];return(0,s.$r)(null===e||void 0===e?void 0:e.Products_List).map((e,t)=>Object.fromEntries(Object.entries(m.a4).map(d=>{var o,n,r,i,c,u,v,m;let[I,h]=d;const x=(e=>{var l;return null!==(l=null===f||void 0===f?void 0:f.find(l=>(0,s.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}})(e.Item_Id),p=T?x.Igst_P:x.Gst_P,j=p>0,{Item_Rate:A,Bill_Qty:b,Amount:g}=e,N=D?"zerotax":R?"remove":"add",y=(0,_.v)(A,p,N),S=(0,_.v)(g,p,N),C=T?0:S.cgst_per,G=T?S.igst_per:0,w=T?0:S.cgst_amount,P=T?S.igst_amount:0;switch(I){case"rowId":return[I,(0,s.aG)()];case"S_No":return[I,null!==(o=t+1)&&void 0!==o?o:h];case"Item_Id":return[I,null!==(n=e.Item_Id)&&void 0!==n?n:h];case"Item_Name":return[I,null!==(r=null===x||void 0===x?void 0:x.Product_Name)&&void 0!==r?r:h];case"Item_Rate":return[I,(0,s.Ro)(A)];case"Bill_Qty":case"Act_Qty":case"Alt_Act_Qty":case"Total_Qty":return[I,(0,s.Ro)(b)];case"Amount":return[I,g];case"HSN_Code":return[I,null!==(i=x.HSN_Code)&&void 0!==i?i:h];case"Unit_Id":return[I,null!==(c=e.Unit_Id)&&void 0!==c?c:h];case"Act_unit_Id":return[I,null!==(u=e.Unit_Id)&&void 0!==u?u:h];case"Alt_Act_Unit_Id":return[I,null!==(v=e.Unit_Id)&&void 0!==v?v:h];case"Unit_Name":return[I,null!==(m=e.Units)&&void 0!==m?m:h];case"GoDown_Id":{var B;const t=(0,s.IQ)(null===l||void 0===l?void 0:l.Godown_Id),d=(0,s.IQ)(null===l||void 0===l?void 0:l.Item_Id),o=(0,s.id)(null===e||void 0===e?void 0:e.Item_Id,null===l||void 0===l?void 0:l.Item_Id),n=null===(B=a.find(l=>(0,s.id)(l.Item_Id,null===e||void 0===e?void 0:e.Item_Id)))||void 0===B?void 0:B.GoDown_Id;return[I,t&&d&&o?l.Godown_Id:(0,s.IQ)(n)?n:h]}case"Taxable_Rate":return[I,y.base_amount];case"Taxble":return[I,j?1:0];case"Taxable_Amount":return[I,S.base_amount];case"Tax_Rate":return[I,p];case"Cgst":case"Sgst":return[I,null!==C&&void 0!==C?C:0];case"Cgst_Amo":case"Sgst_Amo":return[I,D?0:w];case"Igst":return[I,null!==G&&void 0!==G?G:0];case"Igst_Amo":return[I,D?0:P];case"Final_Amo":return[I,S.with_tax];default:return[I,h]}})))});const t=[...new Map((0,s.$r)(null===e||void 0===e?void 0:e.Staff_Involved_List).filter(e=>!N.some(l=>(0,s.id)(l.Emp_Id,e.Involved_Emp_Id))).map(e=>[e.Involved_Emp_Id,e])).values()];t.length>0&&y(e=>[...e,...t.map(e=>Object.fromEntries(Object.entries(m.Ud).map(l=>{let[t,a]=l;switch(t){case"Emp_Id":return[t,null===e||void 0===e?void 0:e.Involved_Emp_Id];case"Emp_Name":return[t,null===e||void 0===e?void 0:e.EmpName];case"Emp_Type_Id":return[t,null===e||void 0===e?void 0:e.Cost_Center_Type_Id];default:return[t,a]}})))])},k=()=>{p&&p(),O([])};return(0,I.jsxs)(I.Fragment,{children:[A,(0,I.jsxs)(o.A,{open:x,onClose:k,fullScreen:!0,children:[(0,I.jsx)(n.A,{children:(0,I.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,I.jsx)("span",{className:"flex-grow-1",children:"Select Sale Order"}),(0,I.jsx)(r.A,{onClick:k,color:"success",children:(0,I.jsx)(v.A,{className:"fa-20"})})]})}),(0,I.jsxs)(i.A,{children:[(0,I.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,I.jsxs)("div",{className:"p-2",children:[(0,I.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,I.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===Q||void 0===Q?void 0:Q.Fromdate,onChange:e=>E(l=>(0,a.A)((0,a.A)({},l),{},{Fromdate:e.target.value})),required:!0})]}),(0,I.jsxs)("div",{className:"p-2",children:[(0,I.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,I.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",min:Q.Fromdate,value:null===Q||void 0===Q?void 0:Q.Todate,onChange:e=>E(l=>(0,a.A)((0,a.A)({},l),{},{Todate:e.target.value})),required:!0})]}),(0,I.jsx)("div",{className:"p-2",children:(0,I.jsx)(c.A,{variant:"outlined",type:"button",onClick:()=>E(e=>(0,a.A)((0,a.A)({},e),{},{search:!e.search})),children:"search"})})]}),(0,I.jsx)("br",{}),B.map((e,l)=>{const{So_Inv_No:t,So_Date:a,VoucherTypeGet:d,Branch_Name:o,Sales_Person_Name:n,Total_Tax:r,Total_Invoice_value:i,Products_List:c}=e,u=(0,s.id)(null===C||void 0===C?void 0:C.So_No,e.So_Id);return(0,I.jsx)("div",{className:"container-fluid",children:(0,I.jsxs)("div",{className:"\n                                        invoice-card bg-white p-4 shadow-sm mb-4 border rounded  \n                                        ".concat(u?" border-primary ":"","\n                                        "),children:[(0,I.jsxs)("h5",{className:"d-flex align-items-center flex-wrap",children:[(0,I.jsx)("span",{className:"me-2",children:(0,I.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:u,onChange:()=>{U(e,null,!!u)}})}),(0,I.jsxs)("span",{children:["Invoice No: ",(0,I.jsx)("span",{className:"text-primary",children:t})]})]}),(0,I.jsxs)("div",{className:"invoice-header d-flex justify-content-between flex-wrap border-bottom pb-3 mb-3",children:[(0,I.jsxs)("div",{children:[(0,I.jsxs)("div",{children:[(0,I.jsx)("strong",{children:"Invoice Date:"})," ",(0,s.yc)(a)]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("strong",{children:"Voucher Type:"})," ",d]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("strong",{children:"Branch:"})," ",o]})]}),(0,I.jsxs)("div",{className:"text-end",children:[(0,I.jsxs)("h5",{className:"mt-2",children:[(0,I.jsx)("strong",{children:"Total Invoice:"})," \u20b9",i]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("strong",{children:"Tax:"})," \u20b9",r]}),(0,I.jsxs)("div",{children:[(0,I.jsx)("strong",{children:"Salesperson:"})," ",n]})]})]}),(0,I.jsx)("div",{className:"table-responsive",children:(0,I.jsxs)("table",{className:"table table-bordered table-striped product-table",children:[(0,I.jsx)("thead",{className:"table-light",children:(0,I.jsx)("tr",{children:["#","Product","Qty","Rate","Amount","Tax %","Final Amount","Godown"].map((e,l)=>(0,I.jsx)("th",{style:{minWidth:"150px",maxWidth:"160px"},children:e},l))})}),(0,I.jsx)("tbody",{children:c.map((l,t)=>{var a;return(0,I.jsxs)("tr",{children:[(0,I.jsx)("td",{children:t+1}),(0,I.jsx)("td",{children:l.Product_Name}),(0,I.jsxs)("td",{children:[l.Bill_Qty,(0,s.IQ)(Q.Godown.value)&&" (Bal: "+h(l.Item_Id,Q.Godown.value,P)+") "]}),(0,I.jsxs)("td",{children:["\u20b9",l.Item_Rate]}),(0,I.jsxs)("td",{children:["\u20b9",l.Amount]}),(0,I.jsxs)("td",{children:[l.Tax_Rate,"%"]}),(0,I.jsxs)("td",{children:["\u20b9",l.Final_Amo]}),(0,I.jsx)("td",{children:(0,I.jsxs)("select",{disabled:!u,className:"cus-inpt p-2",value:null===(a=(0,s.$r)(w).find(e=>(0,s.$r)(b).find(t=>(0,s.id)(t.Item_Id,null===l||void 0===l?void 0:l.Item_Id)&&u&&(0,s.id)(null===e||void 0===e?void 0:e.Godown_Id,null===t||void 0===t?void 0:t.GoDown_Id))))||void 0===a?void 0:a.Godown_Id,onChange:t=>U(e,{Godown_Id:t.target.value,Item_Id:null===l||void 0===l?void 0:l.Item_Id},!1),children:[(0,I.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,I.jsx)("optgroup",{label:"Stock-Available-Godown",children:(0,s.$r)(w).filter(e=>(0,s.$r)(P).some(t=>(0,s.id)(null===t||void 0===t?void 0:t.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,s.id)(null===l||void 0===l?void 0:l.Item_Id,null===t||void 0===t?void 0:t.Product_Id))).map((e,t)=>(0,I.jsx)("option",{value:null===e||void 0===e?void 0:e.Godown_Id,children:(null===e||void 0===e?void 0:e.Godown_Name)+" (Bal: "+h(null===l||void 0===l?void 0:l.Item_Id,null===e||void 0===e?void 0:e.Godown_Id,P)+")"},t))}),(0,I.jsx)("optgroup",{label:"Other-Godown",children:(0,s.$r)(w).filter(e=>!(0,s.$r)(P).some(t=>(0,s.id)(null===t||void 0===t?void 0:t.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,s.id)(null===l||void 0===l?void 0:l.Item_Id,null===t||void 0===t?void 0:t.Product_Id))).map((e,l)=>(0,I.jsx)("option",{value:null===e||void 0===e?void 0:e.Godown_Id,children:null===e||void 0===e?void 0:e.Godown_Name},l))})]})})]},l.SO_St_Id)})})]})}),(0,I.jsx)("div",{className:"invoice-summary border-top pt-3 mt-3 text-end"})]})},l)})]})]})]})}},37141:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),d=t(70579);const s=(0,a.A)((0,d.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},56779:(e,l,t)=>{t.d(l,{A:()=>j});var a=t(89379),d=t(65043),s=t(83462),o=t(26600),n=t(35316),r=t(29347),i=t(11906),c=t(22520),u=t(34496),v=t(14792),m=t(14844),_=t(20656),I=t(63406),h=t(91036),x=t(34104),p=t(70579);const j=e=>{var l,t;let{children:j,orderProducts:A=[],setOrderProducts:b,open:g=!1,onClose:N,products:y=[],brands:f=[],uom:S=[],godowns:T=[],GST_Inclusive:C,IS_IGST:G,editValues:w=null,initialValue:P={},stockInGodown:R=[]}=e;const[D,B]=(0,d.useState)(P),O=(0,c.id)(C,1),Q=(0,c.id)(C,2);(0,d.useEffect)(()=>{(0,c.aF)(w)&&g&&B(e=>Object.fromEntries(Object.entries(e).map(e=>{let[l,t]=e;return[l,w[l]?w[l]:t]})))},[w]);const E=e=>{var l;return null!==(l=null===y||void 0===y?void 0:y.find(l=>(0,c.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}},U=()=>{B(P),N()};return(0,p.jsxs)(p.Fragment,{children:[j,(0,p.jsxs)(s.A,{open:g,onClose:U,maxWidth:"md",fullWidth:!0,children:[(0,p.jsx)(o.A,{className:"border-bottom",children:(0,p.jsx)("span",{children:"Add Products Details"})}),(0,p.jsxs)("form",{onSubmit:e=>{e.preventDefault(),D.Item_Id?(b(e=>[...e.filter(e=>!(0,c.id)(e.Item_Id,D.Item_Id)),Object.fromEntries(Object.entries(P).map(e=>{let[l,t]=e;const a=E(D.Item_Id),d=G?a.Igst_P:a.Gst_P,s=d>0,{Bill_Qty:o,Item_Rate:n,Amount:r}=D,i=Q?"zerotax":O?"remove":"add",c=(0,m.v)(n,d,i),u=(0,m.v)(r,d,i),v=G?0:u.cgst_per,_=G?u.igst_per:0,I=G?0:u.cgst_amount,h=G?u.igst_amount:0;switch(l){case"Item_Name":return[l,a.Product_Name];case"Taxable_Rate":return[l,c.base_amount];case"Total_Qty":return[l,o];case"Taxble":return[l,s?1:0];case"Taxable_Amount":return[l,u.base_amount];case"Tax_Rate":return[l,d];case"Cgst":case"Sgst":return[l,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[l,Q?0:I];case"Igst":return[l,null!==_&&void 0!==_?_:0];case"Igst_Amo":return[l,Q?0:h];case"Final_Amo":return[l,u.with_tax];default:return[l,D[l]||t]}}))]),U()):h.oR.warn("Select Product")},children:[(0,p.jsx)(n.A,{children:(0,p.jsxs)("div",{className:"row pb-5",children:[(0,p.jsxs)("div",{className:"col-6 p-2",children:[(0,p.jsx)("label",{children:"Brand"}),(0,p.jsx)(_.Ay,{value:{value:D.BrandID,label:D.Brand},onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{BrandID:e.value,Brand:e.label})),options:[{value:"",label:"select",isDisabled:!0},...f.map(e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name}))],styles:I.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200,filterOption:c.GI})]}),(0,p.jsxs)("div",{className:"col-6 p-2",children:[(0,p.jsx)("label",{children:"Group"}),(0,p.jsx)(_.Ay,{value:{value:D.GroupID,label:D.Group},onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{GroupID:e.value,Group:e.label})),options:[{value:"",label:"select",isDisabled:!0},...y.filter(e=>!D.BrandID||(0,c.id)(e.Brand,D.BrandID)).reduce((e,l)=>(e.some(e=>e.value===l.Product_Group)||e.push({value:l.Product_Group,label:l.Pro_Group}),e),[])],styles:I.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200,filterOption:c.GI})]}),(0,p.jsxs)("div",{className:Object.hasOwn(D,"GoDown_Id")?"col-md-8 p-2":"col-12 p-2",children:[(0,p.jsxs)("label",{children:["Item Name ",(0,p.jsx)(v.A,{})]}),(0,p.jsx)(_.Ay,{value:{value:D.Item_Id,label:null===(l=E(D.Item_Id))||void 0===l?void 0:l.Product_Name},isDisabled:(0,c.IQ)(D.Pre_Id),menuPortalTarget:document.body,onChange:e=>{const l=E(e.value);B(t=>{var d,s,o,n,r,i,c;return(0,a.A)((0,a.A)({},t),{},{Group:null!==(d=l.Pro_Group)&&void 0!==d?d:t.Group,GroupID:null!==(s=l.Product_Group)&&void 0!==s?s:t.GroupID,Brand:null!==(o=l.Brand_Name)&&void 0!==o?o:t.Brand,BrandID:null!==(n=l.Brand)&&void 0!==n?n:t.BrandID,Item_Id:e.value,Item_Rate:null!==(r=l.Item_Rate)&&void 0!==r?r:0,Bill_Qty:0,Amount:0,Unit_Id:null!==(i=l.UOM_Id)&&void 0!==i?i:t.Unit_Id,Unit_Name:null!==(c=l.Units)&&void 0!==c?c:t.Unit_Name,HSN_Code:null===l||void 0===l?void 0:l.HSN_Code})})},options:[{value:"",label:"select",isDisabled:!0},...[...y.filter(e=>!D.BrandID||(0,c.id)(e.Brand,D.BrandID)).filter(e=>!D.GroupID||(0,c.id)(e.Product_Group,D.GroupID))].map(e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==A.findIndex(l=>(0,c.id)(null===l||void 0===l?void 0:l.Item_Id,null===e||void 0===e?void 0:e.Product_Id))}))],styles:I.MR,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200,filterOption:c.GI})]}),Object.hasOwn(D,"GoDown_Id")&&(0,p.jsxs)("div",{className:"col-md-4 p-2",children:[(0,p.jsx)("label",{children:"Godown"}),(0,p.jsx)(_.Ay,{value:{value:null===D||void 0===D?void 0:D.GoDown_Id,label:(null===(t=T.find(e=>(0,c.id)(e.Godown_Id,null===D||void 0===D?void 0:D.GoDown_Id)))||void 0===t?void 0:t.Godown_Name)||""},onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{GoDown_Id:e.value})),options:[{value:"",label:"select",isDisabled:!0},{label:"Stock-Available-Godowns",options:(0,c.$r)(T).filter(e=>{const l=(0,c.$r)(R);return 0!==l.length&&l.some(l=>(0,c.id)(null===l||void 0===l?void 0:l.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===D||void 0===D?void 0:D.Item_Id,null===l||void 0===l?void 0:l.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:(null===e||void 0===e?void 0:e.Godown_Name)+" (Bal: "+(0,x.K)(null===D||void 0===D?void 0:D.Item_Id,null===e||void 0===e?void 0:e.Godown_Id,R)+")"}))},{label:"Other Godowns",options:(0,c.$r)(T).filter(e=>{const l=(0,c.$r)(R);return 0===l.length||!l.some(l=>(0,c.id)(null===l||void 0===l?void 0:l.Godown_Id,null===e||void 0===e?void 0:e.Godown_Id)&&(0,c.id)(null===D||void 0===D?void 0:D.Item_Id,null===l||void 0===l?void 0:l.Product_Id))}).map(e=>({value:null===e||void 0===e?void 0:e.Godown_Id,label:null===e||void 0===e?void 0:e.Godown_Name}))}],styles:I.MR,isDisabled:!(0,c.IQ)(null===D||void 0===D?void 0:D.Item_Id),menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Godown",filterOption:c.GI})]}),(0,p.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,p.jsxs)("label",{children:["Quantity ",(0,p.jsx)(v.A,{})]}),(0,p.jsx)("input",{required:!0,value:D.Bill_Qty?D.Bill_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(D.Item_Id),onChange:e=>{D.Item_Rate?B(l=>(0,a.A)((0,a.A)({},l),{},{Amount:(0,c.JH)(D.Item_Rate,e.target.value),Bill_Qty:e.target.value})):D.Amount?B(l=>(0,a.A)((0,a.A)({},l),{},{Item_Rate:(0,c.SX)(l.Amount,e.target.value),Bill_Qty:e.target.value})):B(l=>(0,a.A)((0,a.A)({},l),{},{Bill_Qty:e.target.value}))},className:"cus-inpt",min:1})]}),Object.hasOwn(D,"Act_Qty")&&(0,p.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,p.jsx)("label",{children:"Actual Quantity "}),(0,p.jsx)("input",{value:D.Act_Qty?D.Act_Qty:"",onInput:c.BE,disabled:!(0,c.IQ)(D.Item_Id),onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{Act_Qty:e.target.value})),required:!0,className:"cus-inpt"})]}),(0,p.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,p.jsx)("label",{children:"Rate "}),(0,p.jsx)("input",{value:D.Item_Rate?D.Item_Rate:"",onInput:c.BE,disabled:!(0,c.IQ)(D.Item_Id),onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{Item_Rate:e.target.value,Amount:l.Bill_Qty?(0,c.JH)(e.target.value,l.Bill_Qty):l.Amount})),required:!0,className:"cus-inpt"})]}),(0,p.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,p.jsx)("label",{children:"UOM"}),(0,p.jsxs)("select",{value:Object.hasOwn(D,"UOM")?D.UOM:Object.hasOwn(D,"Unit_Id")?D.Unit_Id:"",onChange:e=>{const l=e.target.selectedIndex,t=e.target.options[l].text,d=e.target.value;B(e=>(0,a.A)((0,a.A)({},e),{},{UOM:d,Unit_Id:d,Units:t,Unit_Name:t}))},className:"cus-inpt",disabled:!(0,c.IQ)(D.Item_Id),children:[(0,p.jsx)("option",{value:"",disabled:!0,children:"select"}),S.map((e,l)=>(0,p.jsx)("option",{value:e.Unit_Id,children:e.Units},l))]})]}),(0,p.jsxs)("div",{className:"col-md-6 p-2",children:[(0,p.jsx)("label",{children:"Amount"}),(0,p.jsx)("input",{required:!0,value:D.Amount?D.Amount:"",onInput:c.BE,disabled:!(0,c.IQ)(D.Item_Id),onChange:e=>B(l=>(0,a.A)((0,a.A)({},l),{},{Amount:e.target.value,Item_Rate:l.Bill_Qty?(0,c.SX)(e.target.value,l.Bill_Qty):l.Item_Rate})),className:"cus-inpt",min:1})]})]})}),(0,p.jsxs)(r.A,{className:"d-flex justify-content-between align-items-center",children:[(0,p.jsx)(i.A,{onClick:()=>B(P),type:"button",startIcon:(0,p.jsx)(u.A,{}),children:"Clear"}),(0,p.jsxs)("span",{children:[(0,p.jsx)(i.A,{type:"button",onClick:U,children:"cancel"}),(0,p.jsx)(i.A,{type:"submit",variant:"outlined",children:"Add"})]})]})]})]})]})}},83560:(e,l,t)=>{t.d(l,{A:()=>s});var a=t(59662),d=t(70579);const s=(0,a.A)((0,d.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},87281:(e,l,t)=>{t.r(l),t.d(l,{default:()=>U});var a=t(89379),d=t(65043),s=t(12110),o=t(11906),n=t(26494),r=t(17392),i=t(20656),c=t(63406),u=t(91036),v=t(22520),m=t(30079),_=t(37141),I=t(70141),h=t(47968),x=t(83560),p=t(51387),j=t(65074),A=t(48471),b=t(14844),g=t(73216);const N=(0,v.aN)().user,y={So_Id:"",So_Inv_No:"",So_Year:"",So_Branch_Inv_Id:"",So_Date:(0,v.ny)(),Retailer_Id:"",Retailer_Name:"",Sales_Person_Id:"",Branch_Id:"",VoucherType:"",GST_Inclusive:2,IS_IGST:0,Narration:"",isConverted:"",Cancel_status:1,CSGT_Total:0,SGST_Total:0,IGST_Total:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Created_by:null===N||void 0===N?void 0:N.UserId,Altered_by:null===N||void 0===N?void 0:N.UserId,Approved_By:"",Approve_Status:"",Created_on:"",Alterd_on:"",Trans_Type:"",Alter_Id:""},f={BrandID:"",Brand:"",GroupID:"",Group:"",SO_St_Id:"",So_Date:"",Sales_Order_Id:"",S_No:"",Pre_Id:"",Item_Id:"",Item_Rate:0,Bill_Qty:0,Amount:0,HSN_Code:"",Unit_Id:"",Unit_Name:"",Free_Qty:0,Total_Qty:0,Taxble:0,Taxable_Rate:0,Taxable_Amount:0,Tax_Rate:0,Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Final_Amo:0,Created_on:""},S={Id:"",So_Id:"",Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",EmpType:""};var T=t(83462),C=t(26600),G=t(35316),w=t(18584),P=t(70579);const R=e=>{let{loadingOn:l,loadingOff:t,open:s,onClose:n,retailer:i,children:c,selectedItems:u,setSelectedItems:m,products:_=[],GST_Inclusive:I,IS_IGST:h}=e;const x=(0,v.id)(I,1),p=(0,v.id)(I,2),[A,g]=(0,d.useState)([]),[N,y]=(0,d.useState)({Fromdate:(0,v.ny)(),Todate:(0,v.ny)(),search:!1});(0,d.useEffect)(()=>{if((0,v.IQ)(i)&&s){const{Fromdate:e,Todate:a}=N;l&&l(),(0,j.z)({address:"sales/saleOrder/importPosOrders?Fromdate=".concat(e,"&Todate=").concat(a,"&Retailer_Id=").concat(i)}).then(e=>{e.success?g(e.data):g([])}).catch(e=>console.error(e)).finally(()=>{t&&t()})}},[N.search]);const S=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(t=>{const a=t.filter(l=>!(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));let d;if(l)d=a;else{const l=A.filter(l=>(0,v.id)(l.Pre_Id,e.Pre_Id)).map(e=>Object.fromEntries(Object.entries(f).map(l=>{var t,a,d,s,o;let[n,r]=l;const i=(e=>{var l;return null!==(l=null===_||void 0===_?void 0:_.find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Product_Id,e)))&&void 0!==l?l:{}})(e.Item_Id),c=h?i.Igst_P:i.Gst_P,u=c>0,{Item_Rate:m,Bill_Qty:I,Tonnage:j,PackValue:A}=e,g=(0,v.JH)(m,(0,v.JH)(I,A)),N=p?"zerotax":x?"remove":"add",y=(0,b.v)(m,c,N),f=(0,b.v)(g,c,N),S=h?0:f.cgst_per,T=h?f.igst_per:0,C=h?0:f.cgst_amount,G=h?f.igst_amount:0;switch(n){case"Pre_Id":return[n,null!==(t=e.Pre_Id)&&void 0!==t?t:r];case"Item_Id":return[n,null!==(a=e.Item_Id)&&void 0!==a?a:r];case"Item_Rate":return[n,(0,v.Ro)(m)];case"Bill_Qty":case"Total_Qty":return[n,(0,v.Ro)(j)];case"Amount":return[n,g];case"Unit_Id":return[n,null!==(d=e.Unit_Id)&&void 0!==d?d:r];case"Unit_Name":return[n,null!==(s=e.Units)&&void 0!==s?s:r];case"HSN_Code":return[n,null!==(o=i.HSN_Code)&&void 0!==o?o:r];case"Taxable_Rate":return[n,y.base_amount];case"Taxble":return[n,u?1:0];case"Taxable_Amount":return[n,f.base_amount];case"Tax_Rate":return[n,c];case"Cgst":case"Sgst":return[n,null!==S&&void 0!==S?S:0];case"Cgst_Amo":case"Sgst_Amo":return[n,p?0:C];case"Igst":return[n,null!==T&&void 0!==T?T:0];case"Igst_Amo":return[n,p?0:G];case"Final_Amo":return[n,f.with_tax];default:return[n,r]}})));d=[...a,...l]}return d})},R=()=>{n&&n(),g([])};return(0,P.jsxs)(P.Fragment,{children:[c,(0,P.jsxs)(T.A,{open:s,onClose:R,fullScreen:!0,children:[(0,P.jsx)(C.A,{children:(0,P.jsxs)("div",{className:"d-flex flex-wrap align-items-center ",children:[(0,P.jsx)("span",{className:"flex-grow-1",children:"Import from POS"}),(0,P.jsx)(r.A,{onClick:R,color:"success",children:(0,P.jsx)(w.A,{className:"fa-20"})})]})}),(0,P.jsxs)(G.A,{children:[(0,P.jsx)("form",{onSubmit:e=>{e.preventDefault(),y(e=>(0,a.A)((0,a.A)({},e),{},{search:!e.search}))},children:(0,P.jsxs)("div",{className:"d-flex flex-wrap align-items-end",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("label",{className:"d-block ms-2",children:"From Date"}),(0,P.jsx)("input",{className:"cus-inpt p-2 w-auto",type:"date",value:null===N||void 0===N?void 0:N.Fromdate,onChange:e=>y(l=>(0,a.A)((0,a.A)({},l),{},{Fromdate:e.target.value})),required:!0})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)("label",{className:"d-block ms-2",children:"To Date"}),(0,P.jsx)("input",{className:"cus-inpt p-2 w-auto ms-2",type:"date",min:N.Fromdate,value:null===N||void 0===N?void 0:N.Todate,onChange:e=>y(l=>(0,a.A)((0,a.A)({},l),{},{Todate:e.target.value})),required:!0})]}),(0,P.jsx)(o.A,{variant:"outlined",className:"ms-2",type:"submit",children:"search"})]})}),(0,P.jsx)("div",{className:"table-responsive mt-3",children:(0,P.jsxs)("table",{className:"table table-bordered fa-13",children:[(0,P.jsx)("thead",{children:(0,P.jsx)("tr",{children:["Sno","#","Item","Qty","Pack","Rate","Amount","Order ID","Date","Invoice Value"].map((e,l)=>(0,P.jsx)("th",{children:e},l))})}),(0,P.jsx)("tbody",{children:A.filter(e=>(0,v.id)(e.Custome_Id,i)).map((e,l)=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{children:l+1}),(0,P.jsx)("td",{children:(()=>{const l=-1!==u.findIndex(l=>(0,v.id)(null===l||void 0===l?void 0:l.Pre_Id,e.Pre_Id));return(0,P.jsx)("div",{children:(0,P.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:l,onChange:()=>{l?S(e,!0):S(e)}})})})()}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Tonnage}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Pre_Id}),(0,P.jsx)("td",{children:(0,v.yc)(null===e||void 0===e?void 0:e.Pre_Date)}),(0,P.jsx)("td",{children:null===e||void 0===e?void 0:e.Total_Invoice_value})]},l))})]})})]})]})]})};var D=t(56779);const B=e=>{let{StaffArray:l=[],setStaffArray:t,costCenter:d=[],costCategory:s=[]}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,P.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,P.jsx)(o.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>t(e=>[...e,(0,a.A)({},S)]),children:"Add"})]}),(0,P.jsxs)("table",{className:"table table-bordered",children:[(0,P.jsx)("thead",{children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"fa-13",children:"Sno"}),(0,P.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,P.jsx)("th",{className:"fa-13",children:"Category"}),(0,P.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,P.jsx)("tbody",{children:(0,v.$r)(l).map((e,o)=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"fa-13 vctr text-center",children:o+1}),(0,P.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,P.jsx)(i.Ay,{value:{value:null===e||void 0===e?void 0:e.Involved_Emp_Id,label:null===e||void 0===e?void 0:e.EmpName},onChange:e=>t(l=>l.map((l,t)=>{if((0,v.id)(t,o)){const t=(0,v.$r)(d).find(l=>(0,v.id)(null===l||void 0===l?void 0:l.Cost_Center_Id,e.value));return(0,a.A)((0,a.A)({},l),{},{Cost_Center_Type_Id:(0,v.IQ)(null===l||void 0===l?void 0:l.Cost_Center_Type_Id)?Number(null===l||void 0===l?void 0:l.Cost_Center_Type_Id):(0,v.IQ)(t.User_Type)?Number(t.User_Type):0,Involved_Emp_Id:Number(e.value),EmpName:e.label})}return l})),options:[...(0,v.$r)(d).filter(e=>!l.some(l=>(0,v.id)(l.Emp_Id,e.Cost_Center_Id)))].map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:c.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,P.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,P.jsxs)("select",{value:null===e||void 0===e?void 0:e.Cost_Center_Type_Id,onChange:e=>t(l=>l.map((l,t)=>(0,v.id)(t,o)?(0,a.A)((0,a.A)({},l),{},{Cost_Center_Type_Id:e.target.value}):l)),className:"cus-inpt p-2 border-0",children:[(0,P.jsx)("option",{value:"",children:"Select"}),(0,v.$r)(s).map((e,l)=>(0,P.jsx)("option",{value:null===e||void 0===e?void 0:e.Cost_Category_Id,children:null===e||void 0===e?void 0:e.Cost_Category},l))]})}),(0,P.jsx)("td",{className:"fa-13 vctr p-0",children:(0,P.jsx)(r.A,{onClick:()=>{t(e=>e.filter((e,l)=>o!==l))},size:"small",children:(0,P.jsx)(p.A,{color:"error"})})})]},o))})]})]})};var O=t(14792);const Q=(0,v.aN)().user,E=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,v.id)(e.Product_Id,l)))&&void 0!==e?e:{}},U=e=>{var l,t;let{loadingOn:N,loadingOff:T}=e;(0,g.Zp)();const C=(0,g.zy)().state,[G,w]=(0,d.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],salesPerson:[],brand:[]}),[U,k]=(0,d.useState)(y),[F,V]=(0,d.useState)([]),[H,z]=(0,d.useState)([]),[M,L]=(0,d.useState)(null),[$,q]=(0,d.useState)(!1),[W,J]=(0,d.useState)(!1),K=(0,v.id)(U.GST_Inclusive,1),X=(0,v.id)(U.GST_Inclusive,2),Y=(0,v.id)(U.IS_IGST,1),Z=X?"zerotax":K?"remove":"add";(0,d.useEffect)(()=>{if((0,v.aF)(C)&&Array.isArray(null===C||void 0===C?void 0:C.Products_List)&&Array.isArray(null===C||void 0===C?void 0:C.Staff_Involved_List)){const{Products_List:e,Staff_Involved_List:l}=C;k(Object.fromEntries(Object.entries(y).map(e=>{var l;let[t,a]=e;return"So_Date"===t?[t,C[t]?(0,v.ny)(C[t]):a]:[t,null!==(l=C[t])&&void 0!==l?l:a]}))),V(e.map(e=>Object.fromEntries(Object.entries(f).map(l=>{var t;let[a,d]=l;return[a,null!==(t=e[a])&&void 0!==t?t:d]})))),z(l.map(e=>Object.fromEntries(Object.entries(S).map(l=>{var t;let[a,d]=l;return[a,null!==(t=e[a])&&void 0!==t?t:d]}))))}},[C]),(0,d.useEffect)(()=>{(async()=>{try{N&&N();const[e,l,t,d,s,o,n,r]=await Promise.all([(0,j.z)({address:"masters/branch/dropDown"}),(0,j.z)({address:"masters/products"}),(0,j.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===Q||void 0===Q?void 0:Q.Company_id)}),(0,j.z)({address:"masters/voucher?module=SALE_ORDER"}),(0,j.z)({address:"masters/uom"}),(0,j.z)({address:"dataEntry/costCenter"}),(0,j.z)({address:"dataEntry/costCenter/category"}),(0,j.z)({address:"masters/users/salesPerson/dropDown"})]),i=(e.success?e.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===l||void 0===l?void 0:l.BranchName)),c=(l.success?l.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===l||void 0===l?void 0:l.Product_Name)),u=(t.success?t.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===l||void 0===l?void 0:l.Retailer_Name)),m=(d.success?d.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===l||void 0===l?void 0:l.Voucher_Type)),_=(s.success?s.data:[]).sort((e,l)=>String(e.Units).localeCompare(l.Units)),I=(o.success?o.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===l||void 0===l?void 0:l.Cost_Center_Name)),h=(n.success?n.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===l||void 0===l?void 0:l.Cost_Category)),x=(r.success?r.data:[]).sort((e,l)=>String(null===e||void 0===e?void 0:e.Name).localeCompare(null===l||void 0===l?void 0:l.Name));w(e=>(0,a.A)((0,a.A)({},e),{},{products:c,branch:i,retailers:u,voucherType:m,uom:_,staff:I,staffType:h,salesPerson:x,brand:(0,v.Mn)(c,"Brand",["Brand_Name"])}))}catch(e){console.error("Error fetching data:",e)}finally{T&&T()}})()},[null===Q||void 0===Q?void 0:Q.Company_id]);const ee=()=>{k(y),V([]),z([])},le=()=>{if((null===F||void 0===F?void 0:F.length)>0&&null!==U&&void 0!==U&&U.Retailer_Id)N(),(0,j.z)({address:"sales/saleOrder",method:(0,v.IQ)(null===U||void 0===U?void 0:U.So_Id)?"PUT":"POST",bodyData:(0,a.A)((0,a.A)({},U),{},{Product_Array:F.filter(e=>(0,v.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),Staff_Involved_List:H})}).then(e=>{e.success?(u.oR.success(null===e||void 0===e?void 0:e.message),ee()):u.oR.error(null===e||void 0===e?void 0:e.message)}).catch(e=>console.error(e)).finally(()=>T());else{if(F.length<=0)return u.oR.error("Enter any one product quantity");if(null===U||void 0===U||!U.Retailer_Id)return u.oR.error("Select Retailer")}},te=(0,d.useMemo)(()=>F.reduce((e,l)=>{const t=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(X)return(0,v.Lr)(e,t);const a=E(G.products,l.Item_Id),d=(0,v.id)(Y,1)?a.Igst_P:a.Gst_P;return K?(0,v.Lr)(e,(0,b.v)(t,d,"remove").with_tax):(0,v.Lr)(e,(0,b.v)(t,d,"add").with_tax)},0),[F,X,G.products,Y,K]),ae=(0,d.useMemo)(()=>F.reduce((e,l)=>{const t=(0,v.e3)(null===l||void 0===l?void 0:l.Amount);if(X)return{TotalValue:(0,v.Lr)(e.TotalValue,t),TotalTax:0};const a=E(G.products,l.Item_Id),d=(0,v.id)(Y,1)?a.Igst_P:a.Gst_P,s=(0,b.v)(t,d,K?"remove":"add");return{TotalValue:(0,v.Lr)(e.TotalValue,s.without_tax),TotalTax:(0,v.Lr)(e.TotalTax,s.tax_amount)}},{TotalValue:0,TotalTax:0}),[F,X,G.products,Y,K]);return(0,d.useEffect)(()=>{V(e=>[...e].map(e=>Object.fromEntries(Object.entries(f).map(l=>{let[t,a]=l;const d=E(G.products,null===e||void 0===e?void 0:e.Item_Id),s=Y?d.Igst_P:d.Gst_P,o=s>0,{Bill_Qty:n,Item_Rate:r,Amount:i}=e,c=(0,b.v)(r,s,Z),u=(0,b.v)(i,s,Z),v=Y?0:u.cgst_per,m=Y?u.igst_per:0,_=Y?0:u.cgst_amount,I=Y?u.igst_amount:0;switch(t){case"Taxable_Rate":return[t,c.base_amount];case"Total_Qty":return[t,n];case"Taxble":return[t,o?1:0];case"Taxable_Amount":return[t,u.base_amount];case"Tax_Rate":return[t,s];case"Cgst":case"Sgst":return[t,null!==v&&void 0!==v?v:0];case"Cgst_Amo":case"Sgst_Amo":return[t,X?0:_];case"Igst":return[t,null!==m&&void 0!==m?m:0];case"Igst_Amo":return[t,X?0:I];case"Final_Amo":return[t,u.with_tax];default:return[t,e[t]||a]}}))))},[f,G.products,Y,Z]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(D.A,{orderProducts:F,setOrderProducts:V,open:$,onClose:()=>{q(!1),L(null)},products:G.products,brands:G.brand,uom:G.uom,GST_Inclusive:U.GST_Inclusive,IS_IGST:Y,editValues:M,initialValue:f}),(0,P.jsxs)(s.A,{children:[(0,P.jsxs)("div",{className:"d-flex align-items-center flex-wrap p-2",children:[(0,P.jsx)("h5",{className:"flex-grow-1 ps-2",children:"Sale Order Creation"}),(0,P.jsx)(o.A,{variant:"outlined",sx:{ml:1},startIcon:(0,P.jsx)(m.A,{}),onClick:ee,children:"Clear"}),(0,P.jsx)(o.A,{onClick:le,sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,P.jsx)(_.A,{}),disabled:0===(null===F||void 0===F?void 0:F.length)||!(null!==U&&void 0!==U&&U.Retailer_Id),children:"Save"})]}),(0,P.jsxs)(n.A,{children:[(0,P.jsxs)("div",{className:"row",children:[(0,P.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,P.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,P.jsx)(B,{StaffArray:H,setStaffArray:z,costCenter:G.staff,costCategory:G.staffType})})}),(0,P.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,P.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,P.jsxs)("div",{className:"row",children:[(0,P.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Retailer Name ",(0,P.jsx)(O.A,{})]}),(0,P.jsx)(i.Ay,{value:{value:null===U||void 0===U?void 0:U.Retailer_Id,label:null===U||void 0===U?void 0:U.Retailer_Name},onChange:e=>{k((0,a.A)((0,a.A)({},U),{},{Retailer_Id:e.value,Retailer_Name:e.label}))},options:[{value:"",label:"select",isDisabled:!0},...G.retailers.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:c.MR,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200,filterOption:v.GI})]}),(0,P.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Voucher Type ",(0,P.jsx)(O.A,{})]}),(0,P.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{VoucherType:Number(e.target.value)})),value:U.VoucherType,children:[(0,P.jsx)("option",{value:"",disabled:!0,children:"select voucher"}),null===(l=G.voucherType)||void 0===l?void 0:l.map((e,l)=>(0,P.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l))]})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Date ",(0,P.jsx)(O.A,{})]}),(0,P.jsx)("input",{type:"date",value:null!==U&&void 0!==U&&U.So_Date?(0,v.ny)(null===U||void 0===U?void 0:U.So_Date):"",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{So_Date:e.target.value})),className:"cus-inpt p-2"})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Invoice Type ",(0,P.jsx)(O.A,{})]}),(0,P.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{GST_Inclusive:Number(e.target.value)})),value:U.GST_Inclusive,children:[(0,P.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,P.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,P.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Tax Type ",(0,P.jsx)(O.A,{})]}),(0,P.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{IS_IGST:Number(e.target.value)})),value:U.IS_IGST,children:[(0,P.jsx)("option",{value:"0",children:"GST"}),(0,P.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Sales Person ",(0,P.jsx)(O.A,{})]}),(0,P.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{Sales_Person_Id:Number(e.target.value)})),value:U.Sales_Person_Id,children:[(0,P.jsx)("option",{value:"",disabled:!0,children:"select sales person"}),(0,P.jsx)("option",{value:null===Q||void 0===Q?void 0:Q.UserId,children:null===Q||void 0===Q?void 0:Q.Name}),null===(t=G.salesPerson)||void 0===t?void 0:t.map((e,l)=>(0,P.jsx)("option",{value:e.UserId,children:e.Name},l))]})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsxs)("label",{className:"fa-13",children:["Branch ",(0,P.jsx)(O.A,{})]}),(0,P.jsxs)("select",{className:"cus-inpt p-2",onChange:e=>k((0,a.A)((0,a.A)({},U),{},{Branch_Id:Number(e.target.value)})),value:U.Branch_Id,children:[(0,P.jsx)("option",{value:"",disabled:!0,children:"select Branch"}),G.branch.map((e,l)=>(0,P.jsx)("option",{value:e.BranchId,children:e.BranchName},l))]})]}),(0,P.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,P.jsx)("label",{className:"fa-13",children:"Status"}),(0,P.jsxs)("select",{value:null===U||void 0===U?void 0:U.Cancel_status,className:"cus-inpt p-2",onChange:e=>k(l=>(0,a.A)((0,a.A)({},l),{},{Cancel_status:e.target.value})),children:[(0,P.jsx)("option",{value:"1",children:"New"}),(0,P.jsx)("option",{value:"2",children:"Pending"}),(0,P.jsx)("option",{value:"0",children:"Cancel"}),(0,P.jsx)("option",{value:"4",children:"Completed"})]})]}),(0,P.jsxs)("div",{className:"col-12 p-2",children:[(0,P.jsx)("label",{className:"fa-13",children:"Narration"}),(0,P.jsx)("textarea",{className:"cus-inpt ",value:U.Narration,onChange:e=>k(l=>(0,a.A)((0,a.A)({},l),{},{Narration:e.target.value}))})]})]})})})]}),(0,P.jsx)(A.Ay,{title:"Products",ButtonArea:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(o.A,{onClick:()=>{L(null),q(!0)},sx:{ml:1},variant:"outlined",startIcon:(0,P.jsx)(I.A,{}),disabled:!(0,v.IQ)(U.Retailer_Id)||F.length>0&&F.some(e=>(0,v.IQ)(e.Pre_Id)),children:"Add Product"}),(0,P.jsx)(R,{loadingOn:N,loadingOff:T,open:W,onClose:()=>J(!1),retailer:null===U||void 0===U?void 0:U.Retailer_Id,selectedItems:F,setSelectedItems:V,products:G.products,GST_Inclusive:U.GST_Inclusive,IS_IGST:Y,children:(0,P.jsx)(o.A,{onClick:()=>J(!0),disabled:!(0,v.IQ)(U.Retailer_Id)||F.length>0&&F.some(e=>!(0,v.IQ)(e.Pre_Id)),sx:{ml:1},variant:"outlined",startIcon:(0,P.jsx)(h.A,{}),children:"Import pos"})})]}),dataArray:F,columns:[{isCustomCell:!0,Cell:e=>{let{row:l}=e;return E(G.products,null===l||void 0===l?void 0:l.Item_Id).Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:t}=e;return null===(l=E(G.products,null===t||void 0===t?void 0:t.Item_Id).Product_Name)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:t}=e;return(null===t||void 0===t?void 0:t.Bill_Qty)+" "+(null!==(l=null===t||void 0===t?void 0:t.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},(0,A.Lj)("Item_Rate","number","Rate","right"),(0,A.Lj)("Taxable_Amount","number","Taxable Amount","right"),{isCustomCell:!0,Cell:e=>{var l;let{row:t}=e;const a=null===(l=E(G.products,null===t||void 0===t?void 0:t.Item_Id))||void 0===l?void 0:l.Gst_P,d=(0,v.Ro)(null===t||void 0===t?void 0:t.Amount),s=(0,b.v)(d,a,Z);return(0,v.jG)(s.tax_amount)+" ("+s.tax_per+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var l,t;let{row:a}=e;const d=null===(l=E(G.products,null===a||void 0===a?void 0:a.Item_Id))||void 0===l?void 0:l.Gst_P,s=null!==(t=a.Amount)&&void 0!==t?t:0,o=(0,b.v)(s,d,Z).tax_amount;return(0,v.jG)((0,v.id)(U.GST_Inclusive,1)?s:(0,v.Lr)(s,o))},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(r.A,{onClick:()=>{L(l),q(!0)},size:"small",children:(0,P.jsx)(x.A,{})}),(0,P.jsx)(r.A,{size:"small",onClick:()=>{(0,v.IQ)(null===l||void 0===l?void 0:l.Pre_Id)?V(e=>e.filter(e=>!(0,v.id)(null===e||void 0===e?void 0:e.Pre_Id,null===l||void 0===l?void 0:l.Pre_Id))):V(e=>e.filter(e=>!(0,v.id)(e.Item_Id,l.Item_Id)))},color:"error",children:(0,P.jsx)(p.A,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),F.length>0&&(0,P.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,P.jsx)("table",{className:"table",children:(0,P.jsxs)("tbody",{children:[(0,P.jsxs)("tr",{children:[(0,P.jsxs)("td",{className:"border p-2",rowSpan:(0,v.id)(U.IS_IGST,1)?4:5,children:["Total in words: ",(0,v.GF)(parseInt(te))]}),(0,P.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.jG)(ae.TotalValue)})]}),(0,v.id)(U.IS_IGST,1)?(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"border p-2",children:"IGST"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.jG)(ae.TotalTax)})]}):(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"border p-2",children:"CGST"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.jG)(ae.TotalTax/2)})]}),(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"border p-2",children:"SGST"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.jG)(ae.TotalTax/2)})]})]}),(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.e3)(Math.round(te)-te)})]}),(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"border p-2",children:"Total"}),(0,P.jsx)("td",{className:"border p-2",children:(0,v.jG)(Math.round(te))})]})]})})}),(0,P.jsx)("div",{className:"d-flex justify-content-end",children:(0,P.jsx)(o.A,{onClick:le,sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,P.jsx)(_.A,{}),disabled:0===(null===F||void 0===F?void 0:F.length)||!(null!==U&&void 0!==U&&U.Retailer_Id),children:"Save"})})]})]})]})}},97280:(e,l,t)=>{t.d(l,{$B:()=>I,NP:()=>r,Q4:()=>c,Ud:()=>m,WS:()=>o,a4:()=>u,ju:()=>v,p7:()=>n,vD:()=>_,zA:()=>i});var a=t(89379),d=t(22520);const s=(0,d.aN)().user;function o(e){const{outstanding:l,creditLimit:t,creditDays:a,recentDate:s}=e,o=new Date(s),n=new Date(o);n.setDate(n.getDate()+(0,d.Ro)(a));const r=new Date,i=(0,d.Ro)(l)>(0,d.Ro)(t),c=r>n;return!((0,d.Ro)(t)>0&&i||(0,d.Ro)(a)>0&&c)}const n=[0,1],r={outstanding:0,creditLimit:0,creditDays:0,recentDate:new Date,invoiceCreationStatus:null,forceCreateInvoice:!1,dialog:!1},i={id:null,retailerId:null,deliveryName:"",phoneNumber:"",cityName:"",deliveryAddress:"",gstNumber:"",stateName:""},c={Do_Id:"",Do_No:"",Do_Year:"",Do_Inv_No:"",Voucher_Type:"",Do_Date:(0,d.ny)(),Retailer_Id:"",Retailer_Name:"",Delivery_Person_Id:"",Branch_Id:s.BranchId||"",GST_Inclusive:2,IS_IGST:0,Narration:"",Cancel_status:3,So_No:"",Trans_Type:"",CSGT_Total:0,SGST_Total:0,IGST_Total:0,Total_Expences:0,Round_off:0,Total_Before_Tax:0,Total_Tax:0,Total_Invoice_value:0,Stock_Item_Ledger_Name:"",Ref_Inv_Number:"",deliveryAddressId:null,deliveryAddressDetails:i,shipingAddressId:null,shipingAddressDetails:i,Delivery_Status:0,Payment_Mode:0,Payment_Status:0,Alter_Reason:"",paymentDueDays:0,Alter_Id:"",Created_by:null===s||void 0===s?void 0:s.UserId,Altered_by:null===s||void 0===s?void 0:s.UserId,Created_on:"",Alterd_on:""},u={rowId:"",DO_St_Id:"",Do_Date:"",Delivery_Order_Id:"",GoDown_Id:"",Godown_Stock:0,S_No:"",Item_Id:"",Item_Name:"",HSN_Code:"",Taxble:"",Batch_Name:"",Bill_Qty:"",Alt_Bill_Qty:"",Act_Qty:"",Alt_Act_Qty:"",Free_Qty:"",Total_Qty:"",Item_Rate:"",Taxable_Rate:"",Amount:"",Unit_Id:"",Unit_Name:"",Act_unit_Id:"",Alt_Act_Unit_Id:"",Taxable_Amount:"",Tax_Rate:"",Cgst:"",Sgst:"",Igst:"",Cgst_Amo:"",Sgst_Amo:"",Igst_Amo:"",Final_Amo:"",Created_on:""},v={Id:"",Do_Id:"",Sno:"",Expense_Id:"",Cgst:0,Cgst_Amo:0,Sgst:0,Sgst_Amo:0,Igst:0,Igst_Amo:0,Expence_Value:0},m={Id:"",Do_Id:"",Emp_Id:"",Emp_Name:"",Emp_Type_Id:""},_=(e,l)=>{const{deliveryName:t="",phoneNumber:d="",cityName:s="",deliveryAddress:o="",gstNumber:n="",stateName:r="",id:i=null}=e;l(e=>(0,a.A)((0,a.A)({},e),{},{deliveryName:t,phoneNumber:d,cityName:s,deliveryAddress:o,gstNumber:n,stateName:r,id:i}))},I=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const l=["Broker","Others5","Others6","Transport"];return(0,d.$r)(e).filter(e=>l.includes(null===e||void 0===e?void 0:e.Cost_Category)).map(e=>(0,a.A)((0,a.A)({},m),{},{Emp_Type_Id:null===e||void 0===e?void 0:e.Cost_Category_Id}))}}}]);
//# sourceMappingURL=7281.ed27d373.chunk.js.map