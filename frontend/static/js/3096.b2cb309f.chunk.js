"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[3096],{6593:(e,t,s)=>{s.d(t,{A:()=>a});const a=s(44708).A},10204:(e,t,s)=>{s.d(t,{T:()=>a,X:()=>o});const a=[{id:0,label:"New",color:" bg-info text-white "},{id:1,label:"Verified",color:" bg-warning text-white "},{id:2,label:"Converted",color:" bg-success text-white "},{id:3,label:"Canceled",color:" bg-danger text-white "}],o=[{id:1,label:"New",color:" bg-info text-white "},{id:2,label:"Progess",color:" bg-warning text-white "},{id:3,label:"Completed",color:" bg-success text-white "},{id:4,label:"Canceled",color:" bg-danger text-white "}]},24651:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(89379),o=s(65043),l=s(97707),r=s(14844),n=s(70579);const d=function(){var e;let t=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,l.id)(e.Product_Id,t)))&&void 0!==e?e:{}},i=e=>{let{invoiceProducts:t=[],invoiceExpences:s=[],isNotTaxableBill:i,isInclusive:c,IS_IGST:u,products:m=[],invoiceInfo:_={},setInvoiceInfo:v}=e;const p=(0,o.useMemo)(()=>(0,l.$r)(s).reduce((e,t)=>(0,l.Lr)(e,null===t||void 0===t?void 0:t.Expence_Value),0),[s]),x=(0,o.useMemo)(()=>{const e=t.reduce((e,t)=>{const s=(0,l.e3)(null===t||void 0===t?void 0:t.Amount);if(i)return(0,l.Lr)(e,s);const a=d(m,t.Item_Id),o=u?a.Igst_P:a.Gst_P;return c?(0,l.Lr)(e,(0,r.v)(s,o,"remove").with_tax):(0,l.Lr)(e,(0,r.v)(s,o,"add").with_tax)},0);return(0,l.Lr)(e,p)},[t,i,m,u,c,p]),h=(0,o.useMemo)(()=>{if(!t||0===t.length)return{};let e=0,s=0;t.forEach(t=>{const a=(0,l.e3)((null===t||void 0===t?void 0:t.Amount)||0);if(i)return void(e=(0,l.Lr)(e,a));const o=d(m,t.Item_Id),n=(0,l.id)(u,1)?o.Igst_P:o.Gst_P,_=(0,r.v)(a,n,c?"remove":"add");e=(0,l.Lr)(e,parseFloat(_.without_tax)),s=(0,l.Lr)(s,parseFloat(_.tax_amount))});const a=(0,l.Lr)(e,s),o=(0,l.Lr)(a,p),n=Math.round(o),_=(0,l.e3)(n-o),v=(0,l.id)(u,1)?0:(0,l.e3)(s/2),x=(0,l.id)(u,1)?0:(0,l.e3)(s/2),h=(0,l.id)(u,1)?(0,l.e3)(s):0;return{totalTaxable:(0,l.e3)(e),totalTax:(0,l.e3)(s),cgst:v,sgst:x,igst:h,roundOff:_,invoiceTotal:n}},[t,m,u,i,c,p]);return(0,o.useMemo)(()=>{void 0!==h.roundOff&&h.roundOff!==_.Round_off&&v(e=>(0,a.A)((0,a.A)({},e),{},{Round_off:h.roundOff}))},[h.roundOff]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("table",{className:"table",children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{className:"border p-2",rowSpan:u?5:6,children:["Total in words: ",(0,l.GF)(parseInt(x))]}),(0,n.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,n.jsx)("td",{className:"border p-2",children:h.totalTaxable})]}),u?(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"IGST"}),(0,n.jsx)("td",{className:"border p-2",children:h.igst})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"CGST"}),(0,n.jsx)("td",{className:"border p-2",children:h.cgst})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"SGST"}),(0,n.jsx)("td",{className:"border p-2",children:h.sgst})]})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Total Expences"}),(0,n.jsx)("td",{className:"border p-2",children:(0,l.e3)(p)})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,n.jsx)("td",{className:"border p-0",children:(0,n.jsx)("input",{value:_.Round_off||h.roundOff||0,className:"cus-inpt p-2 m-0 border-0",onInput:l.rV,onChange:e=>v(t=>(0,a.A)((0,a.A)({},t),{},{Round_off:parseFloat(e.target.value)||0}))})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border p-2",children:"Total"}),(0,n.jsx)("td",{className:"border p-2",children:(0,l.jG)(Math.round(x))})]})]})})})}},33438:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(59662),o=s(70579);const l=(0,a.A)((0,o.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},35786:(e,t,s)=>{s.d(t,{A:()=>v});var a=s(89379),o=s(12110),l=s(11906),r=s(17392),n=(s(48471),s(97707)),d=s(97280),i=(s(65043),s(63406)),c=s(51387),u=s(20656),m=s(14844),_=s(70579);const v=e=>{let{invoiceExpences:t=[],setInvoiceExpences:s,expenceMaster:v=[],IS_IGST:p,taxType:x}=e;return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(o.A,{children:[(0,_.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-wrap px-3 py-2",children:[(0,_.jsx)("h5",{className:"m-0",children:"Expenses"}),(0,_.jsx)(l.A,{variant:"outlined",type:"button",onClick:()=>{s(e=>[...e,(0,a.A)((0,a.A)({},d.ju),{},{Sno:e.length})])},children:"Add"})]}),(0,_.jsx)("div",{className:"table-responsive",children:(0,_.jsxs)("table",{className:"table table-bordered m-0",children:[(0,_.jsx)("thead",{className:"table-light",children:(0,_.jsx)("tr",{children:["S.No","Expense","Expense Value","Action"].map((e,t)=>(0,_.jsx)("th",{className:"fa-13 bg-light",children:e},t))})}),(0,_.jsxs)("tbody",{style:{fontSize:"13px"},children:[t.map((e,o)=>{var l;const d=(null===(l=v.find(t=>(0,n.id)(t.Id,null===e||void 0===e?void 0:e.Expense_Id)))||void 0===l?void 0:l.Expence_Name)||"";return(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:o+1}),(0,_.jsx)("td",{className:"p-0 vctr",style:{minWidth:"180px"},children:(0,_.jsx)(u.Ay,{value:{value:null===e||void 0===e?void 0:e.Expense_Id,label:d},onChange:e=>((e,t)=>{const o=v.find(e=>(0,n.id)(e.Id,t.value))||{};s(t=>t.map((t,s)=>s!==e?t:(0,a.A)((0,a.A)({},t),{},{Expense_Id:o.Id,Expence_Value:0})))})(o,e),options:v.filter(s=>!!(0,n.id)(s.Id,null===e||void 0===e?void 0:e.Expense_Id)||!t.some((e,t)=>t!==o&&(0,n.id)(e.Expense_Id,s.Id))).map(e=>({value:e.Id,label:e.Expence_Name})),styles:i.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Select Expense"})}),(0,_.jsx)("td",{className:"p-0 vctr",children:(0,_.jsx)("input",{onInput:n.rV,className:"cus-inpt p-2 border-0",value:e.Expence_Value||"",disabled:!(0,n.IQ)(e.Expense_Id),onChange:e=>{((e,t,o)=>{s(s=>s.map((s,l)=>{if(l!==e)return s;const r=(0,a.A)((0,a.A)({},s),{},{[t]:o});if("Expence_Value"===t){const e=s.Cgst?(0,n.Ro)(s.Cgst):0,t=s.Sgst?(0,n.Ro)(s.Sgst):0,a=s.Igst?(0,n.Ro)(s.Igst):0,l=(0,n.Ro)(o),d=p?a:(0,n.Lr)(e,t),i=(0,m.v)(l,d,x);r.Cgst_Amo=e>0&&!p?i.cgst_amount:0,r.Sgst_Amo=t>0&&!p?i.sgst_amount:0,r.Igst_Amo=a>0&&p?i.igst_amount:0}if("Igst"===t){const e=p?(0,n.Ro)(o):0,t=p?0:(0,n.SX)((0,n.Ro)(o),2),a=p?0:(0,n.SX)((0,n.Ro)(o),2),l=(0,n.Ro)(s.Expence_Value),d=p?e:(0,n.Lr)(t,a),i=(0,m.v)(l,d,x);r.Cgst=t,r.Sgst=a,r.Cgst_Amo=t>0?i.cgst_amount:0,r.Sgst_Amo=a>0?i.sgst_amount:0,r.Igst_Amo=e>0?i.igst_amount:0}return r}))})(o,"Expence_Value",e.target.value)}})}),(0,_.jsx)("td",{className:"p-0 vctr  text-center ",children:(0,_.jsx)(r.A,{onClick:()=>(e=>{s(t=>t.filter((t,s)=>s!==e))})(o),size:"small",children:(0,_.jsx)(c.A,{color:"error",fontSize:"small"})})})]},o)}),0===t.length&&(0,_.jsx)("tr",{children:(0,_.jsx)("td",{className:"text-center",colSpan:6,children:"No rows"})})]})]})})]})})}},38641:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(89379),o=(s(65043),s(20656)),l=s(63406),r=s(97707),n=s(14792),d=s(70579);const i=e=>{var t;let{invoiceInfo:s={},setInvoiceInfo:i,retailers:c=[],voucherType:u=[],branches:m=[],onChangeRetailer:_,stockItemLedgerName:v=[]}=e;const p="cus-inpt p-2";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"row",children:[(0,d.jsxs)("div",{className:"col-sm-8 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Party Name"}),(0,d.jsx)(o.Ay,{value:{value:null===s||void 0===s?void 0:s.Retailer_Id,label:null===s||void 0===s?void 0:s.Retailer_Name},onChange:e=>{i(t=>(0,a.A)((0,a.A)({},t),{},{Retailer_Id:e.value,Retailer_Name:e.label})),_&&_()},options:[{value:"",label:"Search",isDisabled:!0},...(0,r.$r)(c).map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],styles:l.MR,isSearchable:!0,placeholder:"Select Vendor",maxMenuHeight:300})]}),(0,d.jsxs)("div",{className:"col-sm-4 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Voucher Type"}),(0,d.jsx)(o.Ay,{value:{value:s.Voucher_Type,label:null===(t=(0,r.$r)(u).find(e=>(0,r.id)(e.Vocher_Type_Id,s.Voucher_Type)))||void 0===t?void 0:t.Voucher_Type},onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Voucher_Type:e.value})),options:[{value:"",label:"Search",isDisabled:!0},...(0,r.$r)(u).filter(e=>"SALES"===(null===e||void 0===e?void 0:e.Type)).map(e=>({value:null===e||void 0===e?void 0:e.Vocher_Type_Id,label:null===e||void 0===e?void 0:e.Voucher_Type}))],styles:l.MR,isSearchable:!0,required:!0,placeholder:"Select Voucher Type",maxMenuHeight:300})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["Entry Date ",(0,d.jsx)(n.A,{})]}),(0,d.jsx)("input",{value:(null===s||void 0===s?void 0:s.Pre_Date)||(null===s||void 0===s?void 0:s.Do_Date)||"",type:"date",required:!0,className:p,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Do_Date:e.target.value}))})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["Branch ",(0,d.jsx)(n.A,{})]}),(0,d.jsxs)("select",{className:p,value:null===s||void 0===s?void 0:s.Branch_Id,required:!0,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Branch_Id:e.target.value})),children:[(0,d.jsx)("option",{value:"",children:"select"}),m.map((e,t)=>(0,d.jsx)("option",{value:null===e||void 0===e?void 0:e.BranchId,children:null===e||void 0===e?void 0:e.BranchName},t))]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsxs)("label",{className:"fa-13",children:["GST Type ",(0,d.jsx)(n.A,{})]}),(0,d.jsxs)("select",{className:p,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{GST_Inclusive:Number(e.target.value)})),value:s.GST_Inclusive,required:!0,children:[(0,d.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,d.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,d.jsx)("option",{value:2,children:"Not Taxable"})]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Tax Type"}),(0,d.jsxs)("select",{className:p,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{IS_IGST:Number(e.target.value)})),value:s.IS_IGST,children:[(0,d.jsx)("option",{value:"0",children:"GST"}),(0,d.jsx)("option",{value:"1",children:"IGST"})]})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Stock Item Ledger Name"}),(0,d.jsx)(o.Ay,{value:{value:s.Stock_Item_Ledger_Name,label:s.Stock_Item_Ledger_Name},onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Stock_Item_Ledger_Name:e.value})),options:[{value:"",label:"Search",isDisabled:!0},...v.map(e=>({value:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name,label:null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name}))],styles:l.MR,menuPortalTarget:document.body,required:!0,isSearchable:!0,placeholder:"Select",maxMenuHeight:300})]}),(0,d.jsxs)("div",{className:"col-xl-3 col-md-4 col-sm-6 p-2",children:[(0,d.jsx)("label",{className:"fa-13",children:"Status"}),(0,d.jsxs)("select",{value:null===s||void 0===s?void 0:s.Cancel_status,className:p,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Cancel_status:e.target.value})),children:[(0,d.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,d.jsx)("option",{value:"1",children:"New"}),(0,d.jsx)("option",{value:"2",children:"Progess"}),(0,d.jsx)("option",{value:"3",children:"Completed"}),(0,d.jsx)("option",{value:"0",children:"Canceled"})]})]})]}),(0,d.jsx)("label",{className:"fa-13",children:"Narration"}),(0,d.jsx)("textarea",{className:"cus-inpt fa-14",rows:2,value:s.Narration,onChange:e=>i(t=>(0,a.A)((0,a.A)({},t),{},{Narration:e.target.value}))})]})}},40039:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=s(81512)},42841:(e,t,s)=>{var a=s(24994);t.A=void 0;var o=a(s(40039)),l=s(70579);t.A=(0,o.default)((0,l.jsx)("path",{d:"M6 6v2h8.59L5 17.59 6.41 19 16 9.41V18h2V6z"}),"ArrowOutward")},43735:(e,t,s)=>{s.d(t,{A:()=>E});var a=s(89379),o=s(65043),l=s(83462),r=s(12110),n=s(17392),d=s(11906),i=s(26494),c=s(20656),u=s(63406),m=s(91036),_=s(97707),v=s(70141),p=s(33438),x=s(51387),h=s(83560),I=s(65074),g=s(48471),f=s(14844),A=s(97280),C=s(38641),j=s(24651),b=s(56779),N=s(34104),y=s(35786),S=s(70579);const T=(0,_.aN)().user,E=e=>{let{loadingOn:t,loadingOff:s,open:c,onClose:u,editValues:E,defaultValues:R,transactionType:L,onSuccess:k}=e;const[P,G]=(0,o.useState)({products:[],branch:[],retailers:[],voucherType:[],uom:[],staff:[],staffType:[],brand:[],godown:[],expence:[],stockInGodown:[],stockItemLedgerName:[]}),[V,B]=(0,o.useState)({addProductDialog:!1,importFromSaleOrder:!1}),[D,z]=(0,o.useState)(A.Q4),[M,O]=(0,o.useState)([]),[F,Q]=(0,o.useState)([]),[H,$]=(0,o.useState)([]),[U,q]=(0,o.useState)(null),W=(0,_.id)(D.GST_Inclusive,1),X=(0,_.id)(D.GST_Inclusive,2),J=(0,_.id)(D.IS_IGST,1),K=X?"zerotax":W?"remove":"add",Y=3-M.length;(0,o.useEffect)(()=>{if(!c)return;(async()=>{try{t&&t();const[e,s,o,l,r,n,d,i,c,u,m]=await Promise.all([(0,I.z)({address:"masters/branch/dropDown"}),(0,I.z)({address:"masters/products"}),(0,I.z)({address:"masters/retailers/dropDown?Company_Id=".concat(null===T||void 0===T?void 0:T.Company_id)}),(0,I.z)({address:"purchase/voucherType"}),(0,I.z)({address:"masters/uom"}),(0,I.z)({address:"dataEntry/costCenter"}),(0,I.z)({address:"dataEntry/costCenter/category"}),(0,I.z)({address:"dataEntry/godownLocationMaster"}),(0,I.z)({address:"masters/defaultAccountMaster"}),(0,I.z)({address:"sales/stockInGodown"}),(0,I.z)({address:"purchase/stockItemLedgerName?type=SALES"})]),v=(e.success?e.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.BranchName).localeCompare(null===t||void 0===t?void 0:t.BranchName)),p=(s.success?s.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Product_Name).localeCompare(null===t||void 0===t?void 0:t.Product_Name)),x=(o.success?o.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Retailer_Name).localeCompare(null===t||void 0===t?void 0:t.Retailer_Name)),h=(l.success?l.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Voucher_Type).localeCompare(null===t||void 0===t?void 0:t.Voucher_Type)),g=(r.success?r.data:[]).sort((e,t)=>String(e.Units).localeCompare(t.Units)),f=(n.success?n.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Center_Name).localeCompare(null===t||void 0===t?void 0:t.Cost_Center_Name)),A=(d.success?d.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Cost_Category).localeCompare(null===t||void 0===t?void 0:t.Cost_Category)),C=(i.success?i.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Godown_Name).localeCompare(null===t||void 0===t?void 0:t.Godown_Name)),j=(c.success?(0,_.$r)(c.data):[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Account_Name).localeCompare(null===t||void 0===t?void 0:t.Account_Name)),b=(u.success?u.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.stock_item_name).localeCompare(null===t||void 0===t?void 0:t.stock_item_name)),N=(m.success?m.data:[]).sort((e,t)=>String(null===e||void 0===e?void 0:e.Stock_Item_Ledger_Name).localeCompare(null===t||void 0===t?void 0:t.Stock_Item_Ledger_Name));G(e=>(0,a.A)((0,a.A)({},e),{},{products:p,branch:v,retailers:x,voucherType:h,uom:g,staff:f,staffType:A,godown:C,brand:(0,_.Mn)(p,"Brand",["Brand_Name"]),expence:j.filter(e=>!(0,_.xL)(e.Type,"DEFAULT")).map(e=>({Id:e.Acc_Id,Expence_Name:e.Account_Name})),stockInGodown:b,stockItemLedgerName:N}))}catch(e){console.error("Error fetching data:",e)}finally{s&&s()}})()},[null===T||void 0===T?void 0:T.Company_id,c]);(0,o.useEffect)(()=>{O(e=>[...e].map(e=>Object.fromEntries(Object.entries(e).map(t=>{let[s,a]=t;const o=function(){var e;let t=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(e=>(0,_.id)(e.Product_Id,t)))&&void 0!==e?e:{}}(P.products,null===e||void 0===e?void 0:e.Item_Id),l=J?o.Igst_P:o.Gst_P,r=l>0,{Bill_Qty:n,Item_Rate:d,Amount:i}=e,c=(0,f.v)(d,l,K),u=(0,f.v)(i,l,K),m=J?0:u.cgst_per,v=J?u.igst_per:0,p=J?0:u.cgst_amount,x=J?u.igst_amount:0;switch(s){case"Taxable_Rate":return[s,c.base_amount];case"Total_Qty":return[s,n];case"Taxble":return[s,r?1:0];case"Taxable_Amount":return[s,u.base_amount];case"Tax_Rate":return[s,l];case"Cgst":case"Sgst":return[s,null!==m&&void 0!==m?m:0];case"Cgst_Amo":case"Sgst_Amo":return[s,X?0:p];case"Igst":return[s,null!==v&&void 0!==v?v:0];case"Igst_Amo":return[s,X?0:x];case"Final_Amo":return[s,u.with_tax];default:return[s,e[s]||a]}}))))},[P.products,J,K]),(0,o.useEffect)(()=>{Q(e=>[...e].map(e=>{const t=J?(0,_.Ro)(null===e||void 0===e?void 0:e.Igst):0,s=J?0:(0,_.Ro)(null===e||void 0===e?void 0:e.Cgst),o=J?0:(0,_.Ro)(null===e||void 0===e?void 0:e.Sgst),l=(0,_.Ro)(null===e||void 0===e?void 0:e.Expence_Value),r=J?t:(0,_.Lr)(s,o),n=(0,f.v)(l,r,K);return(0,a.A)((0,a.A)({},e),{},{Cgst:s,Sgst:o,Igst:t,Expence_Value:l,Cgst_Amo:s>0?n.cgst_amount:0,Sgst_Amo:o>0?n.sgst_amount:0,Igst_Amo:t>0?n.igst_amount:0})}))},[P.expence,J,K]),(0,o.useEffect)(()=>{if((0,_.aF)(E)&&Array.isArray(null===E||void 0===E?void 0:E.ProductList)&&P.staff.length>0&&P.staffType.length>0){const{ProductList:e,Staffs_Array:t,Broker_Id:s,Broker_Name:o,Expence_Array:l,Transporter_Id:r,Transporter_Name:n}=E,d=(E.Expence_Array||E.expenceArray||E.Expenses||E.expenses||E.ExpenceList||E.expenceList,E.Retailer_Id||E.Custome_Id||0),i=P.retailers.find(e=>(0,_.id)(e.Retailer_Id,d));Q((0,_.$r)(l).map(e=>Object.fromEntries(Object.entries(A.ju).map(t=>{var s;let[a,o]=t;return[a,null!==(s=e[a])&&void 0!==s?s:o]})))),z(e=>(0,a.A)((0,a.A)({},e),{},{Do_Id:E.Pre_Id||"",So_No:E.Pre_Id||"",So_Date:E.Pre_Date?(0,_.ny)(E.Pre_Date):"",Retailer_Id:E.Custome_Id||(null===E||void 0===E?void 0:E.Retailer_Id)||"",Retailer_Name:(null===i||void 0===i?void 0:i.Retailer_Name)||"",Broker_Id:E.Broker_Id||"",Broker_Name:E.Broker_Name||"",Transporter_Id:E.Transporter_Id||"",Transporter_Name:E.Transporter_Name||"",TrasnportType:E.TrasnportType||2,Voucher_Type:E.baseData||0,Status:E.Status||"",isConverted:E.isConverted||0,Total_Invoice_value:E.Total_Invoice_value||0})),O(e.map(e=>(0,a.A)((0,a.A)({},A.a4),{},{Item_Id:e.Item_Id||"",Item_Name:e.Product_Name||"",HSN_Code:e.HSN_Code||"",Bill_Qty:e.Bill_Qty||0,Act_Qty:e.Bill_Qty||0,Item_Rate:e.Item_Rate||0,Amount:e.Amount||0,GoDown_Id:e.Godown_Id||"",Tax_Rate:e.Tax_Rate||0,Cgst:e.Cgst||0,UOM:e.Unit_Id||0,Units:e.Unit_Name||"",Sgst:e.Sgst||0,Igst:e.Igst||0,Cgst_Amo:e.Cgst_Amo||0,Sgst_Amo:e.Sgst_Amo||0,Igst_Amo:e.Igst_Amo||0,Taxable_Amount:e.Taxable_Amount||0,Final_Amo:e.Final_Amo||0})));let c=[];const u=e=>{const t=P.staffType.find(t=>(0,_.xL)(t.Cost_Category,e));return(null===t||void 0===t?void 0:t.Cost_Category_Id)||""};if(s&&!(0,_.id)(s,0)){const e=P.staff.find(e=>(0,_.id)(e.Cost_Center_Id,s)),t=u("Broker");e&&c.push({Involved_Emp_Id:e.Cost_Center_Id,EmpName:e.Cost_Center_Name,Cost_Center_Type_Id:t,Cost_Center_Type:"Broker"})}if(r&&!(0,_.id)(r,0)){const e=P.staff.find(e=>(0,_.id)(e.Cost_Center_Id,r)),t=u("Transport");e&&c.push({Involved_Emp_Id:e.Cost_Center_Id,EmpName:e.Cost_Center_Name,Cost_Center_Type_Id:t,Cost_Center_Type:"Transporter"})}(0,_.$r)(t).forEach((e,t)=>{const s=P.staff.find(t=>(0,_.id)(t.Cost_Center_Id,e.Staff_Id));let a=e.Cost_Cat_Id,o=e.Cost_Cat_Name;!a&&o&&(a=u(o)),s&&c.push({Involved_Emp_Id:s.Cost_Center_Id,EmpName:s.Cost_Center_Name,Cost_Center_Type_Id:a||"",Cost_Center_Type:o||""})}),$(c)}},[E,P.staff,P.staffType,P.retailers]),(0,o.useEffect)(()=>{Q(e=>[...e].map(e=>{const t=J?(0,_.Ro)(null===e||void 0===e?void 0:e.Igst):0,s=J?0:(0,_.Ro)(null===e||void 0===e?void 0:e.Cgst),o=J?0:(0,_.Ro)(null===e||void 0===e?void 0:e.Sgst),l=(0,_.Ro)(null===e||void 0===e?void 0:e.Expence_Value),r=J?t:(0,_.Lr)(s,o),n=(0,f.v)(l,r,K);return(0,a.A)((0,a.A)({},e),{},{Cgst:s,Sgst:o,Igst:t,Expence_Value:l,Cgst_Amo:s>0?n.cgst_amount:0,Sgst_Amo:o>0?n.sgst_amount:0,Igst_Amo:t>0?n.igst_amount:0})}))},[P.expence,J,K]);const Z=()=>{t&&t();const e=H.map(e=>({Involved_Emp_Id:e.Involved_Emp_Id,Cost_Center_Type_Id:e.Cost_Center_Type_Id})),o=M.filter(e=>!(0===Number(e.Bill_Qty)&&0===Number(e.Act_Qty)));(0,I.z)({address:"sales/salesOrderSalesInvoice",method:"POST",bodyData:(0,a.A)((0,a.A)((0,a.A)({},R),D),{},{Pre_Id:D.Do_Id,Product_Array:o,staff_Involved_List:e,Expence_Array:F,transactionType:L})}).then(e=>{e.success?(z(A.Q4),O([]),Q([]),$([]),m.oR.success(e.message),k&&k(),u(!0)):m.oR.warn(e.message)}).catch(e=>console.error(e)).finally(()=>{s&&s()})};return c?(0,S.jsx)(l.A,{open:c,onClose:()=>u(!1),maxWidth:"xl",fullWidth:!0,children:(0,S.jsxs)("div",{style:{maxHeight:"90vh",overflow:"auto"},children:[(0,S.jsx)(b.A,{orderProducts:M,setOrderProducts:O,open:V.addProductDialog,onClose:()=>{B(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!1})),q(null)},products:P.products,brands:P.brand,uom:P.uom,godowns:P.godown,GST_Inclusive:D.GST_Inclusive,IS_IGST:J,editValues:U,initialValue:(0,a.A)((0,a.A)({},A.a4),{},{Pre_Id:D.So_No}),stockInGodown:P.stockInGodown}),(0,S.jsxs)(r.A,{children:[(0,S.jsxs)("div",{className:"d-flex flex-wrap align-items-center border-bottom py-2 px-3",children:[(0,S.jsx)("span",{className:"flex-grow-1 fa-16 fw-bold",children:"Sales Invoice"}),(0,S.jsxs)("span",{children:[(0,S.jsx)(n.A,{onClick:()=>u(!1),children:(0,S.jsx)(p.A,{})}),(0,S.jsx)(d.A,{onClick:()=>Z(),variant:"contained",children:"Submit"})]})]}),(0,S.jsxs)(i.A,{children:[(0,S.jsxs)("div",{className:"row p-0",children:[(0,S.jsx)("div",{className:"col-xxl-3 col-lg-4 col-md-5 p-2",children:(0,S.jsx)("div",{className:"border p-2",style:{minHeight:"30vh",height:"100%"},children:(0,S.jsx)(w,{StaffArray:H,setStaffArray:e=>{$(e)},costCenter:P.staff,costCategory:P.staffType})})}),(0,S.jsx)("div",{className:"col-xxl-9 col-lg-8 col-md-7 py-2 px-0",children:(0,S.jsx)("div",{className:"border px-3 py-1",style:{minHeight:"30vh",height:"100%"},children:(0,S.jsx)(C.A,{invoiceInfo:D,setInvoiceInfo:z,retailers:P.retailers,branches:P.branch,voucherType:P.voucherType,stockItemLedgerName:P.stockItemLedgerName,onChangeRetailer:()=>{O([]),Q([])}})})})]}),(0,S.jsx)(g.Ay,{title:"Items",headerFontSizePx:13,bodyFontSizePx:13,EnableSerialNumber:!0,disablePagination:!0,ButtonArea:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.A,{onClick:()=>{q(null),B(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!0}))},sx:{ml:1},variant:"outlined",type:"button",startIcon:(0,S.jsx)(v.A,{}),disabled:!(0,_.IQ)(D.Retailer_Id)||M.length>0&&(0,_.IQ)(D.So_No),children:"Add Product"}),(0,S.jsx)(N.A,{loadingOn:t,loadingOff:s,open:V.importFromSaleOrder,onClose:()=>B(e=>(0,a.A)((0,a.A)({},e),{},{importFromSaleOrder:!1})),retailer:null===D||void 0===D?void 0:D.Retailer_Id,selectedItems:M,setSelectedItems:O,staffArray:H,setStaffArray:$,products:P.products,GST_Inclusive:D.GST_Inclusive,IS_IGST:J,invoiceInfo:D,setInvoiceInfo:z,godowns:P.godown,stockInGodown:P.stockInGodown})]}),dataArray:[...[...M,...Array.from({length:Y>0?Y:0}).map(e=>A.a4)].filter(e=>!(0===Number(e.Bill_Qty)&&0===Number(e.Act_Qty)))],columns:[(0,g.Lj)("Item_Name","string"),(0,g.Lj)("HSN_Code","string"),(0,g.Lj)("Bill_Qty","number"),(0,g.Lj)("Act_Qty","number"),(0,g.Lj)("Item_Rate","number"),{isVisible:1,ColumnHeader:"Tax",isCustomCell:!0,Cell:e=>{let{row:t}=e;const{Cgst:s=0,Sgst:a=0,Igst:o=0,Cgst_Amo:l=0,Sgst_Amo:r=0,Igst_Amo:n=0}=t,d=J?o:(0,_.Lr)(s,a),i=J?n:(0,_.Lr)(l,r);return(0,_.IQ)(null===t||void 0===t?void 0:t.Item_Id)?"".concat(i," - (").concat(d," %)"):""}},{isVisible:1,ColumnHeader:"Godown",isCustomCell:!0,Cell:e=>{var t,s;let{row:a}=e;return null!==(t=null===(s=P.godown.find(e=>(0,_.id)(e.Godown_Id,null===a||void 0===a?void 0:a.GoDown_Id)))||void 0===s?void 0:s.Godown_Name)&&void 0!==t?t:""}},(0,g.Lj)("Amount","number"),{isCustomCell:!0,Cell:e=>{let{row:t}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(n.A,{onClick:()=>{q(t),B(e=>(0,a.A)((0,a.A)({},e),{},{addProductDialog:!0}))},size:"small",type:"button",disabled:!(0,_.IQ)(null===t||void 0===t?void 0:t.Item_Id),children:(0,S.jsx)(h.A,{})}),(0,S.jsx)(n.A,{size:"small",type:"button",onClick:()=>O(e=>e.filter(e=>!(0,_.id)(e.Item_Id,t.Item_Id))),color:"error",disabled:!(0,_.IQ)(null===t||void 0===t?void 0:t.Item_Id),children:(0,S.jsx)(x.A,{})})]})},ColumnHeader:"Action",isVisible:1}]}),(0,S.jsx)("br",{}),(0,S.jsx)(y.A,{invoiceExpences:F,setInvoiceExpences:Q,expenceMaster:P.expence,IS_IGST:J,taxType:K}),(0,S.jsx)("br",{}),(0,S.jsx)(j.A,{invoiceProducts:M,invoiceExpences:F,isNotTaxableBill:X,isInclusive:W,IS_IGST:J,products:P.products,invoiceInfo:D,setInvoiceInfo:z})]})]})]})}):null},w=e=>{let{StaffArray:t=[],setStaffArray:s,costCenter:o=[],costCategory:l=[]}=e;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{className:"d-flex align-items-center flex-wrap mb-2 border-bottom pb-2",children:[(0,S.jsx)("h6",{className:"flex-grow-1 m-0",children:"Staff Involved"}),(0,S.jsx)(d.A,{variant:"outlined",color:"primary",type:"button",onClick:()=>s(e=>[...e,{Involved_Emp_Id:"",EmpName:"",Cost_Center_Type_Id:"",Cost_Center_Type:""}]),children:"Add"})]}),(0,S.jsxs)("table",{className:"table table-bordered",children:[(0,S.jsx)("thead",{children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"fa-13",children:"Sno"}),(0,S.jsx)("th",{className:"fa-13",children:"Staff Name"}),(0,S.jsx)("th",{className:"fa-13",children:"Category"}),(0,S.jsx)("th",{className:"fa-13",children:"#"})]})}),(0,S.jsx)("tbody",{children:(0,_.$r)(t).map((e,r)=>{const d=e.Cost_Center_Type_Id||(e=>{const t=l.find(t=>(0,_.xL)(t.Cost_Category,e));return(null===t||void 0===t?void 0:t.Cost_Category_Id)||""})(e.Cost_Center_Type);return(0,S.jsxs)("tr",{children:[(0,S.jsx)("td",{className:"fa-13 vctr text-center",children:r+1}),(0,S.jsx)("td",{className:"fa-13 w-100 p-0",children:(0,S.jsx)(c.Ay,{value:{value:e.Involved_Emp_Id,label:e.EmpName||"Select Staff"},onChange:e=>{o.find(t=>(0,_.id)(t.Cost_Center_Id,e.value));const l=t.map((t,s)=>s===r?(0,a.A)((0,a.A)({},t),{},{Involved_Emp_Id:Number(e.value),EmpName:e.label}):t);s(l)},options:o.filter(e=>!t.some((t,s)=>s!==r&&(0,_.id)(t.Involved_Emp_Id,e.Cost_Center_Id))).map(e=>({value:e.Cost_Center_Id,label:e.Cost_Center_Name})),styles:u.MR,isSearchable:!0,placeholder:"Select Staff"})}),(0,S.jsx)("td",{className:"fa-13 vctr p-0",style:{maxWidth:"130px",minWidth:"100px"},children:(0,S.jsxs)("select",{value:d,onChange:e=>{const o=l.find(t=>(0,_.id)(t.Cost_Category_Id,e.target.value)),n=t.map((t,s)=>s===r?(0,a.A)((0,a.A)({},t),{},{Cost_Center_Type_Id:e.target.value,Cost_Center_Type:(null===o||void 0===o?void 0:o.Cost_Category)||""}):t);s(n)},className:"cus-inpt p-2 border-0",children:[(0,S.jsx)("option",{value:"",children:"Select"}),l.map((e,t)=>(0,S.jsx)("option",{value:e.Cost_Category_Id,children:e.Cost_Category},t))]})}),(0,S.jsx)("td",{className:"fa-13 vctr p-0",children:(0,S.jsx)(n.A,{onClick:()=>{const e=t.filter((e,t)=>t!==r);s(e)},size:"small",children:(0,S.jsx)(x.A,{color:"error"})})})]},r)})})]})]})}},81512:(e,t,s)=>{s.r(t),s.d(t,{capitalize:()=>o.A,createChainedFunction:()=>l.A,createSvgIcon:()=>r.A,debounce:()=>n.A,deprecatedPropType:()=>d,isMuiElement:()=>i.A,ownerDocument:()=>c.A,ownerWindow:()=>u.A,requirePropFactory:()=>m,setRef:()=>_,unstable_ClassNameGenerator:()=>A,unstable_useEnhancedEffect:()=>v.A,unstable_useId:()=>p.A,unsupportedProp:()=>x,useControlled:()=>h.A,useEventCallback:()=>I.A,useForkRef:()=>g.A,useIsFocusVisible:()=>f.A});var a=s(25430),o=s(6803),l=s(6593),r=s(59662),n=s(80950);const d=function(e,t){return()=>null};var i=s(90154),c=s(22427),u=s(36078);const m=function(e,t){return()=>null};const _=s(69184).A;var v=s(55013),p=s(45879);const x=function(e,t,s,a,o){return null};var h=s(54516),I=s(93319),g=s(95849),f=s(87844);const A={configure:e=>{a.A.configure(e)}}},83560:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(59662),o=s(70579);const l=(0,a.A)((0,o.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},90154:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(65043);const o=function(e,t){var s,o;return a.isValidElement(e)&&-1!==t.indexOf(null!=(s=e.type.muiName)?s:null==(o=e.type)||null==(o=o._payload)||null==(o=o.value)?void 0:o.muiName)}}}]);
//# sourceMappingURL=3096.b2cb309f.chunk.js.map