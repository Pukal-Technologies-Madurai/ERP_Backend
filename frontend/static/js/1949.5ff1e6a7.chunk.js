"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[1949],{14792:(e,l,s)=>{s.d(l,{A:()=>t});var a=s(70579);const t=()=>(0,a.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},18124:(e,l,s)=>{s.d(l,{A:()=>d});var a=s(59662),t=s(70579);const d=(0,a.A)((0,t.jsx)("path",{d:"M3 13h2v-2H3zm0 4h2v-2H3zm0-8h2V7H3zm4 4h14v-2H7zm0 4h14v-2H7zM7 7v2h14V7z"}),"List")},21949:(e,l,s)=>{s.r(l),s.d(l,{default:()=>_,payTypeAndStatus:()=>y});var a=s(89379),t=s(12110),d=s(11906),o=s(26494),i=s(97707),n=s(65074),c=s(20656),r=s(65043),u=s(73216),v=s(60108),h=s(91036),m=s(14792),p=s(59662),x=s(70579);const j=(0,p.A)((0,x.jsx)("path",{d:"M2.81 2.81 1.39 4.22l2.27 2.27C2.61 8.07 2 9.96 2 12c0 5.52 4.48 10 10 10 2.04 0 3.93-.61 5.51-1.66l2.27 2.27 1.41-1.41zM12 20c-4.41 0-8-3.59-8-8 0-1.48.41-2.86 1.12-4.06l10.94 10.94C14.86 19.59 13.48 20 12 20M7.94 5.12 6.49 3.66C8.07 2.61 9.96 2 12 2c5.52 0 10 4.48 10 10 0 2.04-.61 3.93-1.66 5.51l-1.46-1.46C19.59 14.86 20 13.48 20 12c0-4.41-3.59-8-8-8-1.48 0-2.86.41-4.06 1.12"}),"HideSource");var A=s(18124);const b=e=>{var l,s,t;let{row:o={},receiptsPaymentInfo:n=[],setReceiptsPaymentInfo:c,Sno:u}=e;const[h,p]=(0,r.useState)(!1),[b,y]=(0,r.useState)(!1),_=(0,r.useMemo)(()=>{const e=n.find(e=>(0,i.id)(null===e||void 0===e?void 0:e.bill_id,null===o||void 0===o?void 0:o.Do_Id));return(0,i.aF)(e)?e:{}},[n,o]),N=(0,r.useMemo)(()=>n.findIndex(e=>(0,i.id)(null===e||void 0===e?void 0:e.bill_id,null===o||void 0===o?void 0:o.Do_Id)),[n,o]),C=(e,l)=>{c(s=>{const t=[...s];if(-1===N){const s=(0,a.A)({},v.h);return s.bill_id=null===o||void 0===o?void 0:o.Do_Id,s.bill_amount=(0,i.Ro)(null===o||void 0===o?void 0:o.Total_Invoice_value),s[e]=l,[...t,s]}return t[N][e]=l,t})},g=(0,r.useMemo)(()=>{var e;return Array.isArray(null===o||void 0===o?void 0:o.Payments)?null===o||void 0===o||null===(e=o.Payments)||void 0===e?void 0:e.reduce((e,l)=>(0,i.Lr)(e,l.collected_amount),0):0},[o]),f=(0,i.IQ)(null===_||void 0===_?void 0:_.bill_id);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border",children:u}),(0,x.jsx)("td",{className:"border",children:(0,x.jsx)("div",{children:(0,x.jsx)("input",{className:"form-check-input shadow-none pointer",style:{padding:"0.7em"},type:"checkbox",checked:f,onChange:()=>{f?c(e=>e.filter(e=>!(0,i.id)(e.bill_id,null===o||void 0===o?void 0:o.Do_Id))):C("bill_amount",(0,i.Ro)(null===o||void 0===o?void 0:o.Total_Invoice_value))}})})}),(0,x.jsx)("td",{className:"border",children:null===o||void 0===o?void 0:o.Do_Inv_No}),(0,x.jsx)("td",{className:"border",children:(0,i.yc)(null===o||void 0===o?void 0:o.Do_Date)}),(0,x.jsx)("td",{className:"border",children:(0,i.Ro)(null===o||void 0===o?void 0:o.Total_Invoice_value)}),(0,x.jsx)("td",{className:"border",children:g}),(0,x.jsx)("td",{className:"border",children:null===o||void 0===o?void 0:o.pendingAmount}),(0,x.jsx)("td",{className:"border",children:(0,i.Ro)(null===o||void 0===o||null===(l=o.Payments)||void 0===l?void 0:l.length)})]}),(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,children:(0,x.jsxs)("div",{className:"d-flex align-items-end flex-wrap",children:[(0,x.jsxs)("div",{className:"flex-grow-1",children:[(0,x.jsxs)("label",{className:"fa-14 w-100",children:["Receipt Amount (\u20b9)",f&&(0,x.jsx)(m.A,{})]}),(0,x.jsx)("input",{onInput:i.BE,disabled:!f,value:null!==_&&void 0!==_&&_.collected_amount?(0,i.Ro)(null===_||void 0===_?void 0:_.collected_amount):"",onChange:e=>C("collected_amount",e.target.value),style:{width:"100%",maxWidth:"350px"},className:"cus-inpt border p-2",placeholder:"Enter Receipt Amount",max:(0,i.Ro)(null===o||void 0===o?void 0:o.pendingAmount),required:f})]}),(0,x.jsxs)(d.A,{startIcon:b?(0,x.jsx)(j,{}):(0,x.jsx)(A.A,{}),onClick:()=>y(e=>!e),children:[b?"Hide":"Show"," Invoice"]}),(0,x.jsxs)(d.A,{startIcon:h?(0,x.jsx)(j,{}):(0,x.jsx)(A.A,{}),onClick:()=>p(e=>!e),disabled:!Array.isArray(null===o||void 0===o?void 0:o.Payments)||0===(0,i.Ro)(null===o||void 0===o||null===(s=o.Payments)||void 0===s?void 0:s.length),children:[h?"Hide":"Previous"," Receipts"]})]})})}),b&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:8,children:["Bill Details of - ",null===o||void 0===o?void 0:o.Do_Inv_No]})}),(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,className:"p-0",children:(0,x.jsx)("div",{className:"table-responsive fa-13 m-0",children:(0,x.jsxs)("table",{className:"table m-0",children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:["SNo","Item","Quantity","Rate","Pack","Tax","Amount"].map((e,l)=>(0,x.jsx)("th",{className:"bg-light",children:e},l))})}),(0,x.jsx)("tbody",{children:Array.isArray(null===o||void 0===o?void 0:o.Products_List)&&o.Products_List.map((e,l)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:l+1}),(0,x.jsx)("td",{children:null===e||void 0===e?void 0:e.Product_Name}),(0,x.jsx)("td",{children:null===e||void 0===e?void 0:e.Bill_Qty}),(0,x.jsx)("td",{children:null===e||void 0===e?void 0:e.Item_Rate}),(0,x.jsx)("td",{children:null===e||void 0===e?void 0:e.UOM}),(0,x.jsx)("td",{children:(0,i.Lr)(null===e||void 0===e?void 0:e.Cgst_Amo,null===e||void 0===e?void 0:e.Sgst_Amo)||(0,i.Ro)(null===e||void 0===e?void 0:e.Igst_Amo)}),(0,x.jsx)("td",{children:null===e||void 0===e?void 0:e.Amount})]},l))})]})})})})]}),h&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("tr",{children:(0,x.jsxs)("td",{colSpan:8,children:["Previous Receipts of - ",null===o||void 0===o?void 0:o.Do_Inv_No]})}),(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,className:"p-0 border-0",children:(0,x.jsx)("div",{className:"table-responsive fa-13",children:(0,x.jsxs)("table",{className:"table m-0",children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:["SNo","Collected By","Amount","Date","Receipt Type","payment_status","Verify Status"].map((e,l)=>(0,x.jsx)("th",{className:"bg-light border",children:e},l))})}),(0,x.jsx)("tbody",{children:null===(t=Array.isArray(null===o||void 0===o?void 0:o.Payments)?null===o||void 0===o?void 0:o.Payments:[])||void 0===t?void 0:t.filter(e=>!(0,i.id)(e.auto_id,null===o||void 0===o?void 0:o.auto_id)).map((e,l)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{className:"border",children:l+1}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.CreatedByGet}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collected_amount}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_date}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.collection_type}),(0,x.jsx)("td",{className:"border",children:null===e||void 0===e?void 0:e.verify_status})]},l))})]})})})}),(0,x.jsx)("tr",{children:(0,x.jsx)("td",{colSpan:8,className:"border-0"})})]})]})},y=[{type:"CASH",default:"CREATED-CASH",statusOptions:["CREATED-CASH","CASH-PROCESSING","CASH-MISSING"]},{type:"UPI",default:"CREATED-UPI",statusOptions:["CREATED-UPI","UPI-PROCESSING","UPI-NOT-RECEIVED"]},{type:"CHEQUE",default:"CREATED-CHEQUE",statusOptions:["CREATED-CHEQUE","CHEQUE-PROCESSING","CHEQUE-BOUNCE"]},{type:"BANK",default:"CREATED-BANK-TRANSFER",statusOptions:["CREATED-BANK-TRANSFER","BANK-PROCESSING","BANK-NOT-RECEIVED"]}],_=e=>{var l;let{loadingOn:s,loadingOff:p}=e;const j=(0,u.Zp)(),[A,_]=(0,r.useState)([]),[N,C]=(0,r.useState)([]),[g,f]=(0,r.useState)({salesPerson:[],voucherData:[],creditAccount:[]}),[S,R]=(0,r.useState)(v.b),[I,E]=(0,r.useState)([]),[P,D]=(0,r.useState)({Fromdate:(0,i.ny)(),Todate:(0,i.ny)(),Retailer:{value:"",label:"Search by Retailer..."}}),T=(null===(l=y.find(e=>e.type===(null===S||void 0===S?void 0:S.collection_type)))||void 0===l?void 0:l.statusOptions)||{};(0,r.useEffect)(()=>{(0,n.z)({address:"receipt/getRetailersWhoHasBills"}).then(e=>{e.success?C(e.data):C([])}).catch(e=>console.error(e)),(0,n.z)({address:"masters/users/salesPerson/dropDown"}).then(e=>{e.success?f(l=>(0,a.A)((0,a.A)({},l),{},{salesPerson:e.data})):f(e=>(0,a.A)((0,a.A)({},e),{},{salesPerson:[]}))}).catch(e=>console.error(e)),(0,n.z)({address:"masters/voucher"}).then(e=>{e.success?f(l=>(0,a.A)((0,a.A)({},l),{},{voucherData:e.data})):f(e=>(0,a.A)((0,a.A)({},e),{},{voucherData:[]}))}).catch(e=>console.error(e)),(0,n.z)({address:"receipt/creditAccounts"}).then(e=>{e.success?f(l=>(0,a.A)((0,a.A)({},l),{},{creditAccount:e.data})):f(e=>(0,a.A)((0,a.A)({},e),{},{creditAccount:[]}))}).catch(e=>console.error(e))},[]),(0,r.useEffect)(()=>{(0,i.IQ)(S.retailer_id)&&(s&&s(),(0,n.z)({address:"receipt/retailerBills?retailer_id=".concat(S.retailer_id)}).then(e=>{e.success?_(e.data):_([])}).catch(e=>console.error(e)).finally(()=>{p&&p()}))},[S.retailer_id]);const H=(0,r.useMemo)(()=>I.reduce((e,l)=>(0,i.Lr)(e,null===l||void 0===l?void 0:l.collected_amount),0),[I]),w=()=>{s&&s(),(0,n.z)({address:"receipt/collectionReceipts",method:(0,i.IQ)(S.collection_id)&&S.collection_id>0?"PUT":"POST",bodyData:(0,a.A)((0,a.A)({},S),{},{Collections:I})}).then(e=>{e.success?(h.oR.success((null===e||void 0===e?void 0:e.message)||"Receipt Created"),D(e=>(0,a.A)((0,a.A)({},e),{},{Retailer:{value:"",label:"Search by Retailer..."}})),R(v.b),E([]),_([])):h.oR.error((null===e||void 0===e?void 0:e.message)||"Failed to create Receipt")}).catch(e=>console.error(e)).finally(()=>{p&&p()})};return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(t.A,{children:(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),w()},children:[(0,x.jsxs)("div",{className:"px-3 py-2 d-flex align-items-center",children:[(0,x.jsx)("h5",{className:"m-0 flex-grow-1",children:"Receipt Creation"}),(0,x.jsx)(d.A,{variant:"outlined",type:"button",className:"me-1",onClick:()=>j("/erp/crm/paymentCollection"),children:"Back"}),(0,x.jsx)(d.A,{variant:"outlined",type:"submit",disabled:0===I.length||I.every(e=>(0,i.Ro)(e.collected_amount)<=0),children:"save receipt"})]}),(0,x.jsxs)(o.A,{children:[(0,x.jsx)("label",{children:"Retailer"}),(0,x.jsx)("div",{className:"d-flex",children:(0,x.jsx)("div",{style:{width:"100%",maxWidth:"400px"},children:(0,x.jsx)(c.Ay,{menuPortalTarget:document.body,options:[{value:"",label:"select",isDisabled:!0},...N.map(e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name}))],value:P.Retailer,menu:!0,onChange:e=>{D(l=>(0,a.A)((0,a.A)({},l),{},{Retailer:e})),R(l=>(0,a.A)((0,a.A)({},l),{},{retailer_id:e.value}))},placeholder:"Search by Retailer"})})}),(0,x.jsxs)("div",{className:"row fa-13 pb-3 mt-2",children:[(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Date",(0,x.jsx)(m.A,{})]}),(0,x.jsx)("input",{type:"date",className:"cus-inpt border p-2",value:S.collection_date,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{collection_date:e.target.value})),required:!0})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Voucher",(0,x.jsx)(m.A,{})]}),(0,x.jsxs)("select",{className:"cus-inpt border p-2",value:S.voucher_id,required:!0,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{voucher_id:e.target.value})),children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select"}),g.voucherData.filter(e=>(0,i.xL)(e.Type,"Receipt")).map((e,l)=>(0,x.jsx)("option",{value:e.Vocher_Type_Id,children:e.Voucher_Type},l))]})]})]}),(0,x.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Payment Type",(0,x.jsx)(m.A,{})]}),(0,x.jsxs)("select",{className:"cus-inpt border p-2",value:S.collection_type,required:!0,onChange:e=>R(l=>{var s;return(0,a.A)((0,a.A)({},l),{},{collection_type:e.target.value,payment_status:null===(s=y.find(l=>l.type===e.target.value))||void 0===s?void 0:s.default})}),children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select"}),(0,x.jsx)("option",{value:"CASH",children:"CASH"}),(0,x.jsx)("option",{value:"UPI",children:"UPI"}),(0,x.jsx)("option",{value:"CHEQUE",children:"CHEQUE"}),(0,x.jsx)("option",{value:"BANK",children:"BANK"})]})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Payment Account ",(0,x.jsx)(m.A,{})]}),(0,x.jsxs)("select",{className:"cus-inpt border p-2",value:S.collection_account,required:!0,disabled:!S.collection_type,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{collection_account:e.target.value})),children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select"}),g.creditAccount.filter(e=>(0,i.xL)(S.collection_type,"CASH")?(0,i.xL)(e.Type,"CASH"):!(0,i.xL)(e.Type,"CASH")).map((e,l)=>(0,x.jsx)("option",{value:null===e||void 0===e?void 0:e.Id,children:null===e||void 0===e?void 0:e.Bank_Name},l))]})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Payment Status",(0,x.jsx)(m.A,{})]}),(0,x.jsxs)("select",{className:"cus-inpt border p-2",value:S.payment_status,required:!0,disabled:!S.collection_type,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{payment_status:e.target.value})),children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select"}),T.map((e,l)=>(0,x.jsx)("option",{value:e,children:e},l)),(0,x.jsx)("option",{value:"Canceled",children:"Canceled"}),(0,x.jsx)("option",{value:"Completed",children:"Completed"})]})]})]}),(0,x.jsxs)("div",{className:"row fa-13 pb-3",children:[(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsx)("label",{children:"Payed By"}),(0,x.jsx)("input",{className:"cus-inpt border p-2",value:S.payed_by,placeholder:"Owner, Shop Keeper..",onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{payed_by:e.target.value}))})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-2",children:[(0,x.jsxs)("label",{children:["Amount Received By",(0,x.jsx)(m.A,{})]}),(0,x.jsxs)("select",{className:"cus-inpt border p-2",value:S.collected_by,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{collected_by:e.target.value})),required:!0,children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Select"}),g.salesPerson.map((e,l)=>(0,x.jsx)("option",{value:e.UserId,children:e.Name},l))]})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,x.jsx)("label",{className:"fa-14",children:"Verify Date"}),(0,x.jsx)("input",{type:"date",value:null!==S&&void 0!==S&&S.bank_date?null===S||void 0===S?void 0:S.bank_date:"",onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{bank_date:e.target.value})),className:"cus-inpt border border p-2"})]}),(0,x.jsxs)("div",{className:"col-lg-3 col-md-4 col-sm-6 p-1",children:[(0,x.jsx)("label",{className:"fa-14",children:"Verify Status"}),(0,x.jsxs)("select",{value:null===S||void 0===S?void 0:S.verify_status,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{verify_status:e.target.value})),className:"cus-inpt border border p-2",children:[(0,x.jsx)("option",{value:0,children:"Not-verified"}),(0,x.jsx)("option",{value:1,children:"verified"})]})]}),(0,x.jsxs)("div",{className:"col-lg-6 col-sm-8 p-1",children:[(0,x.jsx)("label",{className:"fa-14 w-100",children:"Narration"}),(0,x.jsx)("textarea",{style:{width:"100%",maxWidth:"450px"},className:"cus-inpt border p-2",value:null===S||void 0===S?void 0:S.narration,onChange:e=>R(l=>(0,a.A)((0,a.A)({},l),{},{narration:e.target.value})),placeholder:"Narration..."})]}),(0,x.jsxs)("div",{className:"col-lg-6 col-sm-4 p-1 text-end",children:[(0,x.jsx)("label",{className:"fa-14 w-100",children:"Total Receipt Amount"}),(0,x.jsx)("input",{className:"cus-inpt bg-white p-2 w-auto border border-primary text-primary",value:(0,i.e3)(H),disabled:!0})]})]}),(0,x.jsx)("div",{className:"table-responsive",children:(0,x.jsxs)("table",{className:"table table-bordered",children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:["Sno","#","Invoice No","Date","Invoice Value","Paid","Pending","Receipts"].map((e,l)=>(0,x.jsx)("th",{className:"bg-light fa-13 border",children:e},l))})}),(0,x.jsx)("tbody",{children:A.map((e,l)=>(0,x.jsx)(b,{row:e,Sno:l+1,receiptsPaymentInfo:I,setReceiptsPaymentInfo:E},l))})]})})]})]})})})}},26494:(e,l,s)=>{s.d(l,{A:()=>x});var a=s(58168),t=s(98587),d=s(65043),o=s(58387),i=s(68606),n=s(34535),c=s(6431),r=s(57056),u=s(32400);function v(e){return(0,u.Ay)("MuiCardContent",e)}(0,r.A)("MuiCardContent",["root"]);var h=s(70579);const m=["className","component"],p=(0,n.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,l)=>l.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),x=d.forwardRef(function(e,l){const s=(0,c.b)({props:e,name:"MuiCardContent"}),{className:d,component:n="div"}=s,r=(0,t.A)(s,m),u=(0,a.A)({},s,{component:n}),x=(e=>{const{classes:l}=e;return(0,i.A)({root:["root"]},v,l)})(u);return(0,h.jsx)(p,(0,a.A)({as:n,className:(0,o.A)(x.root,d),ownerState:u,ref:l},r))})},60108:(e,l,s)=>{s.d(l,{b:()=>d,h:()=>o});var a=s(97707);const t=(0,a.aN)().user,d={collection_id:"",collection_inv_no:"",voucher_id:"",collection_no:"",year_id:"",retailer_id:"",payed_by:"",collection_date:(0,a.ny)(),collection_type:"CASH",collection_account:"",payment_status:"",latitude:"",longitude:"",collected_by:"",total_amount:0,created_on:"",alterd_on:"",narration:"",verify_status:0,bank_date:"",created_by:t.UserId,updated_by:t.UserId,verified_by:t.UserId,verified_at:""},o={auto_id:"",collection_id:"",bill_id:"",bill_amount:0,collected_amount:0}}}]);
//# sourceMappingURL=1949.5ff1e6a7.chunk.js.map