"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[973],{3632:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(59662),s=a(70579);const r=(0,t.A)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},10204:(e,l,a)=>{a.d(l,{T:()=>t,X:()=>s});const t=[{id:0,label:"New",color:" bg-info text-white "},{id:1,label:"Verified",color:" bg-warning text-white "},{id:2,label:"Converted",color:" bg-success text-white "},{id:3,label:"Canceled",color:" bg-danger text-white "}],s=[{id:1,label:"New",color:" bg-info text-white "},{id:2,label:"Progess",color:" bg-warning text-white "},{id:3,label:"Completed",color:" bg-success text-white "},{id:4,label:"Canceled",color:" bg-danger text-white "}]},13479:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(59662),s=a(70579);const r=(0,t.A)((0,s.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Sync")},13899:(e,l,a)=>{a.d(l,{A:()=>b});var t=a(89379),s=a(65043),r=a(83462),d=a(26600),n=a(35316),o=a(29347),i=a(11906),c=a(33438),u=a(47968),h=a(97707),x=a(93141),v=a(65074),m=a(70579);const j=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:return(0,h.e3)(e*(l/100));case 1:return(0,h.e3)(e-e*(100/(100+l)));default:return 0}},b=e=>{let{orderDetails:l,orderProducts:a,download:b,actionOpen:g,clearDetails:p,children:N,TitleText:f}=e;const T=JSON.parse(localStorage.getItem("user")),[A,y]=(0,s.useState)(!1),[S,_]=(0,s.useState)({}),[I,C]=(0,s.useState)({}),G=(0,s.useRef)(null),w=(0,h.id)(l.GST_Inclusive,0),V=(0,h.id)(l.GST_Inclusive,1),R=(0,h.id)(l.GST_Inclusive,2),D=(0,h.id)(l.IS_IGST,1);(0,s.useEffect)(()=>{(0,v.z)({address:"masters/company?Company_id=".concat(null===T||void 0===T?void 0:T.Company_id)}).then(e=>{e.success&&C(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===T||void 0===T?void 0:T.Company_id]),(0,s.useEffect)(()=>{g&&y(!0)},[g]),(0,s.useEffect)(()=>{null!==l&&void 0!==l&&l.Retailer_Id&&(0,v.z)({address:"masters/retailers/info?Retailer_Id=".concat(null===l||void 0===l?void 0:l.Retailer_Id)}).then(e=>{e.success&&_(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})}).catch(e=>console.error(e))},[null===l||void 0===l?void 0:l.Retailer_Id]);const O=()=>{y(!1),p&&p()},L=a.filter(e=>(0,h.D)(null===e||void 0===e?void 0:e.Bill_Qty,0)),P=a.reduce((e,l)=>{const a=(0,h.e3)(null===l||void 0===l?void 0:l.Item_Rate),t=parseInt(null===l||void 0===l?void 0:l.Bill_Qty)||0;if(R)return e.TotalValue+=(0,h.JH)(t,a),e;const s=D?null===l||void 0===l?void 0:l.Igst:(0,h.Lr)(null===l||void 0===l?void 0:l.Sgst,null===l||void 0===l?void 0:l.Cgst);if(V){const l=j(1,a,s),r=(0,h.DG)(a,l);e.TotalTax+=(0,h.JH)(t,l),e.TotalValue+=(0,h.JH)(t,r)}if(w){const l=j(0,a,s);e.TotalTax+=(0,h.JH)(t,l),e.TotalValue+=(0,h.JH)(t,a)}return e},{TotalValue:0,TotalTax:0}),B=(0,x.useReactToPrint)({content:()=>G.current}),F=[{labelOne:"Invoice No",dataOne:null===l||void 0===l?void 0:l.So_Id,labelTwo:"Dated",dataTwo:(0,h.yc)(null===l||void 0===l?void 0:l.So_Date)},{labelOne:"Delivery Note",dataOne:"",labelTwo:"Mode/Terms of Payment",dataTwo:""},{labelOne:"Reference No. & Date",dataOne:"",labelTwo:"Other References",dataTwo:""},{labelOne:"Buyer's Order No",dataOne:"",labelTwo:"Dated",dataTwo:""},{labelOne:"Dispatch Doc No",dataOne:"",labelTwo:"Delivery Note Date",dataTwo:""},{labelOne:"Dispatched through",dataOne:"",labelTwo:"Destination",dataTwo:""},{labelOne:"Bill of Lading/LR-RR No",dataOne:"",labelTwo:"Motor Vehicle No",dataTwo:""}],k=null===a||void 0===a?void 0:a.reduce((e,a)=>{const s=e.findIndex(e=>e.hsnCode==a.HSN_Code),{Taxable_Amount:r,Cgst_Amo:d,Sgst_Amo:n,Igst_Amo:o,HSN_Code:i,Cgst:c,Sgst:u,Igst:x}=a;if(-1!==s){const a=e[s],i=(0,t.A)((0,t.A)({},a),{},{taxableValue:a.taxableValue+r,cgst:(0,h.Lr)(a.cgst,d),sgst:(0,h.Lr)(a.sgst,n),igst:(0,h.Lr)(a.igst,o),totalTax:a.totalTax+Number(l.IS_IGST?o:(0,h.Lr)(d,n))});return e[s]=i,e}const v={hsnCode:i,taxableValue:r,cgst:d,cgstPercentage:c,sgst:n,sgstPercentage:u,igst:o,igstPercentage:x,totalTax:l.IS_IGST?Number(o):(0,h.Lr)(d,n)};return[...e,v]},[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{onClick:()=>{y(!0)},children:N}),(0,m.jsxs)(r.A,{open:A,onClose:O,fullWidth:!0,maxWidth:"lg",children:[(0,m.jsx)(d.A,{children:"Order Preview"}),(0,m.jsxs)(n.A,{ref:G,children:[(0,m.jsx)("h3",{className:"text-center mb-2",children:null!==f&&void 0!==f?f:"Invoice Details"}),(0,m.jsxs)("div",{className:"row",children:[(0,m.jsxs)("div",{className:"col-6 p-0 border border-bottom-0 border-end-0",children:[(0,m.jsxs)("div",{className:"border-bottom p-2",children:[(0,m.jsx)("p",{className:"m-0 fa-17",children:null===I||void 0===I?void 0:I.Company_Name}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["Address: ",null===I||void 0===I?void 0:I.Company_Address]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["City: ",null===I||void 0===I?void 0:I.Region," - ",null===I||void 0===I?void 0:I.Pincode]}),(0,m.jsx)("p",{className:"m-0 fa-14",children:null!==I&&void 0!==I&&I.Gst_Number||null!==I&&void 0!==I&&I.VAT_TIN_Number?(0,m.jsxs)(m.Fragment,{children:["GSTIN / UIN:",null!==I&&void 0!==I&&I.Gst_Number?" ".concat(I.Gst_Number):"",null!==I&&void 0!==I&&I.Gst_Number&&null!==I&&void 0!==I&&I.VAT_TIN_Number?" || ":"",null!==I&&void 0!==I&&I.VAT_TIN_Number?" ".concat(I.VAT_TIN_Number):""]}):(0,m.jsx)(m.Fragment,{children:"GSTIN / UIN: Not Available"})}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["State: ",null===I||void 0===I?void 0:I.State]}),(0,m.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]}),(0,m.jsxs)("div",{className:"p-2",children:[" ",(0,m.jsx)("p",{className:"m-0 fa-12",children:"Buyer (Bill to)"}),(0,m.jsx)("p",{className:"m-0 fa-15",children:null===S||void 0===S?void 0:S.Retailer_Name}),(0,m.jsx)("p",{className:"m-0 fa-14",children:(null===S||void 0===S?void 0:S.Mobile_No)+" - "+(null===S||void 0===S?void 0:S.Reatailer_Address)}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:[null===S||void 0===S?void 0:S.Reatailer_City," - ",null===S||void 0===S?void 0:S.PinCode]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["GSTIN / UIN: ",null===S||void 0===S?void 0:S.Gstno]}),(0,m.jsxs)("p",{className:"m-0 fa-14",children:["State Name: ",null===S||void 0===S?void 0:S.StateGet]}),(0,m.jsx)("p",{className:"m-0 fa-14",children:"Code: "})]})]}),(0,m.jsx)("div",{className:"col-6 p-0 border border-bottom-0",children:(0,m.jsx)("table",{className:"table m-0",children:(0,m.jsxs)("tbody",{children:[F.map((e,l)=>(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{className:"border-end fa-12 p-0 px-1",children:[(0,m.jsx)("p",{className:"m-0",children:e.labelOne}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003",e.dataOne]})]}),(0,m.jsxs)("td",{className:"fa-12 p-0 px-1",children:[(0,m.jsx)("p",{className:"m-0",children:e.labelTwo}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003",e.dataTwo]})]})]},l)),(0,m.jsx)("tr",{children:(0,m.jsxs)("td",{colSpan:2,className:"border-0 fa-12 p-0",children:[(0,m.jsx)("p",{className:"m-0",children:"Terms of Delivery"}),(0,m.jsx)("p",{className:"m-0"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{})]})})]})})})]}),(0,m.jsx)("div",{className:"row",children:(0,m.jsx)("div",{className:"col-12 p-0",children:(0,m.jsxs)("table",{className:"table m-0",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border bg-light fa-14",children:"Sno"}),(0,m.jsx)("td",{className:"border bg-light fa-14",children:"Product"}),(0,m.jsx)("td",{className:"border bg-light fa-14",children:"HSN/SAC"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Quantity"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Rate"}),(0,m.jsxs)("td",{className:"border bg-light fa-14 text-end",children:[(0,m.jsx)("p",{className:"m-2 ",children:"Rate"}),(0,m.jsxs)("p",{className:"m-0 ",children:[(0,h.id)(l.GST_Inclusive,1)&&"(Incl. of Tax)",(0,h.id)(l.GST_Inclusive,2)&&"(Tax not applicable)",(0,h.id)(l.GST_Inclusive,0)&&"(Excl. of Tax)"]})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-end",children:"Amount"})]})}),(0,m.jsxs)("tbody",{children:[L.map((e,a)=>{var t;const s=null!==(t=D?null===e||void 0===e?void 0:e.Igst_P:(null===e||void 0===e?void 0:e.Cgst)+(null===e||void 0===e?void 0:e.Sgst))&&void 0!==t?t:0,r=Number((null===e||void 0===e?void 0:e.Bill_Qty)||0),d=Number((null===e||void 0===e?void 0:e.Item_Rate)||0),n=j(l.GST_Inclusive,d,s);return(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13",children:a+1}),(0,m.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.Product_Name}),(0,m.jsx)("td",{className:"border fa-13",children:null===e||void 0===e?void 0:e.HSN_Code}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[(0,h.jG)(r),(null===e||void 0===e?void 0:e.UOM)&&" ("+(null===e||void 0===e?void 0:e.UOM)+") "]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,h.jG)((0,h.id)(l.GST_Inclusive,1)?d-n:d)]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,h.jG)((0,h.id)(l.GST_Inclusive,1)?d:d+n)]}),(0,m.jsxs)("td",{className:"border fa-13 text-end",children:[" ",(0,h.jG)(null===e||void 0===e?void 0:e.Taxable_Amount)]})]},a)}),(0,m.jsxs)("tr",{children:[(0,m.jsxs)("td",{className:"border p-2",rowSpan:D?4:5,colSpan:4,children:[(0,m.jsx)("p",{className:"m-0",children:"Amount Chargeable (in words):"}),(0,m.jsxs)("p",{className:"m-0",children:["\u2003 INR ",(0,h.GF)(parseInt(null===l||void 0===l?void 0:l.Total_Invoice_value))," Only."]})]}),(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total Taxable Amount"}),(0,m.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,h.jG)(P.TotalValue)})]}),D?(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"IGST"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,h.jG)(l.IGST_Total)})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"CGST"}),(0,m.jsx)("td",{className:"border p-2 text-end fa-14",children:(0,h.jG)(null===l||void 0===l?void 0:l.CSGT_Total)})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"SGST"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,h.jG)(null===l||void 0===l?void 0:l.SGST_Total)})]})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Round Off"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end",children:(0,h.jG)(null===l||void 0===l?void 0:l.Round_off)})]}),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border p-2 fa-14",colSpan:2,children:"Total"}),(0,m.jsx)("td",{className:"border p-2 fa-14 text-end fw-bold",children:(0,h.jG)(null===l||void 0===l?void 0:l.Total_Invoice_value)})]})]})]})})}),(0,m.jsxs)("table",{className:"table",children:[(0,m.jsxs)("thead",{children:[(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"HSN / SAC"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",rowSpan:2,style:{verticalAlign:"middle"},children:"Taxable Value"}),(0,h.id)(l.IS_IGST,1)?(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"IGST Tax"}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"Central Tax"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",colSpan:2,children:"State Tax"})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Total"})]}),(0,m.jsxs)("tr",{children:[(0,h.id)(l.IS_IGST,1)?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Rate"}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Amount"})]}),(0,m.jsx)("td",{className:"border bg-light fa-14 text-center",children:"Tax Amount"})]})]}),(0,m.jsxs)("tbody",{children:[k.map((e,a)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:null===e||void 0===e?void 0:e.hsnCode}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.taxableValue)}),l.IS_IGST?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.igstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.igst)})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.cgstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.cgst)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.sgstPercentage)}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.sgst)})]}),(0,m.jsx)("td",{className:"border fa-13 text-end",children:(0,h.jG)(null===e||void 0===e?void 0:e.totalTax)})]},a)),(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{className:"border fa-13 text-end",children:"Total"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,h.jG)(k.reduce((e,l)=>e+Number(l.taxableValue),0))}),l.IS_IGST?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,h.jG)(k.reduce((e,l)=>e+Number(l.igst),0))})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,h.jG)(k.reduce((e,l)=>e+Number(l.cgst),0))}),(0,m.jsx)("td",{className:"border fa-13 text-end"}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,h.jG)(k.reduce((e,l)=>e+Number(l.sgst),0))})]}),(0,m.jsx)("td",{className:"border fa-13 text-end fw-bold",children:(0,h.jG)(k.reduce((e,l)=>e+Number(l.totalTax),0))})]}),(0,m.jsx)("tr",{children:(0,m.jsxs)("td",{colSpan:(0,h.id)(l.IS_IGST,1)?5:7,className:"border fa-13 fw-bold",children:["Tax Amount (in words) : INR \xa0",(0,h.GF)(parseInt(k.reduce((e,l)=>e+Number(l.totalTax),0)))," only."]})})]})]}),(0,m.jsx)("div",{className:"col-12 text-center",children:(0,m.jsx)("p",{children:"This is a Computer Generated Invoice"})})]}),(0,m.jsxs)(o.A,{children:[(0,m.jsx)(i.A,{startIcon:(0,m.jsx)(c.A,{}),variant:"outlined",color:"error",onClick:O,children:"Close"}),b&&(0,m.jsx)(i.A,{startIcon:(0,m.jsx)(u.A,{}),variant:"outlined",onClick:B,children:"Download"})]})]})]})}},33438:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(59662),s=a(70579);const r=(0,t.A)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},70141:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(59662),s=a(70579);const r=(0,t.A)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},80973:(e,l,a)=>{a.r(l),a.d(l,{default:()=>O});var t=a(89379),s=a(65043),r=a(81e3),d=a(11906),n=a(77739),o=a(17392),i=a(83462),c=a(26600),u=a(35316),h=a(29347),x=a(20656),v=a(63406),m=a(97707),j=a(13899),b=a(70141),g=a(83560),p=a(59383),N=a(79484),f=a(13479),T=a(3632),A=a(10204),y=a(65074),S=a(48471),_=a(73216),I=a(91036),C=a(90001),G=a(33438),w=a(30513),V=a(22240),R=(a(34460),a(70579));const D={Fromdate:(0,m.ny)(),Todate:(0,m.ny)(),Retailer:{value:"",label:"ALL"},CreatedBy:{value:"",label:"ALL"},SalesPerson:{value:"",label:"ALL"},VoucherType:{value:"",label:"ALL"},Cancel_status:""},O=e=>{var l;let{loadingOn:a,loadingOff:O,AddRights:L,EditRights:P,pageID:B}=e;const F=(0,_.zy)(),k=(sessionStorage.getItem("filterValues"),(0,_.Zp)()),[M,z]=(0,s.useState)([]),[E,H]=(0,s.useState)({voucherType:[],retailers:[],createdBy:[]}),[W,Q]=(0,s.useState)(!0),[$,J]=(0,s.useState)(!1),[U,X]=(0,s.useState)({}),[Z,q]=(0,s.useState)(!1),[K,Y]=(0,s.useState)(!0),[ee,le]=(0,s.useState)(!1),[ae,te]=(0,s.useState)(D),[se,re]=(0,s.useState)({filters:!1,orderDetails:!1,printInvoice:!1,deliverySlip:!1}),[de,ne]=(0,s.useState)(null),[oe,ie]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=!0;return(async()=>{try{Y(!0);const r=await(0,y.z)({address:"sales/salesInvoice/filterValues",loadingOn:a,loadingOff:O});var l,t,s;if(e&&r.success)H({voucherType:(0,m.$r)(null===r||void 0===r||null===(l=r.others)||void 0===l?void 0:l.voucherType)||[],retailers:(0,m.$r)(null===r||void 0===r||null===(t=r.others)||void 0===t?void 0:t.retailers)||[],createdBy:(0,m.$r)(null===r||void 0===r||null===(s=r.others)||void 0===s?void 0:s.createdBy)||[]}),J(!0)}catch(r){console.error(r),I.oR.error("Failed to load filter options")}})(),()=>{e=!1}},[]),(0,s.useEffect)(()=>{(0,y.z)({address:"sales/salesInvoice/filterValues"}).then(e=>{var l,a,t;e.success&&(H({voucherType:(0,m.$r)(null===e||void 0===e||null===(l=e.others)||void 0===l?void 0:l.voucherType),retailers:(0,m.$r)(null===e||void 0===e||null===(a=e.others)||void 0===a?void 0:a.retailers),createdBy:(0,m.$r)(null===e||void 0===e||null===(t=e.others)||void 0===t?void 0:t.createdBy)}),J(!0))}).catch(e=>console.error(e))},[]),(0,s.useEffect)(()=>{if(!$)return;const e=F.state||{},l=(0,m.vU)(B)||{},a=void 0!==e.VoucherType;ie(a);const s=(0,t.A)((0,t.A)((0,t.A)({},D),l),a?e:{});let r=s.VoucherType;if(a&&r){if("object"===typeof r&&void 0!==r.value){const e=E.voucherType.find(e=>e.value===r.value||String(e.value)===String(r.value));e&&(r=e)}else if("number"===typeof r||"string"===typeof r){const e=r,l=E.voucherType.find(l=>l.value===e||String(l.value)===String(e));r=l||{value:e,label:"Voucher ".concat(e)}}}else r=D.VoucherType;const d={Fromdate:s.Fromdate||D.Fromdate,Todate:s.Todate||D.Todate,Retailer:s.Retailer||D.Retailer,CreatedBy:s.CreatedBy||D.CreatedBy,SalesPerson:s.SalesPerson||D.SalesPerson,VoucherType:r,Cancel_status:s.Cancel_status||D.Cancel_status};te(d),Object.keys(e).length>0&&(0,m.Mb)((0,t.A)((0,t.A)({},e),{},{pageID:B}))},[F.state,B,$,E.voucherType]),(0,s.useEffect)(()=>{if(!$)return;(async()=>{const{Fromdate:e=D.Fromdate,Todate:l=D.Todate,Retailer:t=D.Retailer,CreatedBy:s=D.CreatedBy,VoucherType:r=D.VoucherType,Cancel_status:d=D.Cancel_status}=ae,n=(null===r||void 0===r?void 0:r.value)||r||"";try{le(!0);const r=await(0,y.z)({address:"sales/salesInvoice?Fromdate=".concat(e,"&Todate=").concat(l,"&Retailer_Id=").concat((null===t||void 0===t?void 0:t.value)||"","&Created_by=").concat((null===s||void 0===s?void 0:s.value)||"","&VoucherType=").concat(n,"&Cancel_status=").concat(d),loadingOn:a,loadingOff:O});r.success?z((null===r||void 0===r?void 0:r.data)||[]):(z([]),I.oR.error(r.message||"Failed to load sales invoices"))}catch(o){console.error(o),I.oR.error("Error fetching sales invoices"),z([])}finally{le(!1),Q(!1)}})()},[ae,B,Z,$,oe]);const ce=()=>{re((0,t.A)((0,t.A)({},se),{},{filters:!1,orderDetails:!1}))},ue=(0,s.useMemo)(()=>M.filter(e=>!(0,m.id)(e.Cancel_status,0)).reduce((e,l)=>{const a=(0,m.Lr)(e.totalInvoiceValue,l.Total_Invoice_value),t=(0,m.$r)(l.Products_List).reduce((e,l)=>({tonnageValue:(0,m.Lr)(e.tonnageValue,null===l||void 0===l?void 0:l.Total_Qty),bagsValue:(0,m.Lr)(e.bagsValue,l.Alt_Bill_Qty)}),{tonnageValue:0,bagsValue:0});return{totalTonnage:(0,m.Lr)(e.totalTonnage,t.tonnageValue),totalBags:(0,m.Lr)(e.totalBags,t.bagsValue),totalInvoiceValue:a}},{totalTonnage:0,totalBags:0,totalInvoiceValue:0}),[M]);if(!$)return(0,R.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:(0,R.jsx)("span",{className:"ms-3",children:"Loading filters..."})});const he=e=>{const l=new Date(e),a=new Date;return Math.floor((a-l)/864e5)<=3};return(0,R.jsxs)(R.Fragment,{children:[ee&&(0,R.jsx)(r.A,{position:"absolute",top:0,left:0,right:0,zIndex:10}),(0,R.jsx)(S.Ay,{title:"Sales Invoice",dataArray:M,EnableSerialNumber:!0,columns:[(0,S.Lj)("Do_Date","date","Date"),(0,S.Lj)("Do_Inv_No","string","ID"),(0,S.Lj)("Retailer_Name","string","Customer"),(0,S.Lj)("VoucherTypeGet","string","Voucher"),(0,S.Lj)("Total_Before_Tax","number","Before Tax"),(0,S.Lj)("Total_Tax","number","Tax"),(0,S.Lj)("Total_Invoice_value","number","Invoice Value"),{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,a;let{row:t}=e;const s=A.X.find(e=>e.id===Number(null===t||void 0===t?void 0:t.Cancel_status));return(0,R.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(a=null===s||void 0===s?void 0:s.label)&&void 0!==a?a:""})}},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,R.jsx)(S.wF,{buttonsData:[{name:"View Order",onclick:()=>{X({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},icon:(0,R.jsx)(T.A,{fontSize:"small",color:"primary"})},{name:"Print Invoice",onclick:()=>{ne(l),re(e=>(0,t.A)((0,t.A)({},e),{},{printInvoice:!0}))},icon:(0,R.jsx)(w.A,{fontSize:"small",color:"primary"})},{name:"Edit",onclick:()=>{k("create",{state:(0,t.A)((0,t.A)({},l),{},{isEdit:!0})})},icon:(0,R.jsx)(g.A,{fontSize:"small",color:"primary"}),disabled:!P||!he(l.Do_Date)},{name:"Delivery Slip",onclick:()=>{ne(l),re(e=>(0,t.A)((0,t.A)({},e),{},{deliverySlip:!0}))},icon:(0,R.jsx)(w.A,{fontSize:"small",color:"primary"})}]})}}],ButtonArea:(0,R.jsxs)(R.Fragment,{children:[L&&(0,R.jsx)(d.A,{variant:"outlined",startIcon:(0,R.jsx)(b.A,{}),onClick:()=>k("create"),children:"NEW"}),L&&(0,R.jsx)(n.A,{title:"Sync tally data",children:(0,R.jsx)(d.A,{className:"mx-1",variant:"outlined",onClick:async()=>{try{null===a||void 0===a||a();const e=await(0,y.z)({address:"sales/salesInvoice/tallySync",loadingOn:a,loadingOff:O});I.oR.success(e.message),q(e=>!e)}catch(e){console.error(e),I.oR.error("Sync failed")}finally{null===O||void 0===O||O()}},startIcon:(0,R.jsx)(f.A,{color:"primary"}),children:"Sync Tally"})}),(0,R.jsx)(n.A,{title:"Filters",children:(0,R.jsx)(o.A,{size:"small",onClick:()=>re((0,t.A)((0,t.A)({},se),{},{filters:!0})),children:(0,R.jsx)(p.A,{})})}),M.length>0&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("span",{children:[" Qty: ",(0,m.jG)(ue.totalTonnage)," "]}),(0,R.jsxs)("span",{children:[" Bag: ",(0,m.jG)(ue.totalBags)," \xa0 "]}),(0,R.jsxs)("span",{children:[" Worth: ",(0,m.jG)(ue.totalInvoiceValue)," \xa0 "]})]}),(null===(l=ae.VoucherType)||void 0===l?void 0:l.value)&&(0,R.jsxs)("span",{className:"mx-2 text-primary",children:["Voucher: ",ae.VoucherType.label]})]}),isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)("table",{className:"table",children:(0,R.jsxs)("tbody",{children:[(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,R.jsx)("td",{className:"border p-2",children:l.Branch_Name}),(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,R.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name}),(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,R.jsx)("td",{className:"border p-2",children:l.Round_off})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,R.jsxs)("td",{className:"border p-2",children:[(0,m.id)(l.GST_Inclusive,1)&&"Inclusive",(0,m.id)(l.GST_Inclusive,0)&&"Exclusive"]}),(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,R.jsxs)("td",{className:"border p-2",children:[(0,m.id)(l.IS_IGST,1)&&"IGST",(0,m.id)(l.IS_IGST,0)&&"GST"]}),(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,R.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,R.jsx)("td",{className:"border p-2",colSpan:5,children:l.Narration})]})]})})})}}),Object.keys(U).length>0&&(0,R.jsx)(j.A,{orderDetails:null===U||void 0===U?void 0:U.orderDetails,orderProducts:null===U||void 0===U?void 0:U.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>X({}),TitleText:"Sale Order"}),(0,R.jsxs)(i.A,{open:se.filters,onClose:ce,fullWidth:!0,maxWidth:"sm",children:[(0,R.jsx)(c.A,{children:"Filters"}),(0,R.jsx)(u.A,{children:(0,R.jsx)("div",{className:"table-responsive pb-4",children:(0,R.jsx)("table",{className:"table",children:(0,R.jsxs)("tbody",{children:[(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,R.jsx)("td",{children:(0,R.jsx)("input",{type:"date",value:ae.Fromdate,onChange:e=>te((0,t.A)((0,t.A)({},ae),{},{Fromdate:e.target.value})),className:"cus-inpt"})})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,R.jsx)("td",{children:(0,R.jsx)("input",{type:"date",value:ae.Todate,onChange:e=>te((0,t.A)((0,t.A)({},ae),{},{Todate:e.target.value})),className:"cus-inpt"})})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,R.jsx)("td",{children:(0,R.jsx)(x.Ay,{value:null===ae||void 0===ae?void 0:ae.Retailer,onChange:e=>te((0,t.A)((0,t.A)({},ae),{},{Retailer:e})),options:[{value:"",label:"ALL"},...E.retailers],styles:v.MR,isSearchable:!0,placeholder:"Retailer Name",menuPortalTarget:document.body,filterOption:m.GI})})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"Voucher "}),(0,R.jsx)("td",{children:(0,R.jsx)(x.Ay,{value:null===ae||void 0===ae?void 0:ae.VoucherType,onChange:e=>te((0,t.A)((0,t.A)({},ae),{},{VoucherType:e})),options:[{value:"",label:"ALL"},...E.voucherType],styles:v.MR,menuPortalTarget:document.body,isSearchable:!0,placeholder:"Voucher Name",filterOption:m.GI})})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,R.jsx)("td",{children:(0,R.jsxs)("select",{type:"date",value:ae.Cancel_status,onChange:e=>te((0,t.A)((0,t.A)({},ae),{},{Cancel_status:e.target.value})),className:"cus-inpt",children:[(0,R.jsx)("option",{value:"",children:"All"}),A.X.map((e,l)=>(0,R.jsx)("option",{value:e.id,children:e.label},l))]})})]}),(0,R.jsxs)("tr",{children:[(0,R.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,R.jsx)("td",{children:(0,R.jsx)(x.Ay,{value:null===ae||void 0===ae?void 0:ae.CreatedBy,onChange:e=>te(l=>(0,t.A)((0,t.A)({},l),{},{CreatedBy:e})),options:[{value:"",label:"ALL"},...E.createdBy],styles:v.MR,isSearchable:!0,placeholder:"Sales Person Name",menuPortalTarget:document.body,filterOption:m.GI})})]})]})})})}),(0,R.jsxs)(h.A,{children:[(0,R.jsx)(d.A,{onClick:ce,children:"close"}),(0,R.jsx)(d.A,{onClick:()=>{ce(),(0,m.Mb)({Fromdate:null===ae||void 0===ae?void 0:ae.Fromdate,Todate:ae.Todate,pageID:B,Retailer:ae.Retailer,CreatedBy:ae.CreatedBy,VoucherType:ae.VoucherType,Cancel_status:ae.Cancel_status})},startIcon:(0,R.jsx)(N.A,{}),variant:"outlined",children:"Search"})]})]}),(0,R.jsxs)(i.A,{open:se.printInvoice,onClose:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{printInvoice:!1})),ne(null)},maxWidth:"lg",fullWidth:!0,scroll:"paper",children:[(0,R.jsxs)(c.A,{children:["Print Invoice #",null===de||void 0===de?void 0:de.Do_Inv_No,(0,R.jsx)(o.A,{onClick:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{printInvoice:!1})),ne(null)},style:{position:"absolute",right:8,top:8},children:(0,R.jsx)(G.A,{})})]}),(0,R.jsx)(u.A,{children:(null===de||void 0===de?void 0:de.Do_Id)&&(0,R.jsx)(C.A,{Do_Id:de.Do_Id,loadingOn:a,loadingOff:O})}),(0,R.jsx)(h.A,{children:(0,R.jsx)(d.A,{onClick:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{printInvoice:!1})),ne(null)},children:"Close"})})]}),(0,R.jsxs)(i.A,{open:se.deliverySlip,onClose:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{deliverySlip:!1})),ne(null)},maxWidth:"lg",fullWidth:!0,scroll:"paper",children:[(0,R.jsxs)(c.A,{children:["Print Delivery Slip #",null===de||void 0===de?void 0:de.Do_Inv_No,(0,R.jsx)(o.A,{onClick:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{deliverySlip:!1})),ne(null)},style:{position:"absolute",right:8,top:8},children:(0,R.jsx)(G.A,{})})]}),(0,R.jsx)(u.A,{children:(null===de||void 0===de?void 0:de.Do_Id)&&(0,R.jsx)(V.A,{Do_Id:de.Do_Id,loadingOn:a,loadingOff:O})}),(0,R.jsx)(h.A,{children:(0,R.jsx)(d.A,{onClick:()=>{re(e=>(0,t.A)((0,t.A)({},e),{},{deliverySlip:!1})),ne(null)},children:"Close"})})]})]})}},83560:(e,l,a)=>{a.d(l,{A:()=>r});var t=a(59662),s=a(70579);const r=(0,t.A)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")}}]);
//# sourceMappingURL=973.740ef78b.chunk.js.map